var rt=Object.defineProperty;var ot=(h,e,t)=>e in h?rt(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var v=(h,e,t)=>ot(h,typeof e!="symbol"?e+"":e,t);import{d as pe,g as Me,c as Q,b as T,e as u,z as at,t as M,y as me,E as lt,s as b,f as F,A as ut,G as Pe,n as be,r as O,o as je,H as Be,p as Se,l as ct,w as j,q as A,v as G,I,i as ee,m as Ie,F as Te,k as pt,C as ht}from"./index-Nr-eCdF_.js";const gt=["width","height"],Qe=pe({__name:"icon",props:{name:{},size:{default:24}},setup(h){const e=h,t={home:"home",dark_mode:"dark_mode",github:"code",refresh:"refresh",search:"search",more:"more_vert",rename:"edit",delete:"delete",upload:"upload",stats:"bar_chart",start:"play_arrow",settings:"settings",download:"download",warning:"warning"},s=Me(()=>t[e.name]||e.name);return(n,i)=>e.name==="github"?(T(),Q("svg",{key:0,viewBox:"0 0 24 24",width:n.size,height:n.size,style:{display:"inline-block",verticalAlign:"middle"}},i[0]||(i[0]=[u("path",{fill:"currentColor",d:"M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z"},null,-1)]),8,gt)):(T(),Q("i",{key:1,class:"material-icons",style:at({fontSize:`${n.size}px`,lineHeight:1,verticalAlign:"middle"})},M(s.value),5))}});class ft{canParse(e){if(!e||typeof e!="object")return!1;const t=e;if(!Array.isArray(t.chapters)||t.chapters.length===0)return!1;const s=t.chapters[0];if(!s.title||!Array.isArray(s.questions))return!1;if(s.questions.length>0){const n=s.questions[0];if(!n.title||!Array.isArray(n.options))return!1}return!0}parse(e){return e}}class dt{canParse(e){return typeof e=="string"&&!this.isJson(e)}isJson(e){try{return JSON.parse(e),!0}catch{return!1}}parse(e,t){if(typeof e!="string")throw new Error("TextFormatParser只能处理字符串数据");const n=e.split(`
`).filter(a=>a.trim()),i=t?t.replace(/\.(txt|json)$/,""):n[0]||"未命名题库",r=[];let o={title:"默认章节",questions:[]},l=null;for(let a=1;a<n.length;a++){const p=n[a].trim();if(p.startsWith("## "))o.questions.length>0&&r.push(o),o={title:p.substring(3),questions:[]},l=null;else if(p.match(/^\d+\./))l&&o.questions.push(l),l={id:`q-${Date.now()}-${Math.random().toString(36).slice(2)}`,title:p.substring(p.indexOf(".")+1).trim(),options:[],answer:0,explanation:""};else if(p.startsWith("- ")&&l)l.options.push(p.substring(2).trim());else if(p.startsWith("答案:")&&l){const d=p.substring(3).trim();l.answer=parseInt(d)-1||0}else p.startsWith("解析:")&&l&&(l.explanation=p.substring(3).trim())}return l&&o.questions.push(l),o.questions.length>0&&r.push(o),{title:i,chapters:r,description:"从文本导入",lastModified:Date.now()}}}class Re{canParse(e){if(!e||typeof e!="object")return!1;const t=e;if(Array.isArray(t.questions)&&t.questions.length>0)return!0;if(Array.isArray(e)&&e.length>0){const s=e[0];if(s&&typeof s=="object")return s.question!==void 0||s.title!==void 0||s.stem!==void 0||s.options!==void 0||s.answer!==void 0}return!1}parse(e,t){const s=e;let n=s.title||"题库";t?n=t.replace(/\.(json|txt)$/,""):s.fileName&&typeof s.fileName=="string"?n=s.fileName.replace(/\.(json|txt)$/,""):s.name&&typeof s.name=="string"&&(n=s.name),n.includes("[")&&n.includes("]")&&(n=n.replace(/\[|\]/g,""));const i=[],r={title:"默认章节",questions:[]};return this.processQuestions(s,r),r.questions.length>0&&i.push(r),this.processChapters(s,i),{title:n,description:typeof s.description=="string"?s.description:"导入的题库",author:typeof s.author=="string"?s.author:"",version:typeof s.version=="string"?s.version:"1.0",lastModified:Date.now(),chapters:i.length>0?i:[r]}}processQuestions(e,t){Array.isArray(e.questions)?e.questions.forEach((s,n)=>{if(!s||typeof s!="object")return;const i=s;this.createQuestion(i,n,t)}):Array.isArray(e)&&e.forEach((s,n)=>{if(!s||typeof s!="object")return;const i=s;this.createQuestion(i,n,t)})}processChapters(e,t){Array.isArray(e.chapters)&&e.chapters.length>0&&e.chapters.forEach((s,n)=>{if(!s||typeof s!="object")return;const i=s;if(i.title&&Array.isArray(i.questions)&&i.questions.length>0){const r={title:typeof i.title=="string"?i.title:`第${n+1}章`,questions:[]};i.questions.forEach((o,l)=>{if(!o||typeof o!="object")return;const a=o;this.createQuestion(a,l,r)}),r.questions.length>0&&t.push(r)}})}createQuestion(e,t,s){const n={id:typeof e.id=="string"||typeof e.id=="number"?String(e.id):`q-${Date.now()}-${t}`,title:"",options:[],answer:0,explanation:""};typeof e.question=="string"?n.title=e.question:typeof e.title=="string"?n.title=e.title:typeof e.stem=="string"?n.title=e.stem:typeof e.content=="string"?n.title=e.content:n.title=`第${t+1}题`,(n.title.includes("<p>")||n.title.includes("</p>"))&&(n.title=n.title.replace(/<\/?p>/g,"")),typeof e.analysis=="string"?n.explanation=e.analysis:typeof e.explanation=="string"?n.explanation=e.explanation:typeof e.parse=="string"?n.explanation=e.parse:typeof e.comment=="string"&&(n.explanation=e.comment),n.options=this.extractOptions(e),n.answer=this.extractAnswer(e,n.options.length),s.questions.push(n)}extractOptions(e){if(Array.isArray(e.options))return this.processOptionsArray(e.options);if(e.options&&typeof e.options=="object")return this.processOptionsObject(e.options);if(Array.isArray(e.choices))return this.processOptionsArray(e.choices);if(e.choices&&typeof e.choices=="object")return this.processOptionsObject(e.choices);const t=[],s=["A","B","C","D","E","F","G","H"];for(const n of s)n in e&&typeof e[n]=="string"&&t.push(e[n]);return t.length>=2?t:["选项A","选项B","选项C","选项D"]}processOptionsArray(e){return e.map(t=>{if(typeof t=="string")return t;if(typeof t=="number")return String(t);if(t===null)return"";if(typeof t=="object"){const s=t;if(typeof s.text=="string")return s.text;if(typeof s.content=="string")return s.content;if(typeof s.label=="string")return s.label;if(typeof s.value=="string")return s.value;if(typeof s.option=="string")return s.option;const n=Object.keys(s);return n.length===1&&typeof s[n[0]]=="string"?s[n[0]]:JSON.stringify(t)}return String(t)})}processOptionsObject(e){let t=Object.keys(e);return t=t.sort((s,n)=>/^[A-Z]$/.test(s)&&/^[A-Z]$/.test(n)?s.charCodeAt(0)-n.charCodeAt(0):/^\d+$/.test(s)&&/^\d+$/.test(n)?parseInt(s)-parseInt(n):s.localeCompare(n)),t.map(s=>{const n=e[s];if(typeof n=="string")return n;if(typeof n=="number")return String(n);if(n===null)return"";if(typeof n=="object"){const i=n;return typeof i.text=="string"?i.text:typeof i.content=="string"?i.content:typeof i.label=="string"?i.label:typeof i.value=="string"?i.value:JSON.stringify(n)}return String(n)})}extractAnswer(e,t){let s;return e.answer!==void 0?s=e.answer:e.correct!==void 0?s=e.correct:e.rightAnswer!==void 0?s=e.rightAnswer:e.correctAnswer!==void 0&&(s=e.correctAnswer),this.processAnswer(s,t)}processAnswer(e,t){if(typeof e=="number")return Math.min(Math.max(0,e),t-1);if(typeof e=="string"){if(/^[A-Z]$/.test(e)){const s=e.charCodeAt(0)-65;return Math.min(Math.max(0,s),t-1)}if(/^\d+$/.test(e)){const s=parseInt(e)-1;return Math.min(Math.max(0,s),t-1)}if(/^[A-Z]+$/.test(e))return Array.from(e).map(s=>{const n=s.charCodeAt(0)-65;return Math.min(Math.max(0,n),t-1)});if(e.includes(","))return e.split(",").map(s=>/^[A-Z]$/.test(s)?s.charCodeAt(0)-65:/^\d+$/.test(s)?parseInt(s)-1:0)}return Array.isArray(e)?e.map(s=>{if(typeof s=="number")return Math.min(Math.max(0,s),t-1);if(typeof s=="string"){if(/^[A-Z]$/.test(s))return s.charCodeAt(0)-65;if(/^\d+$/.test(s))return parseInt(s)-1}return 0}):0}}class mt{constructor(){v(this,"parsers",[]);this.register(new ft),this.register(new dt),this.register(new Re)}register(e){this.parsers.push(e)}parse(e,t){let s=e;if(typeof e=="string")try{s=JSON.parse(e)}catch{}for(const n of this.parsers)if(n.canParse(s))return n.parse(s,t);return new Re().parse(s,t)}}const oe=new mt;function yn(h,e){return oe.parse(h,e)}function ke(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let J=ke();function Ge(h){J=h}const te={exec:()=>null};function z(h,e=""){let t=typeof h=="string"?h:h.source;const s={replace:(n,i)=>{let r=typeof i=="string"?i:i.source;return r=r.replace(P.caret,"$1"),t=t.replace(n,r),s},getRegex:()=>new RegExp(t,e)};return s}const P={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:h=>new RegExp(`^( {0,3}${h})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}#`),htmlBeginRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}<(?:[a-z].*>|!--)`,"i")},bt=/^(?:[ \t]*(?:\n|$))+/,St=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,yt=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ne=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,kt=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,we=/(?:[*+-]|\d{1,9}[.)])/,Fe=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Ue=z(Fe).replace(/bull/g,we).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),wt=z(Fe).replace(/bull/g,we).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),xe=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,xt=/^[^\n]+/,ve=/(?!\s*\])(?:\\.|[^\[\]\\])+/,vt=z(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ve).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),zt=z(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,we).getRegex(),he="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ze=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,_t=z("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ze).replace("tag",he).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Je=z(xe).replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex(),$t=z(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Je).getRegex(),_e={blockquote:$t,code:St,def:vt,fences:yt,heading:kt,hr:ne,html:_t,lheading:Ue,list:zt,newline:bt,paragraph:Je,table:te,text:xt},Le=z("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex(),At={..._e,lheading:wt,table:Le,paragraph:z(xe).replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Le).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex()},Ct={..._e,html:z(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ze).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:te,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:z(xe).replace("hr",ne).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ue).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},qt=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Pt=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ve=/^( {2,}|\\)\n(?!\s*$)/,It=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ge=/[\p{P}\p{S}]/u,$e=/[\s\p{P}\p{S}]/u,He=/[^\s\p{P}\p{S}]/u,Tt=z(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,$e).getRegex(),Ze=/(?!~)[\p{P}\p{S}]/u,Qt=/(?!~)[\s\p{P}\p{S}]/u,Rt=/(?:[^\s\p{P}\p{S}]|~)/u,Lt=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,We=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Et=z(We,"u").replace(/punct/g,ge).getRegex(),Dt=z(We,"u").replace(/punct/g,Ze).getRegex(),Ke="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Nt=z(Ke,"gu").replace(/notPunctSpace/g,He).replace(/punctSpace/g,$e).replace(/punct/g,ge).getRegex(),Ot=z(Ke,"gu").replace(/notPunctSpace/g,Rt).replace(/punctSpace/g,Qt).replace(/punct/g,Ze).getRegex(),Mt=z("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,He).replace(/punctSpace/g,$e).replace(/punct/g,ge).getRegex(),jt=z(/\\(punct)/,"gu").replace(/punct/g,ge).getRegex(),Bt=z(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Gt=z(ze).replace("(?:-->|$)","-->").getRegex(),Ft=z("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Gt).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),le=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ut=z(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",le).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Xe=z(/^!?\[(label)\]\[(ref)\]/).replace("label",le).replace("ref",ve).getRegex(),Ye=z(/^!?\[(ref)\](?:\[\])?/).replace("ref",ve).getRegex(),Jt=z("reflink|nolink(?!\\()","g").replace("reflink",Xe).replace("nolink",Ye).getRegex(),Ae={_backpedal:te,anyPunctuation:jt,autolink:Bt,blockSkip:Lt,br:Ve,code:Pt,del:te,emStrongLDelim:Et,emStrongRDelimAst:Nt,emStrongRDelimUnd:Mt,escape:qt,link:Ut,nolink:Ye,punctuation:Tt,reflink:Xe,reflinkSearch:Jt,tag:Ft,text:It,url:te},Vt={...Ae,link:z(/^!?\[(label)\]\((.*?)\)/).replace("label",le).getRegex(),reflink:z(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",le).getRegex()},ye={...Ae,emStrongRDelimAst:Ot,emStrongLDelim:Dt,url:z(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ht={...ye,br:z(Ve).replace("{2,}","*").getRegex(),text:z(ye.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},re={normal:_e,gfm:At,pedantic:Ct},W={normal:Ae,gfm:ye,breaks:Ht,pedantic:Vt},Zt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ee=h=>Zt[h];function N(h,e){if(e){if(P.escapeTest.test(h))return h.replace(P.escapeReplace,Ee)}else if(P.escapeTestNoEncode.test(h))return h.replace(P.escapeReplaceNoEncode,Ee);return h}function De(h){try{h=encodeURI(h).replace(P.percentDecode,"%")}catch{return null}return h}function Ne(h,e){var i;const t=h.replace(P.findPipe,(r,o,l)=>{let a=!1,p=o;for(;--p>=0&&l[p]==="\\";)a=!a;return a?"|":" |"}),s=t.split(P.splitPipe);let n=0;if(s[0].trim()||s.shift(),s.length>0&&!((i=s.at(-1))!=null&&i.trim())&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;n<s.length;n++)s[n]=s[n].trim().replace(P.slashPipe,"|");return s}function K(h,e,t){const s=h.length;if(s===0)return"";let n=0;for(;n<s&&h.charAt(s-n-1)===e;)n++;return h.slice(0,s-n)}function Wt(h,e){if(h.indexOf(e[1])===-1)return-1;let t=0;for(let s=0;s<h.length;s++)if(h[s]==="\\")s++;else if(h[s]===e[0])t++;else if(h[s]===e[1]&&(t--,t<0))return s;return-1}function Oe(h,e,t,s,n){const i=e.href,r=e.title||null,o=h[1].replace(n.other.outputLinkReplace,"$1");if(h[0].charAt(0)!=="!"){s.state.inLink=!0;const l={type:"link",raw:t,href:i,title:r,text:o,tokens:s.inlineTokens(o)};return s.state.inLink=!1,l}return{type:"image",raw:t,href:i,title:r,text:o}}function Kt(h,e,t){const s=h.match(t.other.indentCodeCompensation);if(s===null)return e;const n=s[1];return e.split(`
`).map(i=>{const r=i.match(t.other.beginningSpace);if(r===null)return i;const[o]=r;return o.length>=n.length?i.slice(n.length):i}).join(`
`)}class ue{constructor(e){v(this,"options");v(this,"rules");v(this,"lexer");this.options=e||J}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const s=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?s:K(s,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const s=t[0],n=Kt(s,t[3]||"",this.rules);return{type:"code",raw:s,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let s=t[2].trim();if(this.rules.other.endingHash.test(s)){const n=K(s,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(s=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:K(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let s=K(t[0],`
`).split(`
`),n="",i="";const r=[];for(;s.length>0;){let o=!1;const l=[];let a;for(a=0;a<s.length;a++)if(this.rules.other.blockquoteStart.test(s[a]))l.push(s[a]),o=!0;else if(!o)l.push(s[a]);else break;s=s.slice(a);const p=l.join(`
`),d=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${p}`:p,i=i?`${i}
${d}`:d;const f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,r,!0),this.lexer.state.top=f,s.length===0)break;const S=r.at(-1);if((S==null?void 0:S.type)==="code")break;if((S==null?void 0:S.type)==="blockquote"){const k=S,x=k.raw+`
`+s.join(`
`),w=this.blockquote(x);r[r.length-1]=w,n=n.substring(0,n.length-k.raw.length)+w.raw,i=i.substring(0,i.length-k.text.length)+w.text;break}else if((S==null?void 0:S.type)==="list"){const k=S,x=k.raw+`
`+s.join(`
`),w=this.list(x);r[r.length-1]=w,n=n.substring(0,n.length-S.raw.length)+w.raw,i=i.substring(0,i.length-k.raw.length)+w.raw,s=x.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:r,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let s=t[1].trim();const n=s.length>1,i={type:"list",raw:"",ordered:n,start:n?+s.slice(0,-1):"",loose:!1,items:[]};s=n?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=n?s:"[*+-]");const r=this.rules.other.listItemRegex(s);let o=!1;for(;e;){let a=!1,p="",d="";if(!(t=r.exec(e))||this.rules.block.hr.test(e))break;p=t[0],e=e.substring(p.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,m=>" ".repeat(3*m.length)),S=e.split(`
`,1)[0],k=!f.trim(),x=0;if(this.options.pedantic?(x=2,d=f.trimStart()):k?x=t[1].length+1:(x=t[2].search(this.rules.other.nonSpaceChar),x=x>4?1:x,d=f.slice(x),x+=t[1].length),k&&this.rules.other.blankLine.test(S)&&(p+=S+`
`,e=e.substring(S.length+1),a=!0),!a){const m=this.rules.other.nextBulletRegex(x),V=this.rules.other.hrRegex(x),D=this.rules.other.fencesBeginRegex(x),y=this.rules.other.headingBeginRegex(x),g=this.rules.other.htmlBeginRegex(x);for(;e;){const $=e.split(`
`,1)[0];let R;if(S=$,this.options.pedantic?(S=S.replace(this.rules.other.listReplaceNesting,"  "),R=S):R=S.replace(this.rules.other.tabCharGlobal,"    "),D.test(S)||y.test(S)||g.test(S)||m.test(S)||V.test(S))break;if(R.search(this.rules.other.nonSpaceChar)>=x||!S.trim())d+=`
`+R.slice(x);else{if(k||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||D.test(f)||y.test(f)||V.test(f))break;d+=`
`+S}!k&&!S.trim()&&(k=!0),p+=$+`
`,e=e.substring($.length+1),f=R.slice(x)}}i.loose||(o?i.loose=!0:this.rules.other.doubleBlankLine.test(p)&&(o=!0));let w=null,c;this.options.gfm&&(w=this.rules.other.listIsTask.exec(d),w&&(c=w[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:p,task:!!w,checked:c,loose:!1,text:d,tokens:[]}),i.raw+=p}const l=i.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let a=0;a<i.items.length;a++)if(this.lexer.state.top=!1,i.items[a].tokens=this.lexer.blockTokens(i.items[a].text,[]),!i.loose){const p=i.items[a].tokens.filter(f=>f.type==="space"),d=p.length>0&&p.some(f=>this.rules.other.anyLine.test(f.raw));i.loose=d}if(i.loose)for(let a=0;a<i.items.length;a++)i.items[a].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const s=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:s,raw:t[0],href:n,title:i}}}table(e){var o;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const s=Ne(t[1]),n=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(o=t[3])!=null&&o.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:t[0],header:[],align:[],rows:[]};if(s.length===n.length){for(const l of n)this.rules.other.tableAlignRight.test(l)?r.align.push("right"):this.rules.other.tableAlignCenter.test(l)?r.align.push("center"):this.rules.other.tableAlignLeft.test(l)?r.align.push("left"):r.align.push(null);for(let l=0;l<s.length;l++)r.header.push({text:s[l],tokens:this.lexer.inline(s[l]),header:!0,align:r.align[l]});for(const l of i)r.rows.push(Ne(l,r.header.length).map((a,p)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:r.align[p]})));return r}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const s=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:s,tokens:this.lexer.inline(s)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const s=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(s)){if(!this.rules.other.endAngleBracket.test(s))return;const r=K(s.slice(0,-1),"\\");if((s.length-r.length)%2===0)return}else{const r=Wt(t[2],"()");if(r>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let n=t[2],i="";if(this.options.pedantic){const r=this.rules.other.pedanticHrefTitle.exec(n);r&&(n=r[1],i=r[3])}else i=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(s)?n=n.slice(1):n=n.slice(1,-1)),Oe(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let s;if((s=this.rules.inline.reflink.exec(e))||(s=this.rules.inline.nolink.exec(e))){const n=(s[2]||s[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=t[n.toLowerCase()];if(!i){const r=s[0].charAt(0);return{type:"text",raw:r,text:r}}return Oe(s,i,s[0],this.lexer,this.rules)}}emStrong(e,t,s=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!n||n[3]&&s.match(this.rules.other.unicodeAlphaNumeric))return;if(!(n[1]||n[2]||"")||!s||this.rules.inline.punctuation.exec(s)){const r=[...n[0]].length-1;let o,l,a=r,p=0;const d=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+r);(n=d.exec(t))!=null;){if(o=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!o)continue;if(l=[...o].length,n[3]||n[4]){a+=l;continue}else if((n[5]||n[6])&&r%3&&!((r+l)%3)){p+=l;continue}if(a-=l,a>0)continue;l=Math.min(l,l+a+p);const f=[...n[0]][0].length,S=e.slice(0,r+n.index+f+l);if(Math.min(r,l)%2){const x=S.slice(1,-1);return{type:"em",raw:S,text:x,tokens:this.lexer.inlineTokens(x)}}const k=S.slice(2,-2);return{type:"strong",raw:S,text:k,tokens:this.lexer.inlineTokens(k)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let s=t[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(s),i=this.rules.other.startingSpaceChar.test(s)&&this.rules.other.endingSpaceChar.test(s);return n&&i&&(s=s.substring(1,s.length-1)),{type:"codespan",raw:t[0],text:s}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let s,n;return t[2]==="@"?(s=t[1],n="mailto:"+s):(s=t[1],n=s),{type:"link",raw:t[0],text:s,href:n,tokens:[{type:"text",raw:s,text:s}]}}}url(e){var s;let t;if(t=this.rules.inline.url.exec(e)){let n,i;if(t[2]==="@")n=t[0],i="mailto:"+n;else{let r;do r=t[0],t[0]=((s=this.rules.inline._backpedal.exec(t[0]))==null?void 0:s[0])??"";while(r!==t[0]);n=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const s=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:s}}}}class L{constructor(e){v(this,"tokens");v(this,"options");v(this,"state");v(this,"tokenizer");v(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||J,this.options.tokenizer=this.options.tokenizer||new ue,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:P,block:re.normal,inline:W.normal};this.options.pedantic?(t.block=re.pedantic,t.inline=W.pedantic):this.options.gfm&&(t.block=re.gfm,this.options.breaks?t.inline=W.breaks:t.inline=W.gfm),this.tokenizer.rules=t}static get rules(){return{block:re,inline:W}}static lex(e,t){return new L(t).lex(e)}static lexInline(e,t){return new L(t).inlineTokens(e)}lex(e){e=e.replace(P.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const s=this.inlineQueue[t];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],s=!1){var n,i,r;for(this.options.pedantic&&(e=e.replace(P.tabCharGlobal,"    ").replace(P.spaceLine,""));e;){let o;if((i=(n=this.options.extensions)==null?void 0:n.block)!=null&&i.some(a=>(o=a.call({lexer:this},e,t))?(e=e.substring(o.raw.length),t.push(o),!0):!1))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);const a=t.at(-1);o.raw.length===1&&a!==void 0?a.raw+=`
`:t.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);const a=t.at(-1);(a==null?void 0:a.type)==="paragraph"||(a==null?void 0:a.type)==="text"?(a.raw+=`
`+o.raw,a.text+=`
`+o.text,this.inlineQueue.at(-1).src=a.text):t.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);const a=t.at(-1);(a==null?void 0:a.type)==="paragraph"||(a==null?void 0:a.type)==="text"?(a.raw+=`
`+o.raw,a.text+=`
`+o.raw,this.inlineQueue.at(-1).src=a.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),t.push(o);continue}let l=e;if((r=this.options.extensions)!=null&&r.startBlock){let a=1/0;const p=e.slice(1);let d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},p),typeof d=="number"&&d>=0&&(a=Math.min(a,d))}),a<1/0&&a>=0&&(l=e.substring(0,a+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const a=t.at(-1);s&&(a==null?void 0:a.type)==="paragraph"?(a.raw+=`
`+o.raw,a.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):t.push(o),s=l.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);const a=t.at(-1);(a==null?void 0:a.type)==="text"?(a.raw+=`
`+o.raw,a.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):t.push(o);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var o,l,a;let s=e,n=null;if(this.tokens.links){const p=Object.keys(this.tokens.links);if(p.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)p.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,n.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(n=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,r="";for(;e;){i||(r=""),i=!1;let p;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(f=>(p=f.call({lexer:this},e,t))?(e=e.substring(p.raw.length),t.push(p),!0):!1))continue;if(p=this.tokenizer.escape(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.tag(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.link(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(p.raw.length);const f=t.at(-1);p.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=p.raw,f.text+=p.text):t.push(p);continue}if(p=this.tokenizer.emStrong(e,s,r)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.codespan(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.br(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.del(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.autolink(e)){e=e.substring(p.raw.length),t.push(p);continue}if(!this.state.inLink&&(p=this.tokenizer.url(e))){e=e.substring(p.raw.length),t.push(p);continue}let d=e;if((a=this.options.extensions)!=null&&a.startInline){let f=1/0;const S=e.slice(1);let k;this.options.extensions.startInline.forEach(x=>{k=x.call({lexer:this},S),typeof k=="number"&&k>=0&&(f=Math.min(f,k))}),f<1/0&&f>=0&&(d=e.substring(0,f+1))}if(p=this.tokenizer.inlineText(d)){e=e.substring(p.raw.length),p.raw.slice(-1)!=="_"&&(r=p.raw.slice(-1)),i=!0;const f=t.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=p.raw,f.text+=p.text):t.push(p);continue}if(e){const f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return t}}class ce{constructor(e){v(this,"options");v(this,"parser");this.options=e||J}space(e){return""}code({text:e,lang:t,escaped:s}){var r;const n=(r=(t||"").match(P.notSpaceStart))==null?void 0:r[0],i=e.replace(P.endingNewline,"")+`
`;return n?'<pre><code class="language-'+N(n)+'">'+(s?i:N(i,!0))+`</code></pre>
`:"<pre><code>"+(s?i:N(i,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,s=e.start;let n="";for(let o=0;o<e.items.length;o++){const l=e.items[o];n+=this.listitem(l)}const i=t?"ol":"ul",r=t&&s!==1?' start="'+s+'"':"";return"<"+i+r+`>
`+n+"</"+i+`>
`}listitem(e){var s;let t="";if(e.task){const n=this.checkbox({checked:!!e.checked});e.loose?((s=e.tokens[0])==null?void 0:s.type)==="paragraph"?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=n+" "+N(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",s="";for(let i=0;i<e.header.length;i++)s+=this.tablecell(e.header[i]);t+=this.tablerow({text:s});let n="";for(let i=0;i<e.rows.length;i++){const r=e.rows[i];s="";for(let o=0;o<r.length;o++)s+=this.tablecell(r[o]);n+=this.tablerow({text:s})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),s=e.header?"th":"td";return(e.align?`<${s} align="${e.align}">`:`<${s}>`)+t+`</${s}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${N(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:s}){const n=this.parser.parseInline(s),i=De(e);if(i===null)return n;e=i;let r='<a href="'+e+'"';return t&&(r+=' title="'+N(t)+'"'),r+=">"+n+"</a>",r}image({href:e,title:t,text:s}){const n=De(e);if(n===null)return N(s);e=n;let i=`<img src="${e}" alt="${s}"`;return t&&(i+=` title="${N(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:N(e.text)}}class Ce{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class E{constructor(e){v(this,"options");v(this,"renderer");v(this,"textRenderer");this.options=e||J,this.options.renderer=this.options.renderer||new ce,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Ce}static parse(e,t){return new E(t).parse(e)}static parseInline(e,t){return new E(t).parseInline(e)}parse(e,t=!0){var n,i;let s="";for(let r=0;r<e.length;r++){const o=e[r];if((i=(n=this.options.extensions)==null?void 0:n.renderers)!=null&&i[o.type]){const a=o,p=this.options.extensions.renderers[a.type].call({parser:this},a);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){s+=p||"";continue}}const l=o;switch(l.type){case"space":{s+=this.renderer.space(l);continue}case"hr":{s+=this.renderer.hr(l);continue}case"heading":{s+=this.renderer.heading(l);continue}case"code":{s+=this.renderer.code(l);continue}case"table":{s+=this.renderer.table(l);continue}case"blockquote":{s+=this.renderer.blockquote(l);continue}case"list":{s+=this.renderer.list(l);continue}case"html":{s+=this.renderer.html(l);continue}case"paragraph":{s+=this.renderer.paragraph(l);continue}case"text":{let a=l,p=this.renderer.text(a);for(;r+1<e.length&&e[r+1].type==="text";)a=e[++r],p+=`
`+this.renderer.text(a);t?s+=this.renderer.paragraph({type:"paragraph",raw:p,text:p,tokens:[{type:"text",raw:p,text:p,escaped:!0}]}):s+=p;continue}default:{const a='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return s}parseInline(e,t=this.renderer){var n,i;let s="";for(let r=0;r<e.length;r++){const o=e[r];if((i=(n=this.options.extensions)==null?void 0:n.renderers)!=null&&i[o.type]){const a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){s+=a||"";continue}}const l=o;switch(l.type){case"escape":{s+=t.text(l);break}case"html":{s+=t.html(l);break}case"link":{s+=t.link(l);break}case"image":{s+=t.image(l);break}case"strong":{s+=t.strong(l);break}case"em":{s+=t.em(l);break}case"codespan":{s+=t.codespan(l);break}case"br":{s+=t.br(l);break}case"del":{s+=t.del(l);break}case"text":{s+=t.text(l);break}default:{const a='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return s}}class se{constructor(e){v(this,"options");v(this,"block");this.options=e||J}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?L.lex:L.lexInline}provideParser(){return this.block?E.parse:E.parseInline}}v(se,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class Xt{constructor(...e){v(this,"defaults",ke());v(this,"options",this.setOptions);v(this,"parse",this.parseMarkdown(!0));v(this,"parseInline",this.parseMarkdown(!1));v(this,"Parser",E);v(this,"Renderer",ce);v(this,"TextRenderer",Ce);v(this,"Lexer",L);v(this,"Tokenizer",ue);v(this,"Hooks",se);this.use(...e)}walkTokens(e,t){var n,i;let s=[];for(const r of e)switch(s=s.concat(t.call(this,r)),r.type){case"table":{const o=r;for(const l of o.header)s=s.concat(this.walkTokens(l.tokens,t));for(const l of o.rows)for(const a of l)s=s.concat(this.walkTokens(a.tokens,t));break}case"list":{const o=r;s=s.concat(this.walkTokens(o.items,t));break}default:{const o=r;(i=(n=this.defaults.extensions)==null?void 0:n.childTokens)!=null&&i[o.type]?this.defaults.extensions.childTokens[o.type].forEach(l=>{const a=o[l].flat(1/0);s=s.concat(this.walkTokens(a,t))}):o.tokens&&(s=s.concat(this.walkTokens(o.tokens,t)))}}return s}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(s=>{const n={...s};if(n.async=this.defaults.async||n.async||!1,s.extensions&&(s.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const r=t.renderers[i.name];r?t.renderers[i.name]=function(...o){let l=i.renderer.apply(this,o);return l===!1&&(l=r.apply(this,o)),l}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const r=t[i.level];r?r.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),n.extensions=t),s.renderer){const i=this.defaults.renderer||new ce(this.defaults);for(const r in s.renderer){if(!(r in i))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;const o=r,l=s.renderer[o],a=i[o];i[o]=(...p)=>{let d=l.apply(i,p);return d===!1&&(d=a.apply(i,p)),d||""}}n.renderer=i}if(s.tokenizer){const i=this.defaults.tokenizer||new ue(this.defaults);for(const r in s.tokenizer){if(!(r in i))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const o=r,l=s.tokenizer[o],a=i[o];i[o]=(...p)=>{let d=l.apply(i,p);return d===!1&&(d=a.apply(i,p)),d}}n.tokenizer=i}if(s.hooks){const i=this.defaults.hooks||new se;for(const r in s.hooks){if(!(r in i))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;const o=r,l=s.hooks[o],a=i[o];se.passThroughHooks.has(r)?i[o]=p=>{if(this.defaults.async)return Promise.resolve(l.call(i,p)).then(f=>a.call(i,f));const d=l.call(i,p);return a.call(i,d)}:i[o]=(...p)=>{let d=l.apply(i,p);return d===!1&&(d=a.apply(i,p)),d}}n.hooks=i}if(s.walkTokens){const i=this.defaults.walkTokens,r=s.walkTokens;n.walkTokens=function(o){let l=[];return l.push(r.call(this,o)),i&&(l=l.concat(i.call(this,o))),l}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return L.lex(e,t??this.defaults)}parser(e,t){return E.parse(e,t??this.defaults)}parseMarkdown(e){return(s,n)=>{const i={...n},r={...this.defaults,...i},o=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&i.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof s>"u"||s===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=e);const l=r.hooks?r.hooks.provideLexer():e?L.lex:L.lexInline,a=r.hooks?r.hooks.provideParser():e?E.parse:E.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(s):s).then(p=>l(p,r)).then(p=>r.hooks?r.hooks.processAllTokens(p):p).then(p=>r.walkTokens?Promise.all(this.walkTokens(p,r.walkTokens)).then(()=>p):p).then(p=>a(p,r)).then(p=>r.hooks?r.hooks.postprocess(p):p).catch(o);try{r.hooks&&(s=r.hooks.preprocess(s));let p=l(s,r);r.hooks&&(p=r.hooks.processAllTokens(p)),r.walkTokens&&this.walkTokens(p,r.walkTokens);let d=a(p,r);return r.hooks&&(d=r.hooks.postprocess(d)),d}catch(p){return o(p)}}}onError(e,t){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const n="<p>An error occurred:</p><pre>"+N(s.message+"",!0)+"</pre>";return t?Promise.resolve(n):n}if(t)return Promise.reject(s);throw s}}}const U=new Xt;function _(h,e){return U.parse(h,e)}_.options=_.setOptions=function(h){return U.setOptions(h),_.defaults=U.defaults,Ge(_.defaults),_};_.getDefaults=ke;_.defaults=J;_.use=function(...h){return U.use(...h),_.defaults=U.defaults,Ge(_.defaults),_};_.walkTokens=function(h,e){return U.walkTokens(h,e)};_.parseInline=U.parseInline;_.Parser=E;_.parser=E.parse;_.Renderer=ce;_.TextRenderer=Ce;_.Lexer=L;_.lexer=L.lex;_.Tokenizer=ue;_.Hooks=se;_.parse=_;_.options;_.setOptions;_.use;_.walkTokens;_.parseInline;E.parse;L.lex;var et=(h=>(h.NORMAL="normal",h.RANDOM="random",h.EXAM="exam",h.WRONG="wrong",h.REVIEW="review",h.RANGE="range",h))(et||{}),Yt=(h=>(h.LOCAL="local",h.ONLINE_IMPORT="online-import",h.REMOTE_IMPORT="remote-import",h.ONLINE="online",h.REMOTE="remote",h))(Yt||{}),es=(h=>(h.CACHE="cache",h.ONLINE="online",h.REMOTE="remote",h))(es||{});const fe="app_settings",tt={darkMode:window.matchMedia("(prefers-color-scheme: dark)").matches,themeColor:"default",customColor:"#4caf50",fontSize:14,fontFamily:"sans-serif",animationEnabled:!1},st={autoSubmit:!1,autoNext:!1,allowSkip:!1,showNotesAfterAnswer:!1,lockAnswerAfterSubmit:!1,showCorrectAnswerImmediately:!1,showProgress:!1,swipeGestureEnabled:!1,randomMode:!1,reviewMode:!1,viewWrongAfterAll:!1,canEditQuestion:!1},B={enabled:!1,autoGenerate:!1,streamOutput:!1,autoSync:!1,apiUrl:"",apiKey:"",model:"",systemPrompt:"",temperature:.7,maxTokens:2e3,topP:1},nt={owner:"",repo:"",branch:"main",path:"",token:"",forceSync:!1,syncQuizName:"",createRemoteRepo:!1},X={uiSettings:tt,quizSettings:st,debugEnabled:!1,githubConfig:nt,lastSyncTimestamp:0,apiPresets:[Y(B)],activeApiPresetName:"Default"},de={chapterIndex:"all",mode:"normal",rangeStart:1,rangeEnd:50,randomize:!1,wrongOnly:!1};function Y(h,e="Default"){const t={...B,...h};return{name:e,...t}}class ts{constructor(){v(this,"settings");v(this,"version","1.0");v(this,"listeners",new Map);v(this,"quizState",me({quizData:null,config:{...de},lastLoaded:{name:"",source:""},stats:{totalAnswered:0,correctCount:0,wrongCount:0,dailyActivity:[0,0,0,0,0,0,0]}}));v(this,"state",lt(this.quizState));const e=this.loadSettings();this.settings=me(e),this.applyTheme(),this.initQuizFromStorage()}loadSettings(){try{const e=localStorage.getItem(fe);if(e){const t=JSON.parse(e);return this.mergeWithDefaults(t)}return{...X}}catch(e){console.error("加载配置失败:",e);const t={...X};return(!t.apiPresets||t.apiPresets.length===0)&&(t.apiPresets=[Y(B)],t.activeApiPresetName="Default"),(!t.activeApiPresetName||!t.apiPresets.some(s=>s.name===t.activeApiPresetName))&&(t.activeApiPresetName=t.apiPresets[0].name),t}}mergeWithDefaults(e){var n;const t=e.apiPresets&&e.apiPresets.length>0?e.apiPresets.map(i=>({...B,...i})):[...X.apiPresets],s=e.activeApiPresetName&&t.some(i=>i.name===e.activeApiPresetName)?e.activeApiPresetName:((n=t[0])==null?void 0:n.name)||"Default";return{uiSettings:{...tt,...e.uiSettings},quizSettings:{...st,...e.quizSettings},debugEnabled:e.debugEnabled??X.debugEnabled,githubConfig:{...nt,...e.githubConfig},lastSyncTimestamp:e.lastSyncTimestamp??0,apiPresets:t,activeApiPresetName:s}}saveSettings(){try{localStorage.setItem(fe,JSON.stringify(this.settings)),this.notifyListeners("settings")}catch(e){console.error("保存配置失败:",e),b("保存配置失败: "+e.message,"error")}}applyTheme(){const{darkMode:e,fontSize:t,fontFamily:s}=this.settings.uiSettings;document.documentElement.setAttribute("theme",e?"dark":"light"),document.documentElement.style.setProperty("--font-size",`${t}px`),document.documentElement.style.setProperty("--font-family",s)}addListener(e,t){var s;this.listeners.has(e)||this.listeners.set(e,[]),(s=this.listeners.get(e))==null||s.push(t)}removeListener(e,t){if(this.listeners.has(e)){const s=this.listeners.get(e),n=(s==null?void 0:s.indexOf(t))??-1;n!==-1&&s&&s.splice(n,1)}}notifyListeners(e){const t=this.listeners.get(e);t&&t.forEach(s=>s()),e!=="settings"&&this.notifyListeners("settings")}getSettings(){const e={...this.settings};return(!e.apiPresets||e.apiPresets.length===0)&&(e.apiPresets=[Y(B)],e.activeApiPresetName="Default"),(!e.activeApiPresetName||!e.apiPresets.some(t=>t.name===e.activeApiPresetName))&&(e.activeApiPresetName=e.apiPresets[0].name),e}getUiSettings(){return{...this.settings.uiSettings}}updateUiSettings(e,t=!0){Object.assign(this.settings.uiSettings,e),this.applyTheme(),t&&(this.saveSettings(),this.notifyListeners("ui"),b("界面设置已保存","success"))}toggleDarkMode(){const e=!this.settings.uiSettings.darkMode;this.updateUiSettings({darkMode:e})}setFontSize(e){this.updateUiSettings({fontSize:e})}getQuizSettings(){return{...this.settings.quizSettings}}updateQuizSettings(e,t=!0){Object.assign(this.settings.quizSettings,e),e.randomMode!==void 0&&(this.quizState.config.randomize=e.randomMode),(e.randomMode!==void 0||e.reviewMode!==void 0)&&(e.reviewMode?this.quizState.config.mode="review":e.randomMode?this.quizState.config.mode="random":this.quizState.config.mode="normal",this.saveQuizConfigToStorage()),t&&(this.saveSettings(),this.notifyListeners("quiz"),b("测验设置已保存","success"))}getApiConfig(){const e=this.settings.apiPresets.find(n=>n.name===this.settings.activeApiPresetName);if(!e){console.warn(`活动预设 "${this.settings.activeApiPresetName}" 未找到，返回第一个预设或默认。`);const n=this.settings.apiPresets[0]||Y(B),{name:i,...r}=n;return r}const{name:t,...s}=e;return s}updateApiConfig(e,t=!0){const s=this.settings.apiPresets.findIndex(n=>n.name===this.settings.activeApiPresetName);if(s===-1){console.error(`无法更新：活动预设 "${this.settings.activeApiPresetName}" 未找到。`),b("更新API配置失败：未找到活动预设","error");return}this.settings.apiPresets[s]={...this.settings.apiPresets[s],...e},this.saveSettings(),this.notifyListeners("api"),t&&b(`API预设 "${this.settings.activeApiPresetName}" 已保存`,"success")}getApiPresets(){return JSON.parse(JSON.stringify(this.settings.apiPresets))}getActiveApiPresetName(){return this.settings.activeApiPresetName}addApiPreset(e,t){if(!e||e.trim()==="")return b("预设名称不能为空","error"),!1;if(e=e.trim(),this.settings.apiPresets.some(i=>i.name===e))return b(`预设名称 "${e}" 已存在`,"error"),!1;const s=t||this.settings.activeApiPresetName,n=this.settings.apiPresets.find(i=>i.name===s);if(n){const i={...n,name:e};this.settings.apiPresets.push(i)}else{console.error(`无法复制配置：源预设 "${s}" 未找到。将使用默认配置创建。`);const i=Y({...B},e);this.settings.apiPresets.push(i)}return this.saveSettings(),this.notifyListeners("api"),b(`已添加预设 "${e}"`,"success"),!0}deleteApiPreset(e){if(this.settings.apiPresets.length<=1)return b("无法删除最后一个预设","warning"),!1;const t=this.settings.apiPresets.findIndex(s=>s.name===e);return t===-1?(b(`未找到要删除的预设 "${e}"`,"error"),!1):(this.settings.apiPresets.splice(t,1),this.settings.activeApiPresetName===e&&(this.settings.activeApiPresetName=this.settings.apiPresets[0].name,this.notifyListeners("api")),this.saveSettings(),this.notifyListeners("api"),b(`已删除预设 "${e}"`,"success"),!0)}setActiveApiPreset(e){return this.settings.apiPresets.some(s=>s.name===e)?(this.settings.activeApiPresetName!==e&&(this.settings.activeApiPresetName=e,this.saveSettings(),this.notifyListeners("api")),!0):(b(`未找到预设 "${e}"`,"error"),!1)}renameApiPreset(e,t){if(!t||t.trim()==="")return b("新预设名称不能为空","error"),!1;if(t=t.trim(),e===t)return!0;if(this.settings.apiPresets.some(n=>n.name===t))return b(`预设名称 "${t}" 已存在`,"error"),!1;const s=this.settings.apiPresets.findIndex(n=>n.name===e);return s===-1?(b(`未找到要重命名的预设 "${e}"`,"error"),!1):(this.settings.apiPresets[s].name=t,this.settings.activeApiPresetName===e&&(this.settings.activeApiPresetName=t),this.saveSettings(),this.notifyListeners("api"),b(`预设 "${e}" 已重命名为 "${t}"`,"success"),!0)}getGithubConfig(){return{...this.settings.githubConfig}}updateGithubConfig(e,t=!0){const s={owner:e.owner??this.settings.githubConfig.owner,repo:e.repo??this.settings.githubConfig.repo,branch:e.branch??this.settings.githubConfig.branch,path:e.path??this.settings.githubConfig.path,token:e.token??this.settings.githubConfig.token,forceSync:e.forceSync??this.settings.githubConfig.forceSync,syncQuizName:e.syncQuizName??this.settings.githubConfig.syncQuizName,createRemoteRepo:e.createRemoteRepo??this.settings.githubConfig.createRemoteRepo};this.settings.githubConfig=s,this.saveSettings(),this.settings.lastSyncTimestamp=Date.now(),this.notifyListeners("github"),t&&b("GitHub设置已保存","success")}getLastSyncTimestamp(){return this.settings.lastSyncTimestamp||0}updateSyncTimestamp(){this.settings.lastSyncTimestamp=Date.now(),this.saveSettings()}isDebugEnabled(){return!!this.settings.debugEnabled}setDebugEnabled(e,t=!0){this.settings.debugEnabled=e,t&&(this.saveSettings(),this.notifyListeners("settings"),b(e?"调试模式已启用":"调试模式已禁用","info"))}saveGeneralSettings(e){Object.assign(this.settings.uiSettings,e.uiSettings),Object.assign(this.settings.quizSettings,e.quizSettings),this.settings.debugEnabled=e.debugEnabled;const{randomMode:t,reviewMode:s}=e.quizSettings;s?this.quizState.config.mode="review":t?this.quizState.config.mode="random":this.quizState.config.mode="normal",this.quizState.config.randomize=t,this.saveSettings(),this.saveQuizConfigToStorage(),this.applyTheme(),this.notifyListeners("settings"),this.notifyListeners("ui"),this.notifyListeners("quiz"),b("通用设置已保存","success")}exportConfig(){try{const e={timestamp:new Date().toISOString(),version:this.version,exportDate:new Date().toISOString(),generalSettings:{uiSettings:this.settings.uiSettings,debugEnabled:this.settings.debugEnabled},quizSettings:this.settings.quizSettings,apiPresets:this.settings.apiPresets,activeApiPresetName:this.settings.activeApiPresetName,repoSettings:this.settings.githubConfig,stats:{}},t=localStorage.getItem("userStats");t&&(e.stats=JSON.parse(t),e.statisticsData=JSON.parse(t));const s=JSON.stringify(e,null,2),n="data:application/json;charset=utf-8,"+encodeURIComponent(s),i=`elyxira-config-${new Date().toISOString().split("T")[0]}.json`,r=document.createElement("a");return r.setAttribute("href",n),r.setAttribute("download",i),r.click(),b("配置已导出","success"),i}catch(e){throw console.error("导出配置失败:",e),b(`导出配置失败: ${e.message}`,"error"),e}}importConfig(e){try{if(!this.validateConfigData(e))return b("无效的配置文件格式或版本不兼容","error"),!1;const t=e,s={...this.settings};return t.generalSettings&&(t.generalSettings.uiSettings&&(s.uiSettings={...this.settings.uiSettings,...t.generalSettings.uiSettings}),s.debugEnabled="debugEnabled"in t.generalSettings?!!t.generalSettings.debugEnabled:this.settings.debugEnabled),t.quizSettings&&(s.quizSettings={...this.settings.quizSettings,...t.quizSettings}),t.apiPresets&&Array.isArray(t.apiPresets)&&t.apiPresets.length>0&&(s.apiPresets=t.apiPresets.map(n=>{const i=typeof n.name=="string"&&n.name.trim()?n.name.trim():`Imported-${Date.now()}`;return{...B,...n,name:i}}),t.activeApiPresetName&&s.apiPresets.some(n=>n.name===t.activeApiPresetName)?s.activeApiPresetName=t.activeApiPresetName:s.activeApiPresetName=s.apiPresets[0].name),t.repoSettings&&(s.githubConfig={...this.settings.githubConfig,...t.repoSettings}),this.settings=s,this.saveSettings(),this.applyTheme(),(t.stats||t.statisticsData)&&localStorage.setItem("userStats",JSON.stringify(t.stats||t.statisticsData)),this.notifyListeners("settings"),this.notifyListeners("ui"),this.notifyListeners("quiz"),this.notifyListeners("api"),this.notifyListeners("github"),b("配置已成功导入","success"),!0}catch(t){return console.error("导入配置失败:",t),b("导入配置失败："+t.message,"error"),!1}}validateConfigData(e){if(!e||typeof e!="object")return!1;const t=e;return"timestamp"in t&&"version"in t&&typeof t.timestamp=="string"&&typeof t.version=="string"}resetAllSettings(){this.settings={...X},localStorage.removeItem(fe),localStorage.removeItem("userStats"),localStorage.removeItem("quizStats"),localStorage.removeItem("quizData"),localStorage.removeItem("lastLoadedQuiz"),localStorage.removeItem("cachedQuizList"),this.saveSettings(),this.applyTheme(),this.quizState.quizData=null,this.quizState.config={...de},this.quizState.lastLoaded={name:"",source:""},this.quizState.stats={totalAnswered:0,correctCount:0,wrongCount:0,dailyActivity:[0,0,0,0,0,0,0]},this.notifyListeners("settings"),this.notifyListeners("ui"),this.notifyListeners("quiz"),this.notifyListeners("api"),this.notifyListeners("github"),b("所有设置已重置为默认值","success")}clearQuizCache(){try{let e=0;for(let t=localStorage.length-1;t>=0;t--){const s=localStorage.key(t);s&&(s.startsWith("quizCache_")||s==="cachedQuizList")&&(localStorage.removeItem(s),e++)}return e>0?b(`已清除 ${e} 项题库缓存`,"success"):b("没有找到题库缓存","info"),e>0}catch(e){return console.error("清除题库缓存失败:",e),b(`清除缓存失败: ${e.message}`,"error"),!1}}getCacheStats(){let e=0;const t=[];for(let s=0;s<localStorage.length;s++){const n=localStorage.key(s);if(n){const i=localStorage.getItem(n)||"",r=(n.length+i.length)*2;e+=r,n.startsWith("quizCache_")&&t.push({key:n.replace("quizCache_",""),size:r})}}return{totalSize:e,items:t}}saveQuizToStorage(e,t){const s=`quizCache_${e}`;localStorage.setItem(s,JSON.stringify(t))}loadQuizFromStorage(e){const t=`quizCache_${e}`,s=localStorage.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(n){return console.error(`解析缓存题库失败: ${e}`,n),null}}removeQuizFromStorage(e){const t=`quizCache_${e}`;localStorage.removeItem(t)}saveQuizList(e){localStorage.setItem("cachedQuizList",JSON.stringify(e))}loadQuizList(){const e=localStorage.getItem("cachedQuizList");if(!e)return[];try{return JSON.parse(e)}catch(t){return console.error("解析题库列表失败",t),[]}}saveLastLoadedQuiz(e,t){this.quizState.lastLoaded.name=e,this.quizState.lastLoaded.source=t,localStorage.setItem("lastLoadedQuiz",JSON.stringify({name:e,source:t}))}getLastLoadedQuiz(){if(this.quizState.lastLoaded.name)return{...this.quizState.lastLoaded};const e=localStorage.getItem("lastLoadedQuiz");if(!e)return null;try{return JSON.parse(e)}catch{return null}}clearAllQuizStorage(){this.loadQuizList().forEach(t=>{const s=`quizCache_${t.name}`;localStorage.removeItem(s)}),localStorage.removeItem("cachedQuizList"),localStorage.removeItem("lastLoadedQuiz"),localStorage.removeItem("quizData"),this.quizState.quizData=null,this.quizState.lastLoaded={name:"",source:""},this.quizState.config={...de},b("已清除所有题库缓存","success")}getQuizData(){return this.quizState.quizData}setQuizData(e){this.quizState.quizData=e}getQuizConfig(){return{...this.quizState.config}}setQuizConfig(e){this.quizState.config={...this.quizState.config,...e},this.saveQuizConfigToStorage()}saveQuizConfigToStorage(){localStorage.setItem("selectedChapter",this.quizState.config.chapterIndex),localStorage.setItem("quizMode",this.quizState.config.mode),localStorage.setItem("rangeStart",this.quizState.config.rangeStart.toString()),localStorage.setItem("rangeEnd",this.quizState.config.rangeEnd.toString())}initQuizFromStorage(){try{const e=localStorage.getItem("quizData");if(e)this.quizState.quizData=JSON.parse(e);else return!1;const t=localStorage.getItem("lastLoadedQuiz");t&&(this.quizState.lastLoaded=JSON.parse(t));const s=localStorage.getItem("selectedChapter");s&&(this.quizState.config.chapterIndex=s);const n=localStorage.getItem("quizMode");n&&Object.values(et).includes(n)&&(this.quizState.config.mode=n);const i=localStorage.getItem("rangeStart");i&&(this.quizState.config.rangeStart=parseInt(i));const r=localStorage.getItem("rangeEnd");return r&&(this.quizState.config.rangeEnd=parseInt(r)),this.loadQuizStatsFromStorage(),!0}catch(e){return console.error("从本地存储恢复状态失败:",e),!1}}saveQuizState(){this.quizState.quizData&&(localStorage.setItem("quizData",JSON.stringify(this.quizState.quizData)),this.saveQuizConfigToStorage(),localStorage.setItem("lastLoadedQuiz",JSON.stringify(this.quizState.lastLoaded)),this.quizState.lastLoaded.name&&this.saveQuizToStorage(this.quizState.lastLoaded.name,this.quizState.quizData))}loadQuizStatsFromStorage(){try{const e=localStorage.getItem("quizStats");if(e){const t=JSON.parse(e);this.quizState.stats={...this.quizState.stats,...t}}}catch(e){console.error("加载统计数据失败:",e)}}saveQuizStatsToStorage(){localStorage.setItem("quizStats",JSON.stringify(this.quizState.stats))}updateQuizStats(e){e.totalAnswered!==void 0&&(this.quizState.stats.totalAnswered=e.totalAnswered),e.correctCount!==void 0&&(this.quizState.stats.correctCount=e.correctCount),e.wrongCount!==void 0&&(this.quizState.stats.wrongCount=e.wrongCount);const t=new Date().getDay();this.quizState.stats.dailyActivity[t]++,this.saveQuizStatsToStorage()}getQuizChapters(){return!this.quizState.quizData||!this.quizState.quizData.chapters?[]:this.quizState.quizData.chapters.map(e=>e.title)}getQuizTotalQuestions(){return!this.quizState.quizData||!this.quizState.quizData.chapters?0:this.quizState.quizData.chapters.reduce((e,t)=>{var s;return e+(((s=t.questions)==null?void 0:s.length)||0)},0)}getQuizAnsweredCount(){return this.quizState.stats.totalAnswered}getQuizCorrectCount(){return this.quizState.stats.correctCount}getQuizAccuracyRate(){const e=this.quizState.stats.totalAnswered;return e===0?"0%":Math.round(this.quizState.stats.correctCount/e*100)+"%"}clearCurrentQuiz(){this.quizState.quizData=null,this.quizState.lastLoaded={name:"",source:""},localStorage.removeItem("quizData"),localStorage.removeItem("lastLoadedQuiz")}async syncQuizFromGithub(e){try{const t=this.getGithubConfig();if(!this.validateGithubConfig(t))return b("GitHub配置不完整","error"),null;const s=t.path||"quizzes",n=`https://api.github.com/repos/${t.owner}/${t.repo}/contents/${s}?ref=${t.branch}`,i=await fetch(n,{headers:{Authorization:`token ${t.token}`,Accept:"application/vnd.github.v3+json"}});if(!i.ok)return b(`获取远程题库列表失败 (${i.status})`,"error"),null;const r=await i.json(),o=Array.isArray(r)?r.filter(c=>c.type==="file"&&(c.name.endsWith(".json")||c.name.endsWith(".txt"))):[];if(o.length===0)return b("远程仓库中未找到任何题库文件","error"),null;let l=o.find(c=>c.name===`${e}.json`||c.name===`${e}.txt`);if(l||(l=o.find(c=>c.name.toLowerCase().includes(e.toLowerCase()))),!l){if(b(`远程仓库中未找到匹配的题库：${e}`,"error"),o.length>0){const c=o.map(m=>m.name.replace(/\.(json|txt)$/,"")).join(", ");console.info(`远程仓库中可用的题库: ${c}`)}return null}const a=await fetch(l.download_url);if(!a.ok)return b("下载题库内容失败","error"),null;const p=l.name.replace(/\.(json|txt)$/,""),d=await a.text();let f;try{const c=JSON.parse(d);f=oe.parse(c,p)}catch{return b("解析题库数据失败：无效的JSON格式","error"),null}if(!this.enhancedValidQuizData(f))return b("无效的题库数据格式","error"),null;const S=this.loadQuizFromStorage(p);S&&(console.log(`合并本地题库笔记: ${p}`),S.chapters.forEach(c=>{c.questions.forEach(m=>{m.id&&(m.notes||m.userAnswer!==void 0)&&f.chapters.forEach(V=>{const D=V.questions.find(y=>y.id===m.id);D&&(m.notes&&(!D.notes||D.notes.trim()==="")&&(console.log(`保留本地笔记: 题目ID=${m.id}, 笔记长度=${m.notes.length}`),D.notes=m.notes),m.userAnswer!==void 0&&(D.userAnswer=m.userAnswer))})})})),this.saveQuizToStorage(p,f);const k=this.loadQuizList(),x=k.findIndex(c=>c.name===p&&c.source==="remote-import"),w={id:`remote-import-${Date.now()}`,name:p,path:"localStorage",source:"remote-import",info:`从GitHub同步：${t.owner}/${t.repo}`,title:f.title||p,lastModified:Date.now(),data:f};return x>=0?k[x]=w:k.push(w),this.saveQuizList(k),this.updateSyncTimestamp(),b(`成功从GitHub同步题库：${p}`,"success"),f}catch(t){return b(`同步题库失败：${t.message}`,"error"),null}}async pushQuizToGithub(e,t){try{const s=this.getGithubConfig();if(!this.validateGithubConfig(s))return b("GitHub配置不完整","error"),!1;const n=this.loadQuizFromStorage(e);if(!n)return b(`本地未找到题库：${e}`,"error"),!1;if(this.quizState.quizData&&this.quizState.quizData.title===n.title&&(this.quizState.quizData.chapters.forEach(S=>{S.questions.forEach(k=>{k.id&&(k.notes||k.userAnswer!==void 0)&&n.chapters.forEach(x=>{const w=x.questions.find(c=>c.id===k.id);w&&(k.notes&&(console.log(`更新推送题库笔记: 题目ID=${k.id}, 笔记长度=${k.notes.length}`),w.notes=k.notes),k.userAnswer!==void 0&&(w.userAnswer=k.userAnswer))})})}),this.saveQuizToStorage(e,n)),!this.enhancedValidQuizData(n)){console.warn("题库数据格式可能有问题，尝试标准化...");try{const f=oe.parse(n,e);this.saveQuizToStorage(e,f)}catch(f){return b(`题库数据格式错误: ${f.message}`,"error"),!1}}const i=`${s.path||"quizzes"}/${e}.json`,r=`https://api.github.com/repos/${s.owner}/${s.repo}/contents/${i}`;let o=null;try{const f=await fetch(`${r}?ref=${s.branch}`,{headers:{Authorization:`token ${s.token}`,Accept:"application/vnd.github.v3+json"}});f.ok&&(o=(await f.json()).sha)}catch{}const l=JSON.stringify(n,null,2),a=btoa(unescape(encodeURIComponent(l))),p={message:o?`更新题库：${e}`:`添加题库：${e}`,content:a,branch:s.branch};o&&(p.sha=o);const d=await fetch(r,{method:"PUT",headers:{Authorization:`token ${s.token}`,"Content-Type":"application/json",Accept:"application/vnd.github.v3+json"},body:JSON.stringify(p)});if(!d.ok){const f=await d.json();throw new Error(`GitHub API错误 (${d.status}): ${f.message||"未知错误"}`)}return this.updateSyncTimestamp(),b(`成功推送题库到GitHub：${e}`,"success"),!0}catch(s){return b(`推送题库失败：${s.message}`,"error"),!1}}validateGithubConfig(e){return!!(e.owner&&e.repo&&e.token&&e.branch)}validateQuizData(e){if(!e||typeof e!="object")return!1;const t=e;if(!Array.isArray(t.chapters))return!1;for(const s of t.chapters){if(typeof s!="object"||typeof s.title!="string"||!Array.isArray(s.questions))return!1;for(const n of s.questions)if(typeof n!="object"||typeof n.title!="string"||!Array.isArray(n.options)||n.answer===void 0)return!1}return!0}async handleQuizSyncComplete(e){if(!e.success||e.action!=="pull")return null;const t=e.quiz,s=this.loadQuizFromStorage(t);if(!s)return b(`找不到拉取的题库数据: ${t}`,"error"),null;const n=this.loadQuizList(),i={id:`remote-import-${Date.now()}`,name:t,path:"localStorage",source:"remote-import",info:`从远程导入: ${t}`,title:s.title||t,lastModified:Date.now(),data:s},r=n.findIndex(a=>a.name===t&&(a.source==="local"||a.source==="remote-import"||a.source==="online-import")),o=r<0;let l=!1;return r>=0&&e.overrideLocal?(n[r]=i,l=!0):r<0&&(n.push(i),l=!0),this.saveQuizList(n),(o||l)&&e.overrideLocal&&(this.setQuizData(s),this.saveLastLoadedQuiz(t,"remote-import"),this.setQuizConfig({chapterIndex:"all",mode:"normal",rangeStart:1,rangeEnd:this.calculateTotalQuestions(s),randomize:!1,wrongOnly:!1}),this.saveQuizState()),{quizName:t,source:"remote-import",wasOverridden:l,isNewQuiz:o,data:s}}calculateTotalQuestions(e){let t=0;return e&&e.chapters&&e.chapters.forEach(s=>{s.questions&&Array.isArray(s.questions)&&(t+=s.questions.length)}),t>0?t:100}saveNoteToQuestion(e,t){if(!this.quizState.quizData||!e)return!1;const s=this.findQuestionById(e);return s?(s.notes=t,this.saveQuizToStorage(this.quizState.quizData.title,this.quizState.quizData),!0):!1}getNoteByQuestionId(e){if(!e)return"";const t=this.findQuestionById(e);return(t==null?void 0:t.notes)||""}async renderNote(e,t,s){const n=e||"";if(!n&&!t)return{contentHtml:'<p class="page-quiz__notes-placeholder">这道题目还没有笔记...</p>'};let i=n?await s.parse(n):"";return i||(i=t?'<p class="page-quiz__notes-placeholder">思考中...</p>':'<p class="page-quiz__notes-placeholder">这道题目还没有笔记...</p>'),{contentHtml:i}}findQuestionById(e){if(!(!this.quizState.quizData||!e))for(const t of this.quizState.quizData.chapters){const s=t.questions.find(n=>n.id===e);if(s)return s}}formatNote(e){return e.trim()}getNotesGenerationRequestParams(e){const t=this.getApiConfig(),s=t.model||"",n=t.temperature||.7,i=t.maxTokens||2e3,r=t.topP||1,o=t.systemPrompt||"";let l=`<question>
${e.title}

`;if(e.options&&e.options.length>0&&e.options.forEach((d,f)=>{const S=String.fromCharCode(65+f);l+=`${S}. ${d}
`}),e.answer!==void 0){let d="";Array.isArray(e.answer)?d=e.answer.map(f=>typeof f=="number"?String.fromCharCode(65+f):f).join(", "):typeof e.answer=="number"?d=String.fromCharCode(65+e.answer):d=e.answer,l+=`
正确答案: ${d}`}return e.explanation&&(l+=`
解析: ${e.explanation}`),l+=`
</question>
请严格根据提示词生成本题的笔记内容。`,{model:s,messages:[{role:"system",content:o},{role:"user",content:l}],max_tokens:i,temperature:n,top_p:r,stream:t.streamOutput??!1,user:"elyxira-quiz-user"}}parseTextQuiz(e){const t=e.split(`
`).filter(o=>o.trim()),s=t[0]||"未命名题库",n=[];let i={title:"默认章节",questions:[]},r=null;for(let o=1;o<t.length;o++){const l=t[o].trim();if(l.startsWith("## "))i.questions.length>0&&n.push(i),i={title:l.substring(3),questions:[]},r=null;else if(l.match(/^\d+\./))r&&i.questions.push(r),r={id:`q-${Date.now()}-${Math.random().toString(36).slice(2)}`,title:l.substring(l.indexOf(".")+1).trim(),options:[],answer:0,explanation:""};else if(l.startsWith("- ")&&r)r.options.push(l.substring(2).trim());else if(l.startsWith("答案:")&&r){const a=l.substring(3).trim();r.answer=parseInt(a)-1||0}else l.startsWith("解析:")&&r&&(r.explanation=l.substring(3).trim())}return r&&i.questions.push(r),i.questions.length>0&&n.push(i),{title:s,chapters:n,description:"从文本导入",lastModified:Date.now()}}enhancedValidQuizData(e){try{const t=oe.parse(e);return!t||!Array.isArray(t.chapters)||t.chapters.length===0?(console.error("验证失败: 解析后数据缺少有效章节"),!1):(t.chapters.some(n=>Array.isArray(n.questions)&&n.questions.length>0)||console.warn("解析后数据中没有题目"),!0)}catch(t){return console.error("题库数据验证失败:",t),!1}}async importConfigFromFile(e){return new Promise((t,s)=>{const n=new FileReader;n.onload=i=>{try{if(i.target&&typeof i.target.result=="string"){const r=JSON.parse(i.target.result);this.importConfig(r)?t(!0):s(new Error("Invalid config file format or content."))}else s(new Error("Failed to read file content."))}catch(r){console.error("Error parsing config file:",r),s(new Error("Failed to parse config file. Ensure it is valid JSON."))}},n.onerror=i=>{console.error("Error reading file:",i),s(new Error("Failed to read the selected file."))},n.readAsText(e)})}updateQuestion(e,t){if(!this.quizState.quizData||!e)return!1;for(const s of this.quizState.quizData.chapters){const n=s.questions.findIndex(i=>i.id===e);if(n!==-1)return s.questions[n]={...s.questions[n],...t,id:s.questions[n].id||e.toString()},this.saveQuizState(),!0}return console.warn(`未找到要更新的问题，ID: ${e}`),!1}}const C=new ts,ss={class:"modal__header"},ns={class:"modal__title"},is={class:"modal__body"},rs={key:0,class:"modal__footer"},ae=pe({__name:"modal-base",props:{show:Boolean,title:{type:String,default:"提示"},contentClass:{type:String,default:""}},emits:["close"],setup(h){return(e,t)=>h.show?(T(),Q("div",{key:0,class:"modal modal--active",onClick:t[1]||(t[1]=ut(s=>e.$emit("close"),["self"]))},[u("div",{class:be(["modal__content",h.contentClass])},[u("div",ss,[u("h2",ns,M(h.title),1),u("button",{class:"modal__close",onClick:t[0]||(t[0]=s=>e.$emit("close")),title:"关闭"},"×")]),u("div",is,[Pe(e.$slots,"default")]),e.$slots.footer?(T(),Q("div",rs,[Pe(e.$slots,"footer")])):F("",!0)],2)])):F("",!0)}}),os={class:"modal__section"},as={key:0,class:"modal__info-message"},ls={key:1,class:"modal__info-grid"},us={class:"modal__info-item"},cs={class:"modal__info-value"},ps={class:"modal__info-item"},hs={class:"modal__info-value"},gs={class:"modal__section"},fs={class:"modal__form-group"},ds={key:0,class:"modal__form-group modal__form-group--switch"},ms={class:"modal__toggle-switch"},bs={key:1,class:"modal__form-description"},Ss={class:"modal__form-group modal__form-group--switch"},ys={class:"modal__toggle-switch"},ks={class:"modal__form-actions"},ws=["disabled"],xs=["disabled"],vs={class:"modal__form-group"},zs={class:"modal__form-group"},_s={class:"modal__form-group"},$s={class:"modal__form-group"},As={class:"modal__form-group"},Cs={class:"modal__form-actions"},qs=["disabled"],Ps=["disabled"],kn=pe({__name:"modal-quiz-sync",props:{show:{type:Boolean,default:!1},currentQuiz:{type:Object,default:()=>({name:"",source:"",isLocal:!0,exists:!1})}},emits:["close","sync-complete","save"],setup(h,{emit:e}){const t=e,s=h,n={local:"本地题库",online:"在线题库",remote:"远程题库","online-import":"从在线导入","remote-import":"从远程导入"},i=O({owner:"",repo:"",branch:"main",path:"",token:"",forceSync:!0}),r=O(!1),o=O(""),l=O(""),a=O(!1),p=O(!0);function d(y){return y?`syncName_${y}`:null}const f=()=>{var g;const y=C.getGithubConfig();if(i.value={...y},p.value=!!y.forceSync,a.value=!!y.createRemoteRepo,(g=s.currentQuiz)!=null&&g.exists&&s.currentQuiz.name){const $=d(s.currentQuiz.name);$?l.value=localStorage.getItem($)||s.currentQuiz.name||y.syncQuizName||"":l.value=s.currentQuiz.name||y.syncQuizName||""}else l.value=y.syncQuizName||""};je(()=>{x(),C.addListener("github",f)}),Be(()=>{C.removeListener("github",f)}),Se(()=>s.currentQuiz,y=>{if(y!=null&&y.exists&&y.name){const g=d(y.name),$=g?localStorage.getItem(g):null;l.value=$||y.name||C.getGithubConfig().syncQuizName||""}else l.value=C.getGithubConfig().syncQuizName||""},{immediate:!0,deep:!0}),Se(()=>s.show,y=>{y&&x()},{immediate:!0});const S=Me(()=>!!i.value.owner&&!!i.value.repo);function k(y){if(!y)return"未知来源";const g=y.toLowerCase();return n[g]||y||"未知来源"}function x(){var g;const y=C.getGithubConfig();if(i.value={...y},p.value=!!y.forceSync,a.value=!!y.createRemoteRepo,(g=s.currentQuiz)!=null&&g.exists&&s.currentQuiz.name){const $=d(s.currentQuiz.name),R=$?localStorage.getItem($):null;l.value=R||s.currentQuiz.name||y.syncQuizName||""}else l.value=y.syncQuizName||""}async function w(){if(!S.value){b("请填写必要的配置信息","error");return}r.value=!0,o.value="test";try{const{owner:y,repo:g,branch:$,path:R,token:H}=i.value,Z={};H&&(Z.Authorization=`token ${H}`);const q=`https://api.github.com/repos/${y}/${g}/contents/${R}?ref=${$}`,ie=await fetch(q,{headers:Z});if(!ie.ok){const it=await ie.json();throw new Error(`GitHub API错误 (${ie.status}): ${it.message||"未知错误"}`)}const qe=await ie.json();Array.isArray(qe)?b(`成功连接到仓库，发现 ${qe.length} 个文件`,"success"):b("连接成功，但路径不是一个目录","warning")}catch(y){b(`连接失败: ${y.message}`,"error")}finally{r.value=!1,o.value=""}}function c(){m(),t("close")}function m(){var g;if(!S.value)return;if((g=s.currentQuiz)!=null&&g.exists&&s.currentQuiz.name){const $=d(s.currentQuiz.name);$&&l.value?localStorage.setItem($,l.value):$&&localStorage.removeItem($)}const y={...i.value,forceSync:p.value,syncQuizName:l.value,createRemoteRepo:a.value};C.updateGithubConfig(y),t("save",y)}async function V(){if(!S.value){b("请填写必要的配置信息","error");return}if(!l.value){b("请填写同步题库名称","error");return}r.value=!0,o.value="push";try{m(),await C.pushQuizToGithub(l.value,p.value)?(b(`成功推送题库: ${l.value}`,"success"),t("sync-complete",{action:"push",quiz:l.value,success:!0})):b("推送题库失败","error")}catch(y){b(`推送题库失败: ${y.message}`,"error")}finally{r.value=!1,o.value=""}}async function D(){if(!S.value){b("请填写必要的配置信息","error");return}if(!l.value){b("请填写同步题库名称","error");return}r.value=!0,o.value="pull";try{m();const y=await C.syncQuizFromGithub(l.value);y?(C.saveQuizToStorage(l.value,y),b(`成功拉取题库: ${l.value}`,"success"),t("sync-complete",{action:"pull",quiz:l.value,overrideLocal:!0,success:!0,retainedNotes:!0}),setTimeout(()=>{t("close")},1500)):b("拉取题库失败","error")}catch(y){b(`拉取题库失败: ${y.message}`,"error")}finally{r.value=!1,o.value=""}}return(y,g)=>(T(),ct(ae,{title:"仓库配置",show:h.show,onClose:g[9]||(g[9]=$=>y.$emit("close"))},{footer:j(()=>[u("button",{class:"modal__button modal__button--secondary",onClick:g[8]||(g[8]=$=>y.$emit("close"))},"取消"),u("button",{class:"modal__button modal__button--primary",onClick:c,disabled:!S.value},"保存配置",8,Ps)]),default:j(()=>{var $,R,H,Z;return[u("div",os,[g[12]||(g[12]=u("h3",{class:"modal__section-title"},"当前题库信息",-1)),($=h.currentQuiz)!=null&&$.exists?(T(),Q("div",ls,[u("div",us,[g[10]||(g[10]=u("span",{class:"modal__info-label"},"题库名称:",-1)),u("span",cs,M(h.currentQuiz.name||"未命名题库"),1)]),u("div",ps,[g[11]||(g[11]=u("span",{class:"modal__info-label"},"来源类型:",-1)),u("span",hs,M(k(h.currentQuiz.source)),1)])])):(T(),Q("div",as," 未处于刷题页面或未加载题库。 "))]),g[27]||(g[27]=u("div",{class:"modal__separator"},null,-1)),u("div",gs,[g[19]||(g[19]=u("h3",{class:"modal__section-title"},"题库同步",-1)),u("div",fs,[g[13]||(g[13]=u("label",{for:"syncQuizName",class:"modal__form-label"},"同步题库名称",-1)),g[14]||(g[14]=u("div",{class:"modal__form-description"},"与GitHub仓库进行同步操作时使用的文件名",-1)),A(u("input",{type:"text",id:"syncQuizName","onUpdate:modelValue":g[0]||(g[0]=q=>l.value=q),placeholder:"例如: my-quiz",class:"modal__form-control"},null,512),[[G,l.value]])]),(R=h.currentQuiz)!=null&&R.isLocal?(T(),Q("div",ds,[g[16]||(g[16]=u("label",{class:"modal__form-label"},"创建远程版本",-1)),u("label",ms,[A(u("input",{type:"checkbox","onUpdate:modelValue":g[1]||(g[1]=q=>a.value=q)},null,512),[[I,a.value]]),g[15]||(g[15]=u("span",{class:"modal__toggle-slider"},null,-1))])])):F("",!0),(H=h.currentQuiz)!=null&&H.isLocal?(T(),Q("div",bs,"推送时若远程不存在，则创建新文件")):F("",!0),u("div",Ss,[g[18]||(g[18]=u("label",{class:"modal__form-label"},"覆盖同名题库",-1)),u("label",ys,[A(u("input",{type:"checkbox","onUpdate:modelValue":g[2]||(g[2]=q=>p.value=q)},null,512),[[I,p.value]]),g[17]||(g[17]=u("span",{class:"modal__toggle-slider"},null,-1))])]),g[20]||(g[20]=u("div",{class:"modal__form-description"},"同步时覆盖已存在的题库（推送时覆盖远程，拉取时覆盖本地）",-1)),u("div",ks,[u("button",{class:"modal__button modal__button--primary",onClick:D,disabled:r.value||!l.value},[ee(Qe,{name:"download",size:"16"}),Ie(" "+M(r.value&&o.value==="pull"?"拉取中...":"从GitHub拉取"),1)],8,ws),(Z=h.currentQuiz)!=null&&Z.exists?(T(),Q("button",{key:0,class:"modal__button modal__button--success",onClick:V,disabled:r.value||!S.value||!l.value},[ee(Qe,{name:"upload",size:"16"}),Ie(" "+M(r.value&&o.value==="push"?"推送中...":"推送到GitHub"),1)],8,xs)):F("",!0)])]),g[28]||(g[28]=u("div",{class:"modal__separator"},null,-1)),g[29]||(g[29]=u("h3",{class:"modal__section-title"},"GitHub 仓库设置",-1)),u("div",vs,[g[21]||(g[21]=u("label",{for:"githubOwner",class:"modal__form-label"},"GitHub 用户名或组织",-1)),A(u("input",{type:"text",id:"githubOwner","onUpdate:modelValue":g[3]||(g[3]=q=>i.value.owner=q),placeholder:"例如: username",class:"modal__form-control"},null,512),[[G,i.value.owner]])]),u("div",zs,[g[22]||(g[22]=u("label",{for:"githubRepo",class:"modal__form-label"},"仓库名称",-1)),A(u("input",{type:"text",id:"githubRepo","onUpdate:modelValue":g[4]||(g[4]=q=>i.value.repo=q),placeholder:"例如: quiz-data",class:"modal__form-control"},null,512),[[G,i.value.repo]])]),u("div",_s,[g[23]||(g[23]=u("label",{for:"githubBranch",class:"modal__form-label"},"分支名称",-1)),A(u("input",{type:"text",id:"githubBranch","onUpdate:modelValue":g[5]||(g[5]=q=>i.value.branch=q),placeholder:"例如: main",class:"modal__form-control"},null,512),[[G,i.value.branch]])]),u("div",$s,[g[24]||(g[24]=u("label",{for:"githubPath",class:"modal__form-label"},"仓库路径 (可选)",-1)),A(u("input",{type:"text",id:"githubPath","onUpdate:modelValue":g[6]||(g[6]=q=>i.value.path=q),placeholder:"例如: quizzes/",class:"modal__form-control"},null,512),[[G,i.value.path]])]),u("div",As,[g[25]||(g[25]=u("label",{for:"githubToken",class:"modal__form-label"},"个人访问令牌 (PAT)",-1)),g[26]||(g[26]=u("div",{class:"modal__form-description"},"用于读写私有仓库或进行推送操作",-1)),A(u("input",{type:"password",id:"githubToken","onUpdate:modelValue":g[7]||(g[7]=q=>i.value.token=q),placeholder:"ghp_xxxxxx",class:"modal__form-control"},null,512),[[G,i.value.token]])]),u("div",Cs,[u("button",{class:"modal__button modal__button--primary",onClick:w,disabled:r.value},M(r.value&&o.value==="test"?"测试中...":"测试连接"),9,qs)])]}),_:1},8,["show"]))}}),Is={class:"modal__settings-tabs"},Ts={key:0,class:"modal__tab-container"},Qs={class:"modal__settings-group"},Rs={class:"modal__setting-item"},Ls={class:"modal__toggle-switch"},Es={class:"modal__setting-item"},Ds={class:"modal__toggle-switch"},Ns={class:"modal__settings-group"},Os={class:"modal__setting-item"},Ms={class:"modal__toggle-switch"},js={class:"modal__setting-item"},Bs={class:"modal__toggle-switch"},Gs={class:"modal__setting-item"},Fs={class:"modal__toggle-switch"},Us={class:"modal__setting-item"},Js={class:"modal__toggle-switch"},Vs={class:"modal__settings-group"},Hs={class:"modal__setting-item"},Zs={class:"modal__toggle-switch"},Ws={class:"modal__setting-item"},Ks={class:"modal__toggle-switch"},Xs={class:"modal__settings-group"},Ys={class:"modal__setting-item"},en={class:"modal__toggle-switch"},tn={class:"modal__setting-item"},sn={class:"modal__toggle-switch"},nn={key:1,class:"modal__tab-container"},rn={class:"modal__settings-group"},on={class:"modal__setting-item"},an={class:"modal__form-input-group"},ln={class:"modal__setting-item"},un=["value"],cn={class:"modal__setting-item"},pn={class:"modal__toggle-switch"},hn={class:"modal__settings-group"},gn={class:"modal__setting-item"},fn={class:"modal__toggle-switch"},dn={class:"modal__body"},mn={class:"modal__body"},wn=pe({__name:"modal-settings",props:{show:{type:Boolean},currentSettings:{}},emits:["close","save"],setup(h,{emit:e}){const t=[{name:"系统默认 (sans-serif)",value:"sans-serif"},{name:"系统默认 (serif)",value:"serif"},{name:"系统默认 (monospace)",value:"monospace"},{name:"苹方 (PingFang SC)",value:"'PingFang SC', sans-serif"},{name:"微软雅黑 (Microsoft YaHei)",value:"'Microsoft YaHei', sans-serif"},{name:"思源黑体 (Noto Sans SC)",value:"'Noto Sans SC', sans-serif"},{name:"霞鹜文楷 (LXGW WenKai)",value:"'LXGW WenKai', cursive"},{name:"JetBrains Mono",value:"'JetBrains Mono', monospace"},{name:"Fira Code",value:"'Fira Code', monospace"},{name:"IBM Plex Sans",value:"'IBM Plex Sans', sans-serif"},{name:"Roboto Mono",value:"'Roboto Mono', monospace"},{name:"更纱黑体 (Sarasa Gothic)",value:"'Sarasa Gothic SC', sans-serif"}],s=h,n=e,i=O("quiz"),r=O(!1),o=O(!1),l=O(""),a=me({uiSettings:{...C.getUiSettings()},quizSettings:{...C.getQuizSettings()},debugEnabled:C.isDebugEnabled()}),p=()=>{Object.assign(a.uiSettings,C.getUiSettings()),Object.assign(a.quizSettings,C.getQuizSettings()),a.debugEnabled=C.isDebugEnabled()};je(()=>{C.addListener("settings",p)}),Be(()=>{C.removeListener("settings",p)}),Se(()=>s.show,w=>{if(w){const c=C.getSettings();Object.assign(a.uiSettings,c.uiSettings),Object.assign(a.quizSettings,c.quizSettings),a.debugEnabled=c.debugEnabled}},{immediate:!1});function d(){try{C.saveGeneralSettings({uiSettings:a.uiSettings,quizSettings:a.quizSettings,debugEnabled:a.debugEnabled}),n("save"),n("close")}catch(w){console.error("保存设置失败:",w),b("保存设置失败，请重试","error")}}function f(){r.value=!0}function S(w){const c=w.target;!c.files||c.files.length}function k(){const w=document.getElementById("importFileInput");if(!w.files||w.files.length===0){b("请选择要导入的配置文件","warning");return}const c=w.files[0];C.importConfigFromFile(c).then(m=>{m&&(r.value=!1,setTimeout(()=>{window.location.reload()},1500))}).catch(m=>{b("导入配置失败："+m.message,"error")})}function x(){try{C.exportConfig(),o.value=!0,l.value=new Date().toISOString()}catch(w){console.error("导出配置失败:",w)}}return(w,c)=>(T(),Q(Te,null,[ee(ae,{show:w.show,title:"设置","content-class":"modal__content--settings",onClose:c[17]||(c[17]=m=>w.$emit("close"))},{footer:j(()=>[u("button",{onClick:c[16]||(c[16]=m=>w.$emit("close")),class:"modal__button modal__button--secondary"},"取消"),u("button",{onClick:d,class:"modal__button modal__button--primary"},"保存设置")]),default:j(()=>[u("div",Is,[u("button",{class:be(["modal__settings-tab",{"modal__settings-tab--active":i.value==="quiz"}]),onClick:c[0]||(c[0]=m=>i.value="quiz")},"刷题设置",2),u("button",{class:be(["modal__settings-tab",{"modal__settings-tab--active":i.value==="general"}]),onClick:c[1]||(c[1]=m=>i.value="general")},"通用设置",2)]),i.value==="quiz"?(T(),Q("div",Ts,[u("div",Qs,[c[26]||(c[26]=u("h3",{class:"modal__settings-group-title"},"模式",-1)),u("div",Rs,[c[23]||(c[23]=u("span",{class:"modal__setting-item-name"},"随机刷题",-1)),u("label",Ls,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[2]||(c[2]=m=>a.quizSettings.randomMode=m)},null,512),[[I,a.quizSettings.randomMode]]),c[22]||(c[22]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",Es,[c[25]||(c[25]=u("span",{class:"modal__setting-item-name"},"背题模式",-1)),u("label",Ds,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[3]||(c[3]=m=>a.quizSettings.reviewMode=m)},null,512),[[I,a.quizSettings.reviewMode]]),c[24]||(c[24]=u("span",{class:"modal__toggle-slider"},null,-1))])])]),u("div",Ns,[c[35]||(c[35]=u("h3",{class:"modal__settings-group-title"},"交互",-1)),u("div",Os,[c[28]||(c[28]=u("span",{class:"modal__setting-item-name"},"选择后自动提交",-1)),u("label",Ms,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[4]||(c[4]=m=>a.quizSettings.autoSubmit=m)},null,512),[[I,a.quizSettings.autoSubmit]]),c[27]||(c[27]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",js,[c[30]||(c[30]=u("span",{class:"modal__setting-item-name"},"提交后自动下一题",-1)),u("label",Bs,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[5]||(c[5]=m=>a.quizSettings.autoNext=m)},null,512),[[I,a.quizSettings.autoNext]]),c[29]||(c[29]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",Gs,[c[32]||(c[32]=u("span",{class:"modal__setting-item-name"},"允许跳过未答题目",-1)),u("label",Fs,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[6]||(c[6]=m=>a.quizSettings.allowSkip=m)},null,512),[[I,a.quizSettings.allowSkip]]),c[31]||(c[31]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",Us,[c[34]||(c[34]=u("span",{class:"modal__setting-item-name"},"滑动手势切换",-1)),u("label",Js,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[7]||(c[7]=m=>a.quizSettings.swipeGestureEnabled=m)},null,512),[[I,a.quizSettings.swipeGestureEnabled]]),c[33]||(c[33]=u("span",{class:"modal__toggle-slider"},null,-1))])])]),u("div",Vs,[c[40]||(c[40]=u("h3",{class:"modal__settings-group-title"},"显示",-1)),u("div",Hs,[c[37]||(c[37]=u("span",{class:"modal__setting-item-name"},"回答后显示笔记",-1)),u("label",Zs,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[8]||(c[8]=m=>a.quizSettings.showNotesAfterAnswer=m)},null,512),[[I,a.quizSettings.showNotesAfterAnswer]]),c[36]||(c[36]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",Ws,[c[39]||(c[39]=u("span",{class:"modal__setting-item-name"},"显示进度条/正确率",-1)),u("label",Ks,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[9]||(c[9]=m=>a.quizSettings.showProgress=m)},null,512),[[I,a.quizSettings.showProgress]]),c[38]||(c[38]=u("span",{class:"modal__toggle-slider"},null,-1))])])]),u("div",Xs,[c[45]||(c[45]=u("h3",{class:"modal__settings-group-title"},"答案行为",-1)),u("div",Ys,[c[42]||(c[42]=u("span",{class:"modal__setting-item-name"},"提交后不允许更改",-1)),u("label",en,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[10]||(c[10]=m=>a.quizSettings.lockAnswerAfterSubmit=m)},null,512),[[I,a.quizSettings.lockAnswerAfterSubmit]]),c[41]||(c[41]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",tn,[c[44]||(c[44]=u("span",{class:"modal__setting-item-name"},"提交后立即显示正确答案",-1)),u("label",sn,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[11]||(c[11]=m=>a.quizSettings.showCorrectAnswerImmediately=m)},null,512),[[I,a.quizSettings.showCorrectAnswerImmediately]]),c[43]||(c[43]=u("span",{class:"modal__toggle-slider"},null,-1))])])])])):F("",!0),i.value==="general"?(T(),Q("div",nn,[u("div",rn,[c[50]||(c[50]=u("h3",{class:"modal__settings-group-title"},"显示",-1)),u("div",on,[c[46]||(c[46]=u("span",{class:"modal__setting-item-name"},"字体大小",-1)),u("div",an,[A(u("input",{type:"range","onUpdate:modelValue":c[12]||(c[12]=m=>a.uiSettings.fontSize=m),min:"12",max:"20",step:"1"},null,512),[[G,a.uiSettings.fontSize,void 0,{number:!0}]]),u("span",null,M(a.uiSettings.fontSize)+"px",1)])]),u("div",ln,[c[47]||(c[47]=u("span",{class:"modal__setting-item-name"},"字体选择",-1)),A(u("select",{"onUpdate:modelValue":c[13]||(c[13]=m=>a.uiSettings.fontFamily=m),class:"modal__select-styled"},[(T(),Q(Te,null,pt(t,m=>u("option",{key:m.value,value:m.value},M(m.name),9,un)),64))],512),[[ht,a.uiSettings.fontFamily]])]),u("div",cn,[c[49]||(c[49]=u("span",{class:"modal__setting-item-name"},"启用动画效果",-1)),u("label",pn,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[14]||(c[14]=m=>a.uiSettings.animationEnabled=m)},null,512),[[I,a.uiSettings.animationEnabled]]),c[48]||(c[48]=u("span",{class:"modal__toggle-slider"},null,-1))])])]),u("div",{class:"modal__settings-group"},[c[53]||(c[53]=u("h3",{class:"modal__settings-group-title"},"数据管理",-1)),u("div",{class:"modal__setting-item"},[c[51]||(c[51]=u("span",{class:"modal__setting-item-name"},"导出配置",-1)),u("button",{class:"modal__button modal__button--secondary",onClick:x}," 导出为JSON ")]),u("div",{class:"modal__setting-item"},[c[52]||(c[52]=u("span",{class:"modal__setting-item-name"},"导入配置",-1)),u("button",{class:"modal__button modal__button--secondary",onClick:f}," 选择文件导入 ")])]),u("div",hn,[c[56]||(c[56]=u("h3",{class:"modal__settings-group-title"},"调试",-1)),u("div",gn,[c[55]||(c[55]=u("span",{class:"modal__setting-item-name"},"调试模式",-1)),u("label",fn,[A(u("input",{type:"checkbox","onUpdate:modelValue":c[15]||(c[15]=m=>a.debugEnabled=m)},null,512),[[I,a.debugEnabled]]),c[54]||(c[54]=u("span",{class:"modal__toggle-slider"},null,-1))])])])])):F("",!0)]),_:1},8,["show"]),ee(ae,{show:r.value,title:"导入配置",onClose:c[19]||(c[19]=m=>r.value=!1)},{footer:j(()=>[u("button",{onClick:c[18]||(c[18]=m=>r.value=!1),class:"modal__button modal__button--secondary"},"取消"),u("button",{onClick:k,class:"modal__button modal__button--primary"},"导入")]),default:j(()=>[u("div",dn,[c[57]||(c[57]=u("p",null,"选择要导入的配置文件：",-1)),u("input",{type:"file",id:"importFileInput",accept:".json",onChange:S},null,32)])]),_:1},8,["show"]),ee(ae,{show:o.value,title:"导出成功",onClose:c[21]||(c[21]=m=>o.value=!1)},{footer:j(()=>[u("button",{onClick:c[20]||(c[20]=m=>o.value=!1),class:"modal__button modal__button--primary"},"关闭")]),default:j(()=>[u("div",mn,[c[58]||(c[58]=u("p",null,"配置文件已成功导出为JSON文件。",-1)),u("p",null,"导出时间："+M(l.value),1)])]),_:1},8,["show"])],64))}});export{et as Q,Qe as _,ae as a,Yt as b,C as c,es as d,kn as e,wn as f,_ as m,yn as p};
