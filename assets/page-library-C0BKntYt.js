import{d as $e,g as Y,c as y,b as m,n as Q,i as $,r as c,p as St,o as Oe,l as he,w as we,e as t,t as k,F as ye,k as Se,f as O,m as D,q as X,v as ce,s as d,x as Tt,u as xt,y as It,j as S,z as Nt,A as te,B as Rt,C as Dt,D as Ke}from"./index-BjWPT2mU.js";import{_ as M,c as s,a as Ye,p as Xe,Q as G,b as u,d as R,e as At,f as jt}from"./modal-settings.vue_vue_type_script_setup_true_lang-me0jwOHE.js";import{_ as Ut}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ft=$e({__name:"button-settings",props:{class:{}},emits:["open-general-settings"],setup(Z,{emit:H}){const b=Z,A=Y(()=>b.class||""),z=H;function p(){z("open-general-settings")}return(E,h)=>(m(),y("button",{class:Q(["settings-button",A.value]),title:"通用设置",onClick:p},[$(M,{name:"settings",size:"16"})],2))}}),Bt=Ut(Ft,[["__scopeId","data-v-13b5feaf"]]),Pt={class:"modal__debug-info"},Gt={class:"modal__debug-item"},Ht={class:"modal__debug-value"},Vt={class:"modal__debug-item"},Wt={class:"modal__debug-value"},Jt={key:0,class:"modal__debug-empty"},Kt={class:"modal__debug-label"},Yt={class:"modal__debug-value"},Xt=$e({__name:"modal-debug",props:{show:{type:Boolean,default:!1}},emits:["close"],setup(Z){const H=Z,b=c(""),A=c(0),z=c([]);St(()=>H.show,C=>{C&&p()},{immediate:!0}),Oe(()=>{b.value=navigator.userAgent,p()});function p(){const{totalSize:C,items:_}=s.getCacheStats();A.value=C,z.value=_}function E(C){if(C===0)return"0 B";const _=1024,L=["B","KB","MB","GB"],f=Math.floor(Math.log(C)/Math.log(_));return parseFloat((C/Math.pow(_,f)).toFixed(2))+" "+L[f]}function h(){confirm("确定要清除所有题库缓存吗？这将删除所有本地保存的题库数据。")&&s.clearQuizCache()&&p()}return(C,_)=>(m(),he(Ye,{title:"调试",show:Z.show,onClose:_[1]||(_[1]=L=>C.$emit("close"))},{footer:we(()=>[t("button",{class:"modal__button modal__button--danger",onClick:h},"清除缓存"),t("button",{class:"modal__button modal__button--secondary",onClick:_[0]||(_[0]=L=>C.$emit("close"))},"关闭")]),default:we(()=>[t("div",Pt,[_[5]||(_[5]=t("h3",null,"系统信息",-1)),t("div",Gt,[_[2]||(_[2]=t("span",{class:"modal__debug-label"},"浏览器",-1)),t("span",Ht,k(b.value),1)]),t("div",Vt,[_[3]||(_[3]=t("span",{class:"modal__debug-label"},"本地存储使用",-1)),t("span",Wt,k(E(A.value)),1)]),_[6]||(_[6]=t("h3",null,"题库缓存",-1)),z.value.length===0?(m(),y("div",Jt,_[4]||(_[4]=[t("span",null,"暂无缓存数据",-1)]))):(m(!0),y(ye,{key:1},Se(z.value,(L,f)=>(m(),y("div",{class:"modal__debug-item",key:f},[t("span",Kt,k(L.key),1),t("span",Yt,k(E(L.size)),1)]))),128))])]),_:1},8,["show"]))}}),Zt={class:"modal__tabs"},qt={class:"modal__tab-headers"},ea={class:"modal__tab-content"},ta={key:0,class:"modal__tab-panel modal__tab-panel--active"},aa={class:"modal__import-options"},la={class:"modal__import-option"},oa={class:"modal__file-input-wrapper"},sa={for:"quizFileInput",class:"modal__file-input-label"},na={class:"modal__import-option"},ra={class:"modal__url-import"},ia=["disabled"],ua={key:1,class:"modal__tab-panel modal__tab-panel--active"},da={class:"modal__export-options"},ca={key:0,class:"modal__export-option"},va={key:1,class:"modal__export-option"},pa={class:"modal__export-option"},ma=$e({__name:"modal-library-data",props:{quizData:{},show:{type:Boolean}},emits:["close","import-complete"],setup(Z,{emit:H}){const b=Z,A=H,z=c("import"),p=c(""),E=c(!1);function h(w){var x;const o=w.target,g=(x=o==null?void 0:o.files)==null?void 0:x[0];g&&_(g,o)}function C(){!p.value||E.value||(E.value=!0,d("正在从URL加载题库...","info"),fetch(p.value).then(w=>{if(!w.ok)throw new Error(`HTTP错误：${w.status}`);return w.text()}).then(w=>{L(w,p.value)}).catch(w=>{d(`URL导入失败: ${w.message}`,"error")}).finally(()=>{E.value=!1}))}function _(w,o){E.value=!0,d("正在解析题库文件...","info");const g=new FileReader;g.onload=x=>{var W;try{const q=(W=x.target)==null?void 0:W.result;L(q,w.name)}catch(q){d(`解析题库文件失败: ${q.message}`,"error")}finally{E.value=!1,o&&(o.value="")}},g.onerror=()=>{d("读取文件失败","error"),E.value=!1},g.readAsText(w)}function L(w,o){try{const g=Xe(w,o);if(s.enhancedValidQuizData(g))d(`成功解析题库：${o}`,"success"),A("import-complete",g);else throw new Error("题库格式无效")}catch(g){d(`解析题库失败: ${g.message}`,"error")}finally{E.value=!1}}function f(){if(!b.quizData){d("没有可导出的题库","error");return}const w=JSON.stringify(b.quizData,null,2),o=`data:application/json;charset=utf-8,${encodeURIComponent(w)}`,g=`${b.quizData.title||"quiz"}_${new Date().toISOString().split("T")[0]}.json`;ie(o,g),d("题库导出成功","success")}function V(){d("多题库导出功能尚未实现","warning")}function ie(w,o){const g=document.createElement("a");g.setAttribute("href",w),g.setAttribute("download",o),g.click()}return(w,o)=>(m(),he(Ye,{title:"题库数据管理",show:w.show,onClose:o[4]||(o[4]=g=>w.$emit("close"))},{footer:we(()=>[t("button",{class:"modal__button modal__button--secondary",onClick:o[3]||(o[3]=g=>w.$emit("close"))},"关闭")]),default:we(()=>[t("div",Zt,[t("div",qt,[t("button",{class:Q(["modal__tab-header",{"modal__tab-header--active":z.value==="import"}]),onClick:o[0]||(o[0]=g=>z.value="import")}," 导入题库 ",2),t("button",{class:Q(["modal__tab-header",{"modal__tab-header--active":z.value==="export"}]),onClick:o[1]||(o[1]=g=>z.value="export")}," 导出题库 ",2)]),t("div",ea,[z.value==="import"?(m(),y("div",ta,[t("div",aa,[t("div",la,[o[6]||(o[6]=t("h3",null,"本地文件导入",-1)),o[7]||(o[7]=t("p",null,"支持 JSON 和 TXT 格式的题库文件",-1)),t("div",oa,[t("input",{type:"file",id:"quizFileInput",accept:".json,.txt",onChange:h},null,32),t("label",sa,[$(M,{name:"upload",size:"16"}),o[5]||(o[5]=D(" 选择文件 "))])])]),t("div",na,[o[8]||(o[8]=t("h3",null,"URL导入",-1)),o[9]||(o[9]=t("p",null,"输入题库文件的URL地址",-1)),t("div",ra,[X(t("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=g=>p.value=g),placeholder:"https://example.com/quiz.json"},null,512),[[ce,p.value]]),t("button",{onClick:C,disabled:!p.value||E.value},"导入",8,ia)])])])])):O("",!0),z.value==="export"?(m(),y("div",ua,[t("div",da,[w.quizData?(m(),y("div",ca,[o[11]||(o[11]=t("h3",null,"导出当前题库",-1)),o[12]||(o[12]=t("p",null,"将当前加载的题库导出为JSON文件",-1)),t("button",{onClick:f,class:"modal__export-button"},[$(M,{name:"download",size:"16"}),o[10]||(o[10]=D(" 导出题库 "))])])):(m(),y("div",va,o[13]||(o[13]=[t("h3",null,"未加载题库",-1),t("p",null,"请先加载一个题库才能导出",-1)]))),t("div",pa,[o[15]||(o[15]=t("h3",null,"导出所有本地题库",-1)),o[16]||(o[16]=t("p",null,"将所有本地缓存的题库导出为ZIP文件",-1)),t("button",{onClick:V,class:"modal__export-button"},[$(M,{name:"download",size:"16"}),o[14]||(o[14]=D(" 导出所有题库 "))])])])])):O("",!0)])])]),_:1},8,["show"]))}}),fa={class:"page-library"},_a={class:"page-library__content"},ga={class:"page-library__header"},ba={class:"page-library__actions"},ya={class:"page-library__card"},ha={class:"page-library__card-header"},wa={class:"page-library__card-menu"},$a={class:"page-library__filters"},Ca={class:"page-library__filter-group"},ka={class:"page-library__search"},Ea={class:"page-library__table-container"},za={class:"page-library__table"},Ma={key:0,class:"page-library__loading-overlay"},Qa={colspan:"5"},La={class:"page-library__loading-content"},Oa={class:"page-library__loading-spinner"},Sa={class:"page-library__table-title"},Ta={class:"page-library__table-desc"},xa={class:"page-library__table-actions"},Ia=["onClick"],Na=["onClick"],Ra={key:0},Da={colspan:"5"},Aa={class:"page-library__empty"},ja={class:"page-library__modal"},Ua={class:"page-library__modal-header"},Fa={class:"page-library__modal-body"},Ba={class:"form-group"},Pa={class:"page-library__modal-footer"},Ga={class:"page-library__card"},Ha={class:"page-library__card-body"},Va={key:0,class:"page-library__quiz-info"},Wa={class:"page-library__quiz-info-header"},Ja={class:"page-library__quiz-title"},Ka={class:"page-library__quiz-desc"},Ya={key:1,class:"page-library__empty"},Xa={class:"page-library__settings-row"},Za={class:"page-library__filter-group"},qa=["disabled"],el=["value"],tl=["disabled"],al=["disabled"],ll={class:"page-library__card-body page-library__stats-container"},ol={key:0,class:"page-library__stats-loading"},sl={class:"page-library__loading-spinner"},nl={class:"page-library__stat-card"},rl={class:"page-library__stat-info"},il={class:"page-library__stat-value"},ul={class:"page-library__stat-card"},dl={class:"page-library__stat-info"},cl={class:"page-library__stat-value"},vl={class:"page-library__stat-card"},pl={class:"page-library__stat-info"},ml={class:"page-library__stat-value"},fl={class:"page-library__stat-card"},_l={class:"page-library__stat-info"},gl={class:"page-library__stat-value"},bl={class:"page-library__stat-card"},yl={class:"page-library__stat-info"},hl={class:"page-library__stat-value"},wl={class:"page-library__modal"},$l={class:"page-library__modal-header"},Cl={class:"page-library__modal-body"},kl={class:"mode-options"},El={class:"page-library__modal-footer"},zl={key:0,class:"page-library__modal"},Ml={class:"page-library__modal-header"},Ql={class:"page-library__modal-body"},Ll={class:"error-details"},Ol={class:"page-library__modal-footer"},Sl={class:"page-library__modal"},Tl={class:"page-library__modal-header"},xl={class:"page-library__modal-body"},Il={class:"delete-confirm-message"},Nl={key:0,class:"delete-confirm-warning"},Rl={class:"page-library__modal-footer"},Dl=["disabled"],Al={key:0},jl={key:1},Ul={class:"page-library__modal"},Fl={class:"page-library__modal-header"},Bl={class:"page-library__modal-title"},Pl={class:"page-library__modal-body"},Gl={class:"delete-confirm-message"},Hl={class:"page-library__modal-footer"},Kl=$e({__name:"page-library",setup(Z){Oe(()=>{if(!document.getElementById("material-icons-css")){const a=document.createElement("link");a.id="material-icons-css",a.rel="stylesheet",a.href="https://fonts.googleapis.com/icon?family=Material+Icons",document.head.appendChild(a)}Tt()});const H=xt(),b=c([]),A=c([]),z=c([]),p=c(null),E=c("all"),h=c(G.NORMAL),C=c(1),_=c(50),L=c(!1),f=c({name:"",source:""}),V=c(!1),ie=c(0),w=c(0),o=c(null),g=c(null),x=c(null),W=c(!1),q=c(!1),ue=c(!1),de=c(!1),ve=c(!1),ae=c(!1),le=c(!1),oe=c(!1),J=c(!1),T=c(""),v=c(null),se=c(s.getUiSettings().darkMode),Te=c(""),xe=c(""),pe=c(!1),j=c({title:"",message:"",confirmText:"确定",cancelText:"取消",onConfirm:()=>{J.value=!1},onCancel:()=>{J.value=!1}}),Ze=Y(()=>{var a,e;return(e=(a=o.value)==null?void 0:a.data)!=null&&e.chapters?o.value.data.chapters.reduce((l,n)=>{var r;return l+(((r=n.questions)==null?void 0:r.length)||0)},0):0}),Ie=Y(()=>{var a,e;return(e=(a=o.value)==null?void 0:a.data)!=null&&e.chapters?o.value.data.chapters.map(l=>l.title):p.value&&p.value.chapters?p.value.chapters.map(l=>l.title):[]}),me=c(0),fe=c(0),qe=c({totalAnswered:0,correctCount:0,wrongCount:0,dailyActivity:[]}),et=Y(()=>{const a=me.value;return a===0?"0%":Math.round(fe.value/a*100)+"%"}),tt=Y(()=>{const a=s.getGithubConfig();return!!(a!=null&&a.repo&&(a!=null&&a.token))});Oe(async()=>{L.value=!0,I.value=!0;const a=s.getUiSettings();if(se.value=a.darkMode,se.value){const e=document.querySelector(".page-library__theme-toggle");e&&e.classList.add("dark")}try{await U(),$t(),at()}catch{d("初始化题库页面失败，请刷新页面重试","error")}finally{I.value=!1,L.value=!1}});function at(){const a=s.getLastLoadedQuiz(),e=s.getQuizData();if(e&&a)try{p.value=e,f.value=a;const l=s.getQuizConfig();E.value=l.chapterIndex,h.value=l.mode,C.value=l.rangeStart,_.value=l.rangeEnd||Ee();const n=je().find(r=>r.name===a.name&&r.source===a.source);n&&p.value?(o.value={...n,data:p.value},x.value=o.value):n&&(o.value=n,x.value=n),d("已恢复上次的题库数据","success")}catch(l){console.error("解析保存的题库数据失败:",l),s.clearCurrentQuiz()}}const I=c(!1);async function U(){I.value=!0;try{await lt(),ot().catch(a=>{console.warn("加载在线题库列表失败:",a),d("部分在线题库加载失败，请检查网络连接","warning")}),tt.value&&st().catch(a=>{console.warn("加载远程GitHub题库列表失败:",a),d("GitHub仓库同步失败，但不影响其他功能","warning")}),d("题库列表刷新成功","success")}catch(a){console.error("加载题库列表失败:",a),d("加载题库列表失败，请检查网络连接","error")}finally{I.value=!1}}async function lt(){try{b.value=s.loadQuizList()}catch{d("加载缓存题库列表失败","warning"),b.value=[]}}async function ot(){try{const e=await fetch("/data/index.json",{headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`无法加载题库索引文件 (${e.status}): 请确认public/data/index.json文件存在且格式正确`);let l;try{l=await e.json()}catch{throw new Error("题库索引格式错误: 请确认index.json是有效的JSON文件")}if(Array.isArray(l))A.value=l.map(n=>{let r=n.download_url,i=n.path||`${n.name}.json`;return r||(!i.startsWith("/")&&!i.startsWith("http")&&(i=`/data/${i}`),r=i),{...n,path:i,source:u.ONLINE,download_url:r}});else throw new Error("题库索引格式无效: 应为题库数组")}catch(a){d(`加载在线题库列表失败: ${a.message}`,"error"),A.value=[]}}async function st(){try{const a=s.getGithubConfig();if(!(a!=null&&a.repo)||!(a!=null&&a.token)){d("GitHub 配置不完整","error");return}const e=a.path||"quizzes",l=`https://api.github.com/repos/${a.owner}/${a.repo}/contents/${e}`,n=await fetch(`${l}?ref=${a.branch}`,{headers:{Authorization:`token ${a.token}`,Accept:"application/vnd.github.v3+json"}});if(!n.ok)throw new Error(`获取远程题库列表失败 (${n.status}): ${await n.text()}`);const r=await n.json();if(!Array.isArray(r))throw new Error("获取的远程题库列表格式无效");z.value=r.filter(i=>i.type==="file"&&(i.name.endsWith(".json")||i.name.endsWith(".txt"))).map(i=>({id:`remote-${i.path}`,source:u.REMOTE,name:i.name.replace(/\.(json|txt)$/,""),info:`GitHub: ${a.repo}/${e}`,path:i.path,title:i.name.replace(/\.(json|txt)$/,""),lastModified:Date.now(),download_url:i.download_url})),z.value.length>0?d(`已加载 ${z.value.length} 个远程题库`,"success"):d(`远程仓库 ${e} 中未找到题库文件`,"warning")}catch(a){console.error("加载远程题库失败:",a),d(`加载远程题库失败: ${a.message}`,"error"),z.value=[]}}function Ne(){p.value&&(s.setQuizData(p.value),s.saveLastLoadedQuiz(f.value.name,f.value.source),s.setQuizConfig({chapterIndex:E.value,mode:h.value,rangeStart:parseInt(C.value.toString()),rangeEnd:parseInt(_.value.toString()),randomize:h.value==="random",wrongOnly:h.value==="wrong"}),s.saveQuizState())}const Re=async()=>{if(!p.value){d("请先选择一个题库","error");return}s.setQuizConfig({chapterIndex:E.value,mode:h.value==="wrong"?G.REVIEW:h.value,rangeStart:parseInt(C.value.toString()),rangeEnd:parseInt(_.value.toString()),randomize:h.value==="random",wrongOnly:h.value==="wrong"}),s.saveQuizState(),H.push("/quiz")};function nt(a,e,l){if(e!==u.ONLINE){if(a.preventDefault(),a.stopPropagation(),document.removeEventListener("click",F),document.removeEventListener("contextmenu",F),V.value&&v.value&&v.value.quiz&&l.name===v.value.quiz.name&&l.source===v.value.quiz.source){F();return}V.value?(F(),setTimeout(()=>De(a,e,l),300)):De(a,e,l)}}function De(a,e,l){v.value={source:e,quiz:l},W.value=!1;const n=a.currentTarget;if(n){const r=n.getBoundingClientRect();w.value=r.right-150,ie.value=r.bottom+window.pageYOffset+5;const i=window.innerWidth,K=window.innerHeight,B=150,N=150;w.value+B>i&&(w.value=i-B-10),r.bottom+N>K&&(ie.value=r.top+window.pageYOffset-N-5)}V.value=!0,setTimeout(()=>{document.addEventListener("click",F),document.addEventListener("contextmenu",F)},0)}function F(){!V.value||W.value||(W.value=!0,setTimeout(()=>{V.value=!1,W.value=!1},200))}function rt(){v.value&&(T.value=v.value.quiz.name||"",ae.value=!0,F())}function it(){v.value&&(Te.value=v.value.quiz.name||"",xe.value=v.value.source,oe.value=!0,F())}async function ut(){if(console.log("Attempting to confirm delete..."),!v.value){console.log("Confirm delete aborted: No quiz selected.");return}pe.value=!0,console.log(`Deleting quiz: ${v.value.quiz.name} (Source: ${v.value.source})`);try{v.value.source==="local"||v.value.source===u.ONLINE_IMPORT||v.value.source===u.REMOTE_IMPORT?dt():v.value.source==="remote"&&await ct(),oe.value=!1,console.log("Delete confirmation modal closed.")}catch(a){console.error("删除题库失败:",a),Ve.value=`删除题库失败: ${a.message}`,ge.value=!0}finally{pe.value=!1,console.log("Delete operation finished.")}}function dt(){if(!v.value)return;const e=v.value.quiz.name,l=v.value.source;console.log(`尝试删除本地题库: ${e} (来源: ${l})`);const n=b.value.findIndex(r=>r.name===e&&r.source===l);console.log(`找到要删除的索引: ${n}`),n>-1?(b.value.splice(n,1),console.log("已从题库列表中移除"),s.saveQuizList(b.value),s.removeQuizFromStorage(e),console.log(`已保存题库列表并移除缓存: ${e}`),f.value&&f.value.source===l&&f.value.name===e&&(s.clearCurrentQuiz(),p.value=null,f.value={name:"",source:""},o.value=null,x.value=null,console.log("已清空当前题库数据，因为它是正在被删除的题库")),d("题库删除成功","success"),v.value=null,U(),console.log("已手动刷新题库列表以确保UI更新")):(console.warn(`尝试删除本地题库失败：在列表中未找到 ${e} (来源: ${l})`),s.removeQuizFromStorage(e),console.log(`尝试从存储中移除: ${e}`),d("删除失败：无法在列表中找到题库","error"))}async function ct(){if(!v.value)return;const a=s.getGithubConfig(),e=a.owner,l=a.repo,n=a.branch||"main",r=a.token;if(!e||!l||!r)throw new Error("GitHub配置不完整，无法删除远程文件");const i=v.value.quiz,K=i.path;if(!K)throw new Error("无效的文件路径");const B=`https://api.github.com/repos/${e}/${l}/contents/${K}?ref=${n}`,N={Authorization:`token ${r}`,Accept:"application/vnd.github.v3+json"},P=await fetch(B,{headers:N});if(!P.ok){const re=await P.json();throw new Error(`获取文件信息失败 (${P.status}): ${re.message||"未知错误"}`)}const be=(await P.json()).sha,Lt=`https://api.github.com/repos/${e}/${l}/contents/${K}`,Le=await fetch(Lt,{method:"DELETE",headers:N,body:JSON.stringify({message:`删除题库: ${i.name}`,sha:be,branch:n})});if(!Le.ok){let re=`删除失败 (${Le.status})`;try{const Ot=await Le.json();re+=`: ${Ot.message||"未知错误"}`}catch{}throw new Error(re)}const Je=z.value.findIndex(re=>re.path===i.path);Je>-1&&(z.value.splice(Je,1),f.value&&f.value.source==="remote"&&f.value.name===i.name&&(s.clearCurrentQuiz(),p.value=null,f.value={name:"",source:""}),d("题库已成功从GitHub仓库删除","success"))}function vt(a){U()}function pt(a){var r;const e=a.target,l=(r=e==null?void 0:e.files)==null?void 0:r[0];if(!l)return;L.value=!0,d("正在解析题库文件...","info");const n=new FileReader;n.onload=function(i){var K;try{const B=(K=i.target)==null?void 0:K.result,N=Xe(B,l.name);if(s.enhancedValidQuizData(N)){p.value=N,s.setQuizData(N),f.value={source:"file",name:l.name.replace(/\.(json|txt)$/,"")},s.saveLastLoadedQuiz(l.name.replace(/\.(json|txt)$/,""),"file"),E.value="all",h.value=G.NORMAL,C.value=1,_.value=Ee(),Ne();const P={id:`file-${l.name}`,name:l.name.replace(/\.(json|txt)$/,""),path:"localStorage",source:u.LOCAL,lastModified:Date.now(),data:N,info:"从文件导入"},Qe=b.value.findIndex(be=>be.name===P.name&&be.source===u.LOCAL);Qe>=0?b.value[Qe]=P:b.value.push(P),s.saveQuizList(b.value),s.saveQuizToStorage(P.name,N),d(`成功加载题库：${l.name}`,"success")}else throw new Error("题库格式无效")}catch(B){console.error("解析题库文件失败:",B),d(`解析题库文件失败: ${B.message}`,"error")}finally{L.value=!1,e&&(e.value="")}},n.onerror=function(){d("读取文件失败","error"),L.value=!1},n.readAsText(l)}const Ce=It(s.getSettings()),mt=()=>{Object.assign(Ce,s.getSettings()),se.value=Ce.uiSettings.darkMode},ft=()=>{H.push("/")},_t=Y(()=>p.value!==null),ee=c(R.CACHE),_e=c(""),Ae=Y(()=>{var l;const a=je();let e=a;if(ee.value&&(e=a.filter(n=>Et(n.source)===ee.value)),(l=_e.value)!=null&&l.trim()){const n=_e.value.toLowerCase();e=e.filter(r=>r.name.toLowerCase().includes(n)||r.info&&r.info.toLowerCase().includes(n))}return e});function je(){return[...b.value.map(a=>({id:`${a.source||"local"}-${a.name}`,source:a.source,name:a.name,info:a.info||ne(a.source),path:a.path,title:a.title||a.name,lastModified:a.lastModified,download_url:void 0})),...A.value.map(a=>({id:`online-${a.path}`,source:u.ONLINE,name:a.name,info:a.info||"在线题库",path:a.path,download_url:a.download_url,title:a.name,lastModified:0})),...z.value.map(a=>({id:`remote-${a.path}`,source:u.REMOTE,name:a.name,info:a.info||"远程题库",path:a.path,download_url:a.download_url,title:a.name,lastModified:Date.now()}))]}function ne(a){switch(a){case u.LOCAL:return"从文件导入";case u.ONLINE_IMPORT:return"从在线导入";case u.REMOTE_IMPORT:return"从远程导入";case u.ONLINE:return"在线题库";case u.REMOTE:return"远程题库";default:return"未知来源"}}function gt(a){if(!g.value&&!(o.value&&o.value.id===a.id)){if(o.value=a,g.value=a,a.source===u.REMOTE&&b.value.find(l=>l.name===a.name&&(l.source===u.LOCAL||l.source===u.REMOTE_IMPORT))){J.value=!0,j.value={title:"覆盖本地题库",message:`发现同名本地题库"${a.name}"，加载远程版本将覆盖本地版本，是否继续？`,confirmText:"覆盖加载",cancelText:"取消",onConfirm:()=>{J.value=!1,d(`正在加载题库: ${a.name}`,"info"),bt(a)},onCancel:()=>{J.value=!1,o.value=null,g.value=null}};return}d(`正在加载题库: ${a.name}`,"info"),yt().then(()=>{x.value=o.value,d(`已加载题库: ${a.name}`,"success")}).catch(e=>{d(`加载题库失败: ${e.message}`,"error")}).finally(()=>{g.value=null})}}async function bt(a){try{const e=await Ue(a);if(e){s.saveQuizToStorage(a.name,e);const l=b.value.findIndex(r=>r.name===a.name&&(r.source===u.LOCAL||r.source===u.REMOTE_IMPORT||r.source===u.ONLINE_IMPORT)),n={id:`${u.REMOTE_IMPORT}-${Date.now()}`,name:a.name,path:"localStorage",source:u.REMOTE_IMPORT,info:ne(u.REMOTE_IMPORT),title:a.name,lastModified:Date.now()};l>=0?b.value[l]=n:b.value.push(n),s.saveQuizList(b.value),ke(a,e),o.value={...a,source:u.REMOTE_IMPORT,id:n.id},x.value=o.value,d(`已覆盖并加载题库: ${a.name}`,"success")}else throw new Error(`无法加载远程题库: ${a.name}`)}catch(e){d(`加载题库失败: ${e.message}`,"error")}finally{g.value=null}}async function yt(){if(!o.value)return;const a=o.value;try{const e=a.source;let l=null;if(e===u.ONLINE||e===u.REMOTE?(l=await Ue(a),l&&wt(a,l)):l=ht(a),l)ke(a,l);else throw new Error(`无法加载题库: ${a.name}`)}catch(e){throw e}}async function Ue(a){let e=a.download_url;if(a.source===u.ONLINE&&!e){let i=a.path||`${a.name}.json`;i.startsWith("./")&&(i=i.substring(2)),!i.startsWith("/")&&!i.startsWith("http")&&(i=`/${i}`),e=i}if(!e)throw new Error(`缺少下载链接: ${a.name}`);const l=`?t=${Date.now()}`,n=e.includes("?")?`${e}&t=${Date.now()}`:`${e}${l}`,r=await fetch(n);if(!r.ok)throw new Error(`获取题库数据失败 (${r.status}): ${r.statusText}`);try{const i=await r.json();if(!s.enhancedValidQuizData(i))throw new Error(`无效的题库数据格式: ${a.name}`);return i}catch(i){throw console.error(`题库数据格式错误: ${a.name}`,i),new Error(`题库数据格式错误: ${a.name}`)}}function ht(a){const e=s.loadQuizFromStorage(a.name);if(e)return e;if(a.source===u.LOCAL)throw new Error(`找不到题库缓存: ${a.name}`);return null}function wt(a,e){s.saveQuizToStorage(a.name,e);const l=a.source===u.ONLINE?u.ONLINE_IMPORT:u.REMOTE_IMPORT,n=b.value.findIndex(i=>i.name===a.name&&i.source===l),r={id:`${l}-${Date.now()}`,name:a.name,path:"localStorage",source:l,info:a.info||ne(l),title:a.name,lastModified:Date.now()};n>=0?b.value[n]=r:b.value.push(r),s.saveQuizList(b.value),o.value={...a,source:l}}function ke(a,e){p.value=e,s.setQuizData(e),o.value&&(o.value={...o.value,data:e}),f.value={source:o.value.source,name:a.name},s.saveLastLoadedQuiz(a.name,o.value.source),E.value="all",h.value=G.NORMAL,C.value=1,_.value=Ee(),s.setQuizConfig({chapterIndex:E.value,mode:h.value,rangeStart:C.value,rangeEnd:_.value,randomize:!1,wrongOnly:!1}),Ne()}function $t(){try{me.value=s.getQuizAnsweredCount(),fe.value=s.getQuizCorrectCount(),qe.value={totalAnswered:me.value,correctCount:fe.value,wrongCount:s.getQuizAnsweredCount()-s.getQuizCorrectCount(),dailyActivity:[]}}catch{d("加载统计数据失败","error")}}function Ee(){if(!p.value||!p.value.chapters)return 100;let a=0;return p.value.chapters.forEach(e=>{e.questions&&e.questions.length>0&&(a+=e.questions.length)}),a>0?a:100}function ze(a){ee.value=a}function Fe(a){return{[u.LOCAL]:"source-badge local",[u.ONLINE]:"source-badge online",[u.REMOTE]:"source-badge remote",[u.ONLINE_IMPORT]:"source-badge online-import",[u.REMOTE_IMPORT]:"source-badge remote-import"}[a.source]||"source-badge unknown"}function Be(a){return ne(a.source)}function Pe(a){return a?a.info?a.info:ne(a.source):"暂无描述"}function Ct(){le.value=!0}function kt(){s.setQuizConfig({mode:h.value,rangeStart:C.value,rangeEnd:_.value,randomize:h.value==="random",chapterIndex:E.value,wrongOnly:h.value==="wrong"}),s.saveQuizState(),le.value=!1,d("刷题模式已设置","success")}const Ge=Y(()=>{const a=s.getGithubConfig();return!!(a.owner&&a.repo&&a.token)});async function He(a){if(!v.value)return;F();const l=v.value.quiz.name,n=a==="fetch"?"从远程同步":"推送到远程";d(`正在${n}题库...`,"info"),L.value=!0;try{let r=!1;if(a==="fetch"){const i=await s.syncQuizFromGithub(l);r=!!i,r&&i&&(f.value&&f.value.name===l&&(p.value=i,o.value&&(o.value.data=i)),await U())}else r=await s.pushQuizToGithub(l);r&&await U()}catch(r){d(`${n}失败: ${r.message}`,"error")}finally{L.value=!1}}const Ve=c(""),ge=c(!1);function Me(){ge.value=!1}function Et(a){switch(a){case u.LOCAL:case u.ONLINE_IMPORT:case u.REMOTE_IMPORT:return R.CACHE;case u.ONLINE:return R.ONLINE;case u.REMOTE:return R.REMOTE;default:return R.CACHE}}function We(){if(!v.value||!T.value.trim()){d("请输入有效的题库名称","error");return}try{if(v.value.source==="local"){const a=b.value.find(e=>{var l;return e.path===((l=v.value)==null?void 0:l.quiz.path)});if(a){const e=a.name;a.name=T.value,s.saveQuizList(b.value);const l=s.loadQuizFromStorage(e);l&&(s.saveQuizToStorage(T.value,l),s.removeQuizFromStorage(e)),f.value&&f.value.source==="local"&&f.value.name===v.value.quiz.name&&(l&&(l.title=T.value,s.setQuizData(l)),f.value.name=T.value,s.saveLastLoadedQuiz(T.value,f.value.source)),d("题库重命名成功","success")}}else if(v.value.source==="remote"){const a=z.value.find(e=>{var l;return e.path===((l=v.value)==null?void 0:l.quiz.path)});a&&(a.name=T.value,p.value&&f.value&&f.value.source==="remote"&&f.value.name===v.value.quiz.name&&(p.value.title=T.value,f.value.name=T.value,s.setQuizData(p.value),s.saveLastLoadedQuiz(T.value,f.value.source)),d("题库重命名成功（仅本地显示名称变更）","success"))}}catch(a){d(`重命名题库失败: ${a.message}`,"error")}finally{ae.value=!1}}const zt=()=>{s.toggleDarkMode(),se.value=s.getUiSettings().darkMode;const a=document.querySelector(".page-library__theme-toggle");a&&a.classList.toggle("dark",se.value)};function Mt(){if(!o.value){d("请先选择一个题库","warning");return}ve.value=!0}async function Qt(a){console.log("同步完成",a),await U();const e=await s.handleQuizSyncComplete(a);if(e){if((e.isNewQuiz||e.wasOverridden)&&e.data){const l={id:`${e.source}-${Date.now()}`,name:e.quizName,source:u.REMOTE_IMPORT,path:"localStorage",info:ne(u.REMOTE_IMPORT),data:e.data,title:e.data.title||e.quizName};o.value=l,ke(l,e.data),x.value=o.value,a.action==="pull"?(d("题库已加载，正在跳转到刷题页面...","success"),setTimeout(()=>{Re()},1e3)):d(`已加载题库: ${e.quizName}`,"success")}await U()}}return(a,e)=>(m(),y("div",fa,[t("div",_a,[t("div",ga,[t("button",{class:"page-library__action-button page-library__action-button--secondary",title:"返回主页",onClick:ft},[$(M,{name:"home"})]),e[43]||(e[43]=t("div",{class:"page-library__title"}," Elyxira ",-1)),t("div",ba,[t("div",{class:Q(["page-library__theme-toggle",{dark:se.value}]),onClick:zt},e[42]||(e[42]=[t("i",{class:"sun-icon fas fa-sun"},null,-1),t("i",{class:"moon-icon fas fa-moon"},null,-1)]),2),$(Bt,{class:"page-library__action-button page-library__action-button--secondary",onOpenGeneralSettings:e[0]||(e[0]=l=>q.value=!0),onOpenRepoSettings:e[1]||(e[1]=l=>ve.value=!0),onOpenDebug:e[2]||(e[2]=l=>ue.value=!0)})])]),t("div",ya,[t("div",ha,[e[44]||(e[44]=t("div",{class:"page-library__card-title"},"题库列表",-1)),t("div",wa,[t("input",{type:"file",id:"quizFileInput",accept:".json,.txt",class:"file-input",onChange:pt,style:{display:"none"}},null,32),t("button",{class:"page-library__action-button page-library__action-button--primary",onClick:e[3]||(e[3]=l=>de.value=!0)},[$(M,{name:"upload",size:"16"})]),t("button",{class:"page-library__action-button page-library__action-button--secondary",onClick:Mt,title:"同步仓库"},[$(M,{name:"github",size:"16"})]),t("button",{class:"page-library__action-button page-library__action-button--secondary",onClick:U,title:"刷新列表"},[$(M,{name:"refresh",size:"16"})])])]),t("div",$a,[t("div",Ca,[t("button",{class:Q(["page-library__filter-button",{"page-library__filter-button--active":ee.value===S(R).CACHE||!ee.value}]),onClick:e[4]||(e[4]=l=>ze(S(R).CACHE))}," 缓存 ",2),t("button",{class:Q(["page-library__filter-button",{"page-library__filter-button--active":ee.value===S(R).ONLINE}]),onClick:e[5]||(e[5]=l=>ze(S(R).ONLINE))}," 在线 ",2),t("button",{class:Q(["page-library__filter-button",{"page-library__filter-button--active":ee.value===S(R).REMOTE}]),onClick:e[6]||(e[6]=l=>ze(S(R).REMOTE))}," 远程 ",2)]),t("div",ka,[X(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=l=>_e.value=l),placeholder:"搜索题库...",class:"page-library__search-input"},null,512),[[ce,_e.value]]),$(M,{name:"search",size:"14",class:"page-library__search-icon"})])]),t("div",Ea,[t("table",za,[e[49]||(e[49]=t("thead",null,[t("tr",null,[t("th",null,"题库名称"),t("th",null,"来源"),t("th",null,"描述"),t("th",null,"最后修改"),t("th",null,"操作")])],-1)),t("tbody",null,[I.value?(m(),y("tr",Ma,[t("td",Qa,[t("div",La,[t("div",Oa,[$(M,{name:"refresh",size:"24"})]),e[45]||(e[45]=t("div",{class:"page-library__loading-text"},"正在刷新题库列表...",-1))])])])):O("",!0),I.value?O("",!0):(m(),y(ye,{key:1},[(m(!0),y(ye,null,Se(Ae.value,l=>(m(),y("tr",{key:l.id,class:Q({"page-library__table-row":!0,loading:g.value&&g.value.id===l.id})},[t("td",Sa,k(l.name),1),t("td",null,[t("span",{class:Q(["source-badge",Fe(l)])},k(Be(l)),3)]),t("td",Ta,k(Pe(l)),1),t("td",null,k(l.lastModified?new Date(l.lastModified).toLocaleDateString():"未知"),1),t("td",xa,[t("button",{class:"page-library__table-button",onClick:n=>gt(l)},"选择",8,Ia),l.source!==S(u).ONLINE?(m(),y("button",{key:0,class:"page-library__table-more",onClick:n=>nt(n,l.source,l)},[$(M,{name:"more",size:"16"})],8,Na)):O("",!0)])],2))),128)),Ae.value.length===0?(m(),y("tr",Ra,[t("td",Da,[t("div",Aa,[e[46]||(e[46]=t("div",{class:"page-library__empty-icon"},"📭",-1)),e[47]||(e[47]=t("h3",{class:"page-library__empty-title"},"没有找到题库",-1)),e[48]||(e[48]=t("p",{class:"page-library__empty-subtitle"},"请导入题库或更改筛选条件",-1)),t("button",{class:"page-library__empty-action",onClick:e[8]||(e[8]=l=>de.value=!0)},"导入题库")])])])):O("",!0)],64))])])])]),V.value?(m(),y("div",{key:0,class:Q(["context-menu",{closing:W.value}]),style:Nt({top:ie.value+"px",left:w.value+"px"})},[v.value&&v.value.source!==S(u).ONLINE?(m(),y("div",{key:0,class:"menu-item",onClick:rt},[$(M,{name:"rename",size:"16"}),e[50]||(e[50]=D(" 重命名 "))])):O("",!0),v.value&&v.value.source!==S(u).ONLINE?(m(),y("div",{key:1,class:"menu-item delete",onClick:it},[$(M,{name:"delete",size:"16"}),e[51]||(e[51]=D(" 删除 "))])):O("",!0),v.value&&v.value.source===S(u).LOCAL&&Ge.value?(m(),y("div",{key:2,class:"menu-item",onClick:e[9]||(e[9]=l=>He("fetch"))},[$(M,{name:"refresh",size:"16"}),e[52]||(e[52]=D(" 从远程同步 "))])):O("",!0),v.value&&v.value.source===S(u).LOCAL&&Ge.value?(m(),y("div",{key:3,class:"menu-item",onClick:e[10]||(e[10]=l=>He("push"))},[$(M,{name:"upload",size:"16"}),e[53]||(e[53]=D(" 推送到远程 "))])):O("",!0)],6)):O("",!0),t("div",{class:Q(["modal-overlay",{active:ae.value}]),onClick:e[14]||(e[14]=te(l=>ae.value=!1,["self"]))},[t("div",ja,[t("div",Ua,[e[54]||(e[54]=t("h2",{class:"page-library__modal-title"},"重命名题库",-1)),t("button",{class:"page-library__modal-close",onClick:e[11]||(e[11]=l=>ae.value=!1)},"×")]),t("div",Fa,[t("div",Ba,[e[55]||(e[55]=t("label",{for:"newQuizName"},"题库名称",-1)),e[56]||(e[56]=t("div",{class:"form-description"},"输入新的题库名称",-1)),X(t("input",{type:"text",id:"newQuizName","onUpdate:modelValue":e[12]||(e[12]=l=>T.value=l),class:"page-library__search-input",placeholder:"请输入新名称",onKeyup:Rt(We,["enter"])},null,544),[[ce,T.value]])])]),t("div",Pa,[t("button",{class:"page-library__filter-button",onClick:e[13]||(e[13]=l=>ae.value=!1)},"取消"),t("button",{class:"page-library__card-action",onClick:We},"确认")])])],2),t("div",Ga,[e[74]||(e[74]=t("div",{class:"page-library__card-header"},[t("div",{class:"page-library__card-title"},"刷题设置")],-1)),t("div",Ha,[o.value?(m(),y("div",Va,[t("div",Wa,[t("h3",Ja,k(o.value.name),1),t("div",{class:Q(["source-badge",Fe(o.value)])},k(Be(o.value)),3)]),t("p",Ka,k(Pe(o.value)),1)])):(m(),y("div",Ya,e[57]||(e[57]=[t("p",null,"请从上方列表选择一个题库",-1)]))),t("div",Xa,[t("div",Za,[e[60]||(e[60]=t("div",{class:"page-library__filter-label"},"章节：",-1)),X(t("select",{"onUpdate:modelValue":e[15]||(e[15]=l=>E.value=l),class:"page-library__filter-select",disabled:I.value},[e[58]||(e[58]=t("option",{value:"all"},"全部章节",-1)),(m(!0),y(ye,null,Se(Ie.value,(l,n)=>(m(),y("option",{key:n,value:l},k(l),9,el))),128))],8,qa),[[Dt,E.value]]),t("button",{class:"page-library__filter-button",onClick:Ct,disabled:I.value},[$(M,{name:"stats",size:"16"}),e[59]||(e[59]=t("span",null,"刷题模式",-1))],8,tl)]),t("button",{class:"page-library__card-action page-library__start-button",onClick:Re,disabled:!_t.value||I.value},[$(M,{name:"start",size:"16"}),e[61]||(e[61]=t("span",null,"开始刷题",-1))],8,al)])]),t("div",ll,[e[73]||(e[73]=t("h4",{class:"page-library__section-title"},"题库统计",-1)),t("div",{class:Q(["page-library__stats-grid",{loading:I.value}])},[I.value?(m(),y("div",ol,[t("div",sl,[$(M,{name:"refresh",size:"24"})]),e[62]||(e[62]=t("div",{class:"page-library__loading-text"},"正在加载统计数据...",-1))])):O("",!0),t("div",nl,[e[64]||(e[64]=t("div",{class:"page-library__stat-icon"},[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),t("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})])],-1)),t("div",rl,[e[63]||(e[63]=t("div",{class:"page-library__stat-title"},"章节数",-1)),t("div",il,k(Ie.value.length||0),1)])]),t("div",ul,[e[66]||(e[66]=t("div",{class:"page-library__stat-icon"},[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),t("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"})])],-1)),t("div",dl,[e[65]||(e[65]=t("div",{class:"page-library__stat-title"},"题目数",-1)),t("div",cl,k(Ze.value||0),1)])]),t("div",vl,[e[68]||(e[68]=t("div",{class:"page-library__stat-icon"},[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("path",{d:"M12 6v6l4 2"})])],-1)),t("div",pl,[e[67]||(e[67]=t("div",{class:"page-library__stat-title"},"已答题数",-1)),t("div",ml,k(me.value||0),1)])]),t("div",fl,[e[70]||(e[70]=t("div",{class:"page-library__stat-icon"},[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),t("polyline",{points:"22 4 12 14.01 9 11.01"})])],-1)),t("div",_l,[e[69]||(e[69]=t("div",{class:"page-library__stat-title"},"正确题数",-1)),t("div",gl,k(fe.value||0),1)])]),t("div",bl,[e[72]||(e[72]=t("div",{class:"page-library__stat-icon"},[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})])],-1)),t("div",yl,[e[71]||(e[71]=t("div",{class:"page-library__stat-title"},"正确率",-1)),t("div",hl,k(et.value),1)])])],2)])]),t("div",{class:Q(["modal-overlay",{active:le.value}]),onClick:e[25]||(e[25]=te(l=>le.value=!1,["self"]))},[t("div",wl,[t("div",$l,[e[75]||(e[75]=t("h2",{class:"page-library__modal-title"},"选择刷题模式",-1)),t("button",{class:"page-library__modal-close",onClick:e[16]||(e[16]=l=>le.value=!1)},"×")]),t("div",Cl,[t("div",kl,[t("div",{class:Q(["mode-option",{active:h.value===S(G).NORMAL}]),onClick:e[18]||(e[18]=l=>h.value=S(G).NORMAL)},[X(t("input",{type:"radio",name:"quizMode",value:"normal","onUpdate:modelValue":e[17]||(e[17]=l=>h.value=l)},null,512),[[Ke,h.value]]),e[76]||(e[76]=t("span",{class:"mode-label"},"普通模式",-1)),e[77]||(e[77]=t("span",{class:"mode-desc"},"按照题库顺序进行刷题",-1))],2),t("div",{class:Q(["mode-option",{active:h.value===S(G).RANGE}]),onClick:e[23]||(e[23]=l=>h.value=S(G).RANGE)},[X(t("input",{type:"radio",name:"quizMode",value:"range","onUpdate:modelValue":e[19]||(e[19]=l=>h.value=l)},null,512),[[Ke,h.value]]),e[79]||(e[79]=t("span",{class:"mode-label"},"范围模式",-1)),e[80]||(e[80]=t("span",{class:"mode-desc"},"选择特定题号范围进行刷题",-1)),h.value===S(G).RANGE?(m(),y("div",{key:0,class:"range-inputs",onClick:e[22]||(e[22]=te(()=>{},["stop"]))},[X(t("input",{type:"number",placeholder:"起始题号",min:"1","onUpdate:modelValue":e[20]||(e[20]=l=>C.value=l),class:"page-library__search-input"},null,512),[[ce,C.value]]),e[78]||(e[78]=t("span",{class:"range-separator"},"至",-1)),X(t("input",{type:"number",placeholder:"结束题号",min:"1","onUpdate:modelValue":e[21]||(e[21]=l=>_.value=l),class:"page-library__search-input"},null,512),[[ce,_.value]])])):O("",!0)],2)])]),t("div",El,[t("button",{class:"page-library__filter-button",onClick:e[24]||(e[24]=l=>le.value=!1)},"取消"),t("button",{class:"page-library__card-action",onClick:kt},"确认")])])],2),de.value?(m(),he(ma,{key:1,"quiz-data":p.value||void 0,show:de.value,onClose:e[26]||(e[26]=l=>de.value=!1),onImportComplete:U},null,8,["quiz-data","show"])):O("",!0),$(At,{show:ve.value,onClose:e[27]||(e[27]=l=>ve.value=!1),onSyncComplete:Qt,onSave:vt},null,8,["show"]),$(jt,{show:q.value,"current-settings":Ce,onClose:e[28]||(e[28]=l=>q.value=!1),onSave:mt},null,8,["show","current-settings"]),t("div",{class:Q(["modal-overlay",{active:ue.value}]),onClick:e[30]||(e[30]=te(l=>ue.value=!1,["self"]))},[ue.value?(m(),he(Xt,{key:0,onClose:e[29]||(e[29]=l=>ue.value=!1)})):O("",!0)],2),t("div",{class:Q(["modal-overlay",{active:ge.value}]),onClick:e[33]||(e[33]=te(l=>Me(),["self"]))},[ge.value?(m(),y("div",zl,[t("div",Ml,[e[81]||(e[81]=t("h3",{class:"page-library__modal-title"},"错误详情",-1)),t("button",{class:"page-library__modal-close",onClick:e[31]||(e[31]=l=>Me())},"×")]),t("div",Ql,[t("div",Ll,[t("pre",null,k(Ve.value),1)])]),t("div",Ol,[t("button",{class:"page-library__card-action",onClick:e[32]||(e[32]=l=>Me())},"关闭")])])):O("",!0)],2),t("div",{class:Q(["modal-overlay",{active:oe.value}]),onClick:e[37]||(e[37]=te(l=>oe.value=!1,["self"]))},[t("div",Sl,[t("div",Tl,[e[82]||(e[82]=t("h3",{class:"page-library__modal-title"},"确认删除",-1)),t("button",{class:"page-library__modal-close",onClick:e[34]||(e[34]=l=>oe.value=!1)},"×")]),t("div",xl,[t("p",Il,[$(M,{name:"warning",size:"24"}),e[83]||(e[83]=D(" 确定要删除题库 ")),t("strong",null,k(Te.value),1),e[84]||(e[84]=D(" 吗？ "))]),xe.value==="remote"?(m(),y("p",Nl," 此操作将从GitHub仓库中永久删除该文件，无法恢复！ ")):O("",!0)]),t("div",Rl,[t("button",{class:"page-library__filter-button",onClick:e[35]||(e[35]=l=>oe.value=!1)},"取消"),t("button",{class:"page-library__card-action page-library__card-action--danger",onClick:e[36]||(e[36]=l=>ut()),disabled:pe.value},[pe.value?(m(),y("span",Al,[$(M,{name:"refresh",size:"16",class:"icon-spin"}),e[85]||(e[85]=D(" 删除中... "))])):(m(),y("span",jl,"确认删除"))],8,Dl)])])],2),t("div",{class:Q(["modal-overlay",{active:J.value}]),onClick:e[41]||(e[41]=te(l=>J.value=!1,["self"]))},[t("div",Ul,[t("div",Fl,[t("h3",Bl,k(j.value.title),1),t("button",{class:"page-library__modal-close",onClick:e[38]||(e[38]=l=>J.value=!1)},"×")]),t("div",Pl,[t("p",Gl,[$(M,{name:"warning",size:"24"}),D(" "+k(j.value.message),1)])]),t("div",Hl,[t("button",{class:"page-library__filter-button",onClick:e[39]||(e[39]=(...l)=>j.value.onCancel&&j.value.onCancel(...l))},k(j.value.cancelText||"取消"),1),t("button",{class:"page-library__card-action",onClick:e[40]||(e[40]=(...l)=>j.value.onConfirm&&j.value.onConfirm(...l))},k(j.value.confirmText||"确定"),1)])])],2)])]))}});export{Kl as default};
