var rt=Object.defineProperty;var ot=(h,e,t)=>e in h?rt(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var x=(h,e,t)=>ot(h,typeof e!="symbol"?e+"":e,t);import{d as pe,g as je,c as E,b as T,e as u,z as at,t as D,y as me,K as lt,s as b,f as F,A as ut,L as Ie,n as be,r as M,o as Be,E as Ge,p as Se,l as ct,w as j,q as $,v as B,G as P,i as ee,m as Te,F as Ee,k as pt,C as ht}from"./index-CoD9fYjj.js";const gt=["width","height"],Le=pe({__name:"icon",props:{name:{},size:{default:24}},setup(h){const e=h,t={home:"home",dark_mode:"dark_mode",github:"code",refresh:"refresh",search:"search",more:"more_vert",rename:"edit",delete:"delete",upload:"upload",stats:"bar_chart",start:"play_arrow",settings:"settings",download:"download",warning:"warning"},s=je(()=>t[e.name]||e.name);return(n,i)=>e.name==="github"?(T(),E("svg",{key:0,viewBox:"0 0 24 24",width:n.size,height:n.size,style:{display:"inline-block",verticalAlign:"middle"}},i[0]||(i[0]=[u("path",{fill:"currentColor",d:"M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z"},null,-1)]),8,gt)):(T(),E("i",{key:1,class:"material-icons",style:at({fontSize:`${n.size}px`,lineHeight:1,verticalAlign:"middle"})},D(s.value),5))}});class dt{canParse(e){if(!e||typeof e!="object")return!1;const t=e;if(!Array.isArray(t.chapters)||t.chapters.length===0)return!1;const s=t.chapters[0];if(!s.title||!Array.isArray(s.questions))return!1;if(s.questions.length>0){const n=s.questions[0];if(!n.title||!Array.isArray(n.options))return!1}return!0}parse(e){return e}}class ft{canParse(e){return typeof e=="string"&&!this.isJson(e)}isJson(e){try{return JSON.parse(e),!0}catch{return!1}}parse(e,t){if(typeof e!="string")throw new Error("TextFormatParser只能处理字符串数据");const n=e.split(`
`).filter(o=>o.trim()),i=t?t.replace(/\.(txt|json)$/,""):n[0]||"未命名题库",r=[];let a={title:"默认章节",questions:[]},l=null;for(let o=1;o<n.length;o++){const p=n[o].trim();if(p.startsWith("## "))a.questions.length>0&&r.push(a),a={title:p.substring(3),questions:[]},l=null;else if(p.match(/^\d+\./))l&&a.questions.push(l),l={id:`q-${Date.now()}-${Math.random().toString(36).slice(2)}`,title:p.substring(p.indexOf(".")+1).trim(),options:[],answer:0,explanation:""};else if(p.startsWith("- ")&&l)l.options.push(p.substring(2).trim());else if(p.startsWith("答案:")&&l){const m=p.substring(3).trim();l.answer=parseInt(m)-1||0}else p.startsWith("解析:")&&l&&(l.explanation=p.substring(3).trim())}return l&&a.questions.push(l),a.questions.length>0&&r.push(a),{title:i,chapters:r,description:"从文本导入",lastModified:Date.now()}}}class Qe{canParse(e){if(!e||typeof e!="object")return!1;const t=e;if(Array.isArray(t.questions)&&t.questions.length>0)return!0;if(Array.isArray(e)&&e.length>0){const s=e[0];if(s&&typeof s=="object")return s.question!==void 0||s.title!==void 0||s.stem!==void 0||s.options!==void 0||s.answer!==void 0}return!1}parse(e,t){const s=e;let n=s.title||"题库";t?n=t.replace(/\.(json|txt)$/,""):s.fileName&&typeof s.fileName=="string"?n=s.fileName.replace(/\.(json|txt)$/,""):s.name&&typeof s.name=="string"&&(n=s.name),n.includes("[")&&n.includes("]")&&(n=n.replace(/\[|\]/g,""));const i=[],r={title:"默认章节",questions:[]};return this.processQuestions(s,r),r.questions.length>0&&i.push(r),this.processChapters(s,i),{title:n,description:typeof s.description=="string"?s.description:"导入的题库",author:typeof s.author=="string"?s.author:"",version:typeof s.version=="string"?s.version:"1.0",lastModified:Date.now(),chapters:i.length>0?i:[r]}}processQuestions(e,t){Array.isArray(e.questions)?e.questions.forEach((s,n)=>{if(!s||typeof s!="object")return;const i=s;this.createQuestion(i,n,t)}):Array.isArray(e)&&e.forEach((s,n)=>{if(!s||typeof s!="object")return;const i=s;this.createQuestion(i,n,t)})}processChapters(e,t){Array.isArray(e.chapters)&&e.chapters.length>0&&e.chapters.forEach((s,n)=>{if(!s||typeof s!="object")return;const i=s;if(i.title&&Array.isArray(i.questions)&&i.questions.length>0){const r={title:typeof i.title=="string"?i.title:`第${n+1}章`,questions:[]};i.questions.forEach((a,l)=>{if(!a||typeof a!="object")return;const o=a;this.createQuestion(o,l,r)}),r.questions.length>0&&t.push(r)}})}createQuestion(e,t,s){const n={id:typeof e.id=="string"||typeof e.id=="number"?String(e.id):`q-${Date.now()}-${t}`,title:"",options:[],answer:0,explanation:""};typeof e.question=="string"?n.title=e.question:typeof e.title=="string"?n.title=e.title:typeof e.stem=="string"?n.title=e.stem:typeof e.content=="string"?n.title=e.content:n.title=`第${t+1}题`,(n.title.includes("<p>")||n.title.includes("</p>"))&&(n.title=n.title.replace(/<\/?p>/g,"")),typeof e.analysis=="string"?n.explanation=e.analysis:typeof e.explanation=="string"?n.explanation=e.explanation:typeof e.parse=="string"?n.explanation=e.parse:typeof e.comment=="string"&&(n.explanation=e.comment),n.options=this.extractOptions(e),n.answer=this.extractAnswer(e,n.options.length),s.questions.push(n)}extractOptions(e){if(Array.isArray(e.options))return this.processOptionsArray(e.options);if(e.options&&typeof e.options=="object")return this.processOptionsObject(e.options);if(Array.isArray(e.choices))return this.processOptionsArray(e.choices);if(e.choices&&typeof e.choices=="object")return this.processOptionsObject(e.choices);const t=[],s=["A","B","C","D","E","F","G","H"];for(const n of s)n in e&&typeof e[n]=="string"&&t.push(e[n]);return t.length>=2?t:["选项A","选项B","选项C","选项D"]}processOptionsArray(e){return e.map(t=>{if(typeof t=="string")return t;if(typeof t=="number")return String(t);if(t===null)return"";if(typeof t=="object"){const s=t;if(typeof s.text=="string")return s.text;if(typeof s.content=="string")return s.content;if(typeof s.label=="string")return s.label;if(typeof s.value=="string")return s.value;if(typeof s.option=="string")return s.option;const n=Object.keys(s);return n.length===1&&typeof s[n[0]]=="string"?s[n[0]]:JSON.stringify(t)}return String(t)})}processOptionsObject(e){let t=Object.keys(e);return t=t.sort((s,n)=>/^[A-Z]$/.test(s)&&/^[A-Z]$/.test(n)?s.charCodeAt(0)-n.charCodeAt(0):/^\d+$/.test(s)&&/^\d+$/.test(n)?parseInt(s)-parseInt(n):s.localeCompare(n)),t.map(s=>{const n=e[s];if(typeof n=="string")return n;if(typeof n=="number")return String(n);if(n===null)return"";if(typeof n=="object"){const i=n;return typeof i.text=="string"?i.text:typeof i.content=="string"?i.content:typeof i.label=="string"?i.label:typeof i.value=="string"?i.value:JSON.stringify(n)}return String(n)})}extractAnswer(e,t){let s;return e.answer!==void 0?s=e.answer:e.correct!==void 0?s=e.correct:e.rightAnswer!==void 0?s=e.rightAnswer:e.correctAnswer!==void 0&&(s=e.correctAnswer),this.processAnswer(s,t)}processAnswer(e,t){if(typeof e=="number")return Math.min(Math.max(0,e),t-1);if(typeof e=="string"){if(/^[A-Z]$/.test(e)){const s=e.charCodeAt(0)-65;return Math.min(Math.max(0,s),t-1)}if(/^\d+$/.test(e)){const s=parseInt(e)-1;return Math.min(Math.max(0,s),t-1)}if(/^[A-Z]+$/.test(e))return Array.from(e).map(s=>{const n=s.charCodeAt(0)-65;return Math.min(Math.max(0,n),t-1)});if(e.includes(","))return e.split(",").map(s=>/^[A-Z]$/.test(s)?s.charCodeAt(0)-65:/^\d+$/.test(s)?parseInt(s)-1:0)}return Array.isArray(e)?e.map(s=>{if(typeof s=="number")return Math.min(Math.max(0,s),t-1);if(typeof s=="string"){if(/^[A-Z]$/.test(s))return s.charCodeAt(0)-65;if(/^\d+$/.test(s))return parseInt(s)-1}return 0}):0}}class mt{constructor(){x(this,"parsers",[]);this.register(new dt),this.register(new ft),this.register(new Qe)}register(e){this.parsers.push(e)}parse(e,t){let s=e;if(typeof e=="string")try{s=JSON.parse(e)}catch{}for(const n of this.parsers)if(n.canParse(s))return n.parse(s,t);return new Qe().parse(s,t)}}const oe=new mt;function _n(h,e){return oe.parse(h,e)}function we(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let V=we();function Fe(h){V=h}const te={exec:()=>null};function _(h,e=""){let t=typeof h=="string"?h:h.source;const s={replace:(n,i)=>{let r=typeof i=="string"?i:i.source;return r=r.replace(I.caret,"$1"),t=t.replace(n,r),s},getRegex:()=>new RegExp(t,e)};return s}const I={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:h=>new RegExp(`^( {0,3}${h})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}#`),htmlBeginRegex:h=>new RegExp(`^ {0,${Math.min(3,h-1)}}<(?:[a-z].*>|!--)`,"i")},bt=/^(?:[ \t]*(?:\n|$))+/,St=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,yt=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ne=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,kt=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,ve=/(?:[*+-]|\d{1,9}[.)])/,Ue=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Ve=_(Ue).replace(/bull/g,ve).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),wt=_(Ue).replace(/bull/g,ve).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),xe=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,vt=/^[^\n]+/,_e=/(?!\s*\])(?:\\.|[^\[\]\\])+/,xt=_(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",_e).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),_t=_(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,ve).getRegex(),he="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ze=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,zt=_("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ze).replace("tag",he).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Je=_(xe).replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex(),$t=_(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Je).getRegex(),$e={blockquote:$t,code:St,def:xt,fences:yt,heading:kt,hr:ne,html:zt,lheading:Ve,list:_t,newline:bt,paragraph:Je,table:te,text:vt},Re=_("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex(),At={...$e,lheading:wt,table:Re,paragraph:_(xe).replace("hr",ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Re).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex()},Ct={...$e,html:_(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ze).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:te,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:_(xe).replace("hr",ne).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ve).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},qt=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Pt=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,He=/^( {2,}|\\)\n(?!\s*$)/,It=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ge=/[\p{P}\p{S}]/u,Ae=/[\s\p{P}\p{S}]/u,Ze=/[^\s\p{P}\p{S}]/u,Tt=_(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Ae).getRegex(),We=/(?!~)[\p{P}\p{S}]/u,Et=/(?!~)[\s\p{P}\p{S}]/u,Lt=/(?:[^\s\p{P}\p{S}]|~)/u,Qt=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Ke=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Rt=_(Ke,"u").replace(/punct/g,ge).getRegex(),Dt=_(Ke,"u").replace(/punct/g,We).getRegex(),Xe="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Nt=_(Xe,"gu").replace(/notPunctSpace/g,Ze).replace(/punctSpace/g,Ae).replace(/punct/g,ge).getRegex(),Ot=_(Xe,"gu").replace(/notPunctSpace/g,Lt).replace(/punctSpace/g,Et).replace(/punct/g,We).getRegex(),Mt=_("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ze).replace(/punctSpace/g,Ae).replace(/punct/g,ge).getRegex(),jt=_(/\\(punct)/,"gu").replace(/punct/g,ge).getRegex(),Bt=_(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Gt=_(ze).replace("(?:-->|$)","-->").getRegex(),Ft=_("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Gt).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),le=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ut=_(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",le).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ye=_(/^!?\[(label)\]\[(ref)\]/).replace("label",le).replace("ref",_e).getRegex(),et=_(/^!?\[(ref)\](?:\[\])?/).replace("ref",_e).getRegex(),Vt=_("reflink|nolink(?!\\()","g").replace("reflink",Ye).replace("nolink",et).getRegex(),Ce={_backpedal:te,anyPunctuation:jt,autolink:Bt,blockSkip:Qt,br:He,code:Pt,del:te,emStrongLDelim:Rt,emStrongRDelimAst:Nt,emStrongRDelimUnd:Mt,escape:qt,link:Ut,nolink:et,punctuation:Tt,reflink:Ye,reflinkSearch:Vt,tag:Ft,text:It,url:te},Jt={...Ce,link:_(/^!?\[(label)\]\((.*?)\)/).replace("label",le).getRegex(),reflink:_(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",le).getRegex()},ye={...Ce,emStrongRDelimAst:Ot,emStrongLDelim:Dt,url:_(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ht={...ye,br:_(He).replace("{2,}","*").getRegex(),text:_(ye.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},re={normal:$e,gfm:At,pedantic:Ct},W={normal:Ce,gfm:ye,breaks:Ht,pedantic:Jt},Zt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},De=h=>Zt[h];function O(h,e){if(e){if(I.escapeTest.test(h))return h.replace(I.escapeReplace,De)}else if(I.escapeTestNoEncode.test(h))return h.replace(I.escapeReplaceNoEncode,De);return h}function Ne(h){try{h=encodeURI(h).replace(I.percentDecode,"%")}catch{return null}return h}function Oe(h,e){var i;const t=h.replace(I.findPipe,(r,a,l)=>{let o=!1,p=a;for(;--p>=0&&l[p]==="\\";)o=!o;return o?"|":" |"}),s=t.split(I.splitPipe);let n=0;if(s[0].trim()||s.shift(),s.length>0&&!((i=s.at(-1))!=null&&i.trim())&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;n<s.length;n++)s[n]=s[n].trim().replace(I.slashPipe,"|");return s}function K(h,e,t){const s=h.length;if(s===0)return"";let n=0;for(;n<s&&h.charAt(s-n-1)===e;)n++;return h.slice(0,s-n)}function Wt(h,e){if(h.indexOf(e[1])===-1)return-1;let t=0;for(let s=0;s<h.length;s++)if(h[s]==="\\")s++;else if(h[s]===e[0])t++;else if(h[s]===e[1]&&(t--,t<0))return s;return-1}function Me(h,e,t,s,n){const i=e.href,r=e.title||null,a=h[1].replace(n.other.outputLinkReplace,"$1");if(h[0].charAt(0)!=="!"){s.state.inLink=!0;const l={type:"link",raw:t,href:i,title:r,text:a,tokens:s.inlineTokens(a)};return s.state.inLink=!1,l}return{type:"image",raw:t,href:i,title:r,text:a}}function Kt(h,e,t){const s=h.match(t.other.indentCodeCompensation);if(s===null)return e;const n=s[1];return e.split(`
`).map(i=>{const r=i.match(t.other.beginningSpace);if(r===null)return i;const[a]=r;return a.length>=n.length?i.slice(n.length):i}).join(`
`)}class ue{constructor(e){x(this,"options");x(this,"rules");x(this,"lexer");this.options=e||V}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const s=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?s:K(s,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const s=t[0],n=Kt(s,t[3]||"",this.rules);return{type:"code",raw:s,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let s=t[2].trim();if(this.rules.other.endingHash.test(s)){const n=K(s,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(s=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:K(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let s=K(t[0],`
`).split(`
`),n="",i="";const r=[];for(;s.length>0;){let a=!1;const l=[];let o;for(o=0;o<s.length;o++)if(this.rules.other.blockquoteStart.test(s[o]))l.push(s[o]),a=!0;else if(!a)l.push(s[o]);else break;s=s.slice(o);const p=l.join(`
`),m=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${p}`:p,i=i?`${i}
${m}`:m;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(m,r,!0),this.lexer.state.top=d,s.length===0)break;const S=r.at(-1);if((S==null?void 0:S.type)==="code")break;if((S==null?void 0:S.type)==="blockquote"){const k=S,v=k.raw+`
`+s.join(`
`),w=this.blockquote(v);r[r.length-1]=w,n=n.substring(0,n.length-k.raw.length)+w.raw,i=i.substring(0,i.length-k.text.length)+w.text;break}else if((S==null?void 0:S.type)==="list"){const k=S,v=k.raw+`
`+s.join(`
`),w=this.list(v);r[r.length-1]=w,n=n.substring(0,n.length-S.raw.length)+w.raw,i=i.substring(0,i.length-k.raw.length)+w.raw,s=v.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:r,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let s=t[1].trim();const n=s.length>1,i={type:"list",raw:"",ordered:n,start:n?+s.slice(0,-1):"",loose:!1,items:[]};s=n?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=n?s:"[*+-]");const r=this.rules.other.listItemRegex(s);let a=!1;for(;e;){let o=!1,p="",m="";if(!(t=r.exec(e))||this.rules.block.hr.test(e))break;p=t[0],e=e.substring(p.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,f=>" ".repeat(3*f.length)),S=e.split(`
`,1)[0],k=!d.trim(),v=0;if(this.options.pedantic?(v=2,m=d.trimStart()):k?v=t[1].length+1:(v=t[2].search(this.rules.other.nonSpaceChar),v=v>4?1:v,m=d.slice(v),v+=t[1].length),k&&this.rules.other.blankLine.test(S)&&(p+=S+`
`,e=e.substring(S.length+1),o=!0),!o){const f=this.rules.other.nextBulletRegex(v),J=this.rules.other.hrRegex(v),N=this.rules.other.fencesBeginRegex(v),y=this.rules.other.headingBeginRegex(v),g=this.rules.other.htmlBeginRegex(v);for(;e;){const A=e.split(`
`,1)[0];let L;if(S=A,this.options.pedantic?(S=S.replace(this.rules.other.listReplaceNesting,"  "),L=S):L=S.replace(this.rules.other.tabCharGlobal,"    "),N.test(S)||y.test(S)||g.test(S)||f.test(S)||J.test(S))break;if(L.search(this.rules.other.nonSpaceChar)>=v||!S.trim())m+=`
`+L.slice(v);else{if(k||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||N.test(d)||y.test(d)||J.test(d))break;m+=`
`+S}!k&&!S.trim()&&(k=!0),p+=A+`
`,e=e.substring(A.length+1),d=L.slice(v)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(p)&&(a=!0));let w=null,c;this.options.gfm&&(w=this.rules.other.listIsTask.exec(m),w&&(c=w[0]!=="[ ] ",m=m.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:p,task:!!w,checked:c,loose:!1,text:m,tokens:[]}),i.raw+=p}const l=i.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let o=0;o<i.items.length;o++)if(this.lexer.state.top=!1,i.items[o].tokens=this.lexer.blockTokens(i.items[o].text,[]),!i.loose){const p=i.items[o].tokens.filter(d=>d.type==="space"),m=p.length>0&&p.some(d=>this.rules.other.anyLine.test(d.raw));i.loose=m}if(i.loose)for(let o=0;o<i.items.length;o++)i.items[o].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const s=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:s,raw:t[0],href:n,title:i}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const s=Oe(t[1]),n=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:t[0],header:[],align:[],rows:[]};if(s.length===n.length){for(const l of n)this.rules.other.tableAlignRight.test(l)?r.align.push("right"):this.rules.other.tableAlignCenter.test(l)?r.align.push("center"):this.rules.other.tableAlignLeft.test(l)?r.align.push("left"):r.align.push(null);for(let l=0;l<s.length;l++)r.header.push({text:s[l],tokens:this.lexer.inline(s[l]),header:!0,align:r.align[l]});for(const l of i)r.rows.push(Oe(l,r.header.length).map((o,p)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:r.align[p]})));return r}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const s=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:s,tokens:this.lexer.inline(s)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const s=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(s)){if(!this.rules.other.endAngleBracket.test(s))return;const r=K(s.slice(0,-1),"\\");if((s.length-r.length)%2===0)return}else{const r=Wt(t[2],"()");if(r>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let n=t[2],i="";if(this.options.pedantic){const r=this.rules.other.pedanticHrefTitle.exec(n);r&&(n=r[1],i=r[3])}else i=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(s)?n=n.slice(1):n=n.slice(1,-1)),Me(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let s;if((s=this.rules.inline.reflink.exec(e))||(s=this.rules.inline.nolink.exec(e))){const n=(s[2]||s[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=t[n.toLowerCase()];if(!i){const r=s[0].charAt(0);return{type:"text",raw:r,text:r}}return Me(s,i,s[0],this.lexer,this.rules)}}emStrong(e,t,s=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!n||n[3]&&s.match(this.rules.other.unicodeAlphaNumeric))return;if(!(n[1]||n[2]||"")||!s||this.rules.inline.punctuation.exec(s)){const r=[...n[0]].length-1;let a,l,o=r,p=0;const m=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(m.lastIndex=0,t=t.slice(-1*e.length+r);(n=m.exec(t))!=null;){if(a=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!a)continue;if(l=[...a].length,n[3]||n[4]){o+=l;continue}else if((n[5]||n[6])&&r%3&&!((r+l)%3)){p+=l;continue}if(o-=l,o>0)continue;l=Math.min(l,l+o+p);const d=[...n[0]][0].length,S=e.slice(0,r+n.index+d+l);if(Math.min(r,l)%2){const v=S.slice(1,-1);return{type:"em",raw:S,text:v,tokens:this.lexer.inlineTokens(v)}}const k=S.slice(2,-2);return{type:"strong",raw:S,text:k,tokens:this.lexer.inlineTokens(k)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let s=t[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(s),i=this.rules.other.startingSpaceChar.test(s)&&this.rules.other.endingSpaceChar.test(s);return n&&i&&(s=s.substring(1,s.length-1)),{type:"codespan",raw:t[0],text:s}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let s,n;return t[2]==="@"?(s=t[1],n="mailto:"+s):(s=t[1],n=s),{type:"link",raw:t[0],text:s,href:n,tokens:[{type:"text",raw:s,text:s}]}}}url(e){var s;let t;if(t=this.rules.inline.url.exec(e)){let n,i;if(t[2]==="@")n=t[0],i="mailto:"+n;else{let r;do r=t[0],t[0]=((s=this.rules.inline._backpedal.exec(t[0]))==null?void 0:s[0])??"";while(r!==t[0]);n=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const s=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:s}}}}class Q{constructor(e){x(this,"tokens");x(this,"options");x(this,"state");x(this,"tokenizer");x(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||V,this.options.tokenizer=this.options.tokenizer||new ue,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:I,block:re.normal,inline:W.normal};this.options.pedantic?(t.block=re.pedantic,t.inline=W.pedantic):this.options.gfm&&(t.block=re.gfm,this.options.breaks?t.inline=W.breaks:t.inline=W.gfm),this.tokenizer.rules=t}static get rules(){return{block:re,inline:W}}static lex(e,t){return new Q(t).lex(e)}static lexInline(e,t){return new Q(t).inlineTokens(e)}lex(e){e=e.replace(I.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const s=this.inlineQueue[t];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],s=!1){var n,i,r;for(this.options.pedantic&&(e=e.replace(I.tabCharGlobal,"    ").replace(I.spaceLine,""));e;){let a;if((i=(n=this.options.extensions)==null?void 0:n.block)!=null&&i.some(o=>(a=o.call({lexer:this},e,t))?(e=e.substring(a.raw.length),t.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);const o=t.at(-1);a.raw.length===1&&o!==void 0?o.raw+=`
`:t.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);const o=t.at(-1);(o==null?void 0:o.type)==="paragraph"||(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.at(-1).src=o.text):t.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);const o=t.at(-1);(o==null?void 0:o.type)==="paragraph"||(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.raw,this.inlineQueue.at(-1).src=o.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),t.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),t.push(a);continue}let l=e;if((r=this.options.extensions)!=null&&r.startBlock){let o=1/0;const p=e.slice(1);let m;this.options.extensions.startBlock.forEach(d=>{m=d.call({lexer:this},p),typeof m=="number"&&m>=0&&(o=Math.min(o,m))}),o<1/0&&o>=0&&(l=e.substring(0,o+1))}if(this.state.top&&(a=this.tokenizer.paragraph(l))){const o=t.at(-1);s&&(o==null?void 0:o.type)==="paragraph"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(a),s=l.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);const o=t.at(-1);(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(a);continue}if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var a,l,o;let s=e,n=null;if(this.tokens.links){const p=Object.keys(this.tokens.links);if(p.length>0)for(;(n=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)p.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(n=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,n.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(n=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)s=s.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,r="";for(;e;){i||(r=""),i=!1;let p;if((l=(a=this.options.extensions)==null?void 0:a.inline)!=null&&l.some(d=>(p=d.call({lexer:this},e,t))?(e=e.substring(p.raw.length),t.push(p),!0):!1))continue;if(p=this.tokenizer.escape(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.tag(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.link(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(p.raw.length);const d=t.at(-1);p.type==="text"&&(d==null?void 0:d.type)==="text"?(d.raw+=p.raw,d.text+=p.text):t.push(p);continue}if(p=this.tokenizer.emStrong(e,s,r)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.codespan(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.br(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.del(e)){e=e.substring(p.raw.length),t.push(p);continue}if(p=this.tokenizer.autolink(e)){e=e.substring(p.raw.length),t.push(p);continue}if(!this.state.inLink&&(p=this.tokenizer.url(e))){e=e.substring(p.raw.length),t.push(p);continue}let m=e;if((o=this.options.extensions)!=null&&o.startInline){let d=1/0;const S=e.slice(1);let k;this.options.extensions.startInline.forEach(v=>{k=v.call({lexer:this},S),typeof k=="number"&&k>=0&&(d=Math.min(d,k))}),d<1/0&&d>=0&&(m=e.substring(0,d+1))}if(p=this.tokenizer.inlineText(m)){e=e.substring(p.raw.length),p.raw.slice(-1)!=="_"&&(r=p.raw.slice(-1)),i=!0;const d=t.at(-1);(d==null?void 0:d.type)==="text"?(d.raw+=p.raw,d.text+=p.text):t.push(p);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return t}}class ce{constructor(e){x(this,"options");x(this,"parser");this.options=e||V}space(e){return""}code({text:e,lang:t,escaped:s}){var r;const n=(r=(t||"").match(I.notSpaceStart))==null?void 0:r[0],i=e.replace(I.endingNewline,"")+`
`;return n?'<pre><code class="language-'+O(n)+'">'+(s?i:O(i,!0))+`</code></pre>
`:"<pre><code>"+(s?i:O(i,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,s=e.start;let n="";for(let a=0;a<e.items.length;a++){const l=e.items[a];n+=this.listitem(l)}const i=t?"ol":"ul",r=t&&s!==1?' start="'+s+'"':"";return"<"+i+r+`>
`+n+"</"+i+`>
`}listitem(e){var s;let t="";if(e.task){const n=this.checkbox({checked:!!e.checked});e.loose?((s=e.tokens[0])==null?void 0:s.type)==="paragraph"?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=n+" "+O(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",s="";for(let i=0;i<e.header.length;i++)s+=this.tablecell(e.header[i]);t+=this.tablerow({text:s});let n="";for(let i=0;i<e.rows.length;i++){const r=e.rows[i];s="";for(let a=0;a<r.length;a++)s+=this.tablecell(r[a]);n+=this.tablerow({text:s})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),s=e.header?"th":"td";return(e.align?`<${s} align="${e.align}">`:`<${s}>`)+t+`</${s}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${O(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:s}){const n=this.parser.parseInline(s),i=Ne(e);if(i===null)return n;e=i;let r='<a href="'+e+'"';return t&&(r+=' title="'+O(t)+'"'),r+=">"+n+"</a>",r}image({href:e,title:t,text:s}){const n=Ne(e);if(n===null)return O(s);e=n;let i=`<img src="${e}" alt="${s}"`;return t&&(i+=` title="${O(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:O(e.text)}}class qe{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class R{constructor(e){x(this,"options");x(this,"renderer");x(this,"textRenderer");this.options=e||V,this.options.renderer=this.options.renderer||new ce,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new qe}static parse(e,t){return new R(t).parse(e)}static parseInline(e,t){return new R(t).parseInline(e)}parse(e,t=!0){var n,i;let s="";for(let r=0;r<e.length;r++){const a=e[r];if((i=(n=this.options.extensions)==null?void 0:n.renderers)!=null&&i[a.type]){const o=a,p=this.options.extensions.renderers[o.type].call({parser:this},o);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){s+=p||"";continue}}const l=a;switch(l.type){case"space":{s+=this.renderer.space(l);continue}case"hr":{s+=this.renderer.hr(l);continue}case"heading":{s+=this.renderer.heading(l);continue}case"code":{s+=this.renderer.code(l);continue}case"table":{s+=this.renderer.table(l);continue}case"blockquote":{s+=this.renderer.blockquote(l);continue}case"list":{s+=this.renderer.list(l);continue}case"html":{s+=this.renderer.html(l);continue}case"paragraph":{s+=this.renderer.paragraph(l);continue}case"text":{let o=l,p=this.renderer.text(o);for(;r+1<e.length&&e[r+1].type==="text";)o=e[++r],p+=`
`+this.renderer.text(o);t?s+=this.renderer.paragraph({type:"paragraph",raw:p,text:p,tokens:[{type:"text",raw:p,text:p,escaped:!0}]}):s+=p;continue}default:{const o='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return s}parseInline(e,t=this.renderer){var n,i;let s="";for(let r=0;r<e.length;r++){const a=e[r];if((i=(n=this.options.extensions)==null?void 0:n.renderers)!=null&&i[a.type]){const o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){s+=o||"";continue}}const l=a;switch(l.type){case"escape":{s+=t.text(l);break}case"html":{s+=t.html(l);break}case"link":{s+=t.link(l);break}case"image":{s+=t.image(l);break}case"strong":{s+=t.strong(l);break}case"em":{s+=t.em(l);break}case"codespan":{s+=t.codespan(l);break}case"br":{s+=t.br(l);break}case"del":{s+=t.del(l);break}case"text":{s+=t.text(l);break}default:{const o='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return s}}class se{constructor(e){x(this,"options");x(this,"block");this.options=e||V}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Q.lex:Q.lexInline}provideParser(){return this.block?R.parse:R.parseInline}}x(se,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class Xt{constructor(...e){x(this,"defaults",we());x(this,"options",this.setOptions);x(this,"parse",this.parseMarkdown(!0));x(this,"parseInline",this.parseMarkdown(!1));x(this,"Parser",R);x(this,"Renderer",ce);x(this,"TextRenderer",qe);x(this,"Lexer",Q);x(this,"Tokenizer",ue);x(this,"Hooks",se);this.use(...e)}walkTokens(e,t){var n,i;let s=[];for(const r of e)switch(s=s.concat(t.call(this,r)),r.type){case"table":{const a=r;for(const l of a.header)s=s.concat(this.walkTokens(l.tokens,t));for(const l of a.rows)for(const o of l)s=s.concat(this.walkTokens(o.tokens,t));break}case"list":{const a=r;s=s.concat(this.walkTokens(a.items,t));break}default:{const a=r;(i=(n=this.defaults.extensions)==null?void 0:n.childTokens)!=null&&i[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const o=a[l].flat(1/0);s=s.concat(this.walkTokens(o,t))}):a.tokens&&(s=s.concat(this.walkTokens(a.tokens,t)))}}return s}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(s=>{const n={...s};if(n.async=this.defaults.async||n.async||!1,s.extensions&&(s.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const r=t.renderers[i.name];r?t.renderers[i.name]=function(...a){let l=i.renderer.apply(this,a);return l===!1&&(l=r.apply(this,a)),l}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const r=t[i.level];r?r.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),n.extensions=t),s.renderer){const i=this.defaults.renderer||new ce(this.defaults);for(const r in s.renderer){if(!(r in i))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;const a=r,l=s.renderer[a],o=i[a];i[a]=(...p)=>{let m=l.apply(i,p);return m===!1&&(m=o.apply(i,p)),m||""}}n.renderer=i}if(s.tokenizer){const i=this.defaults.tokenizer||new ue(this.defaults);for(const r in s.tokenizer){if(!(r in i))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const a=r,l=s.tokenizer[a],o=i[a];i[a]=(...p)=>{let m=l.apply(i,p);return m===!1&&(m=o.apply(i,p)),m}}n.tokenizer=i}if(s.hooks){const i=this.defaults.hooks||new se;for(const r in s.hooks){if(!(r in i))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;const a=r,l=s.hooks[a],o=i[a];se.passThroughHooks.has(r)?i[a]=p=>{if(this.defaults.async)return Promise.resolve(l.call(i,p)).then(d=>o.call(i,d));const m=l.call(i,p);return o.call(i,m)}:i[a]=(...p)=>{let m=l.apply(i,p);return m===!1&&(m=o.apply(i,p)),m}}n.hooks=i}if(s.walkTokens){const i=this.defaults.walkTokens,r=s.walkTokens;n.walkTokens=function(a){let l=[];return l.push(r.call(this,a)),i&&(l=l.concat(i.call(this,a))),l}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Q.lex(e,t??this.defaults)}parser(e,t){return R.parse(e,t??this.defaults)}parseMarkdown(e){return(s,n)=>{const i={...n},r={...this.defaults,...i},a=this.onError(!!r.silent,!!r.async);if(this.defaults.async===!0&&i.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof s>"u"||s===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));r.hooks&&(r.hooks.options=r,r.hooks.block=e);const l=r.hooks?r.hooks.provideLexer():e?Q.lex:Q.lexInline,o=r.hooks?r.hooks.provideParser():e?R.parse:R.parseInline;if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(s):s).then(p=>l(p,r)).then(p=>r.hooks?r.hooks.processAllTokens(p):p).then(p=>r.walkTokens?Promise.all(this.walkTokens(p,r.walkTokens)).then(()=>p):p).then(p=>o(p,r)).then(p=>r.hooks?r.hooks.postprocess(p):p).catch(a);try{r.hooks&&(s=r.hooks.preprocess(s));let p=l(s,r);r.hooks&&(p=r.hooks.processAllTokens(p)),r.walkTokens&&this.walkTokens(p,r.walkTokens);let m=o(p,r);return r.hooks&&(m=r.hooks.postprocess(m)),m}catch(p){return a(p)}}}onError(e,t){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const n="<p>An error occurred:</p><pre>"+O(s.message+"",!0)+"</pre>";return t?Promise.resolve(n):n}if(t)return Promise.reject(s);throw s}}}const U=new Xt;function z(h,e){return U.parse(h,e)}z.options=z.setOptions=function(h){return U.setOptions(h),z.defaults=U.defaults,Fe(z.defaults),z};z.getDefaults=we;z.defaults=V;z.use=function(...h){return U.use(...h),z.defaults=U.defaults,Fe(z.defaults),z};z.walkTokens=function(h,e){return U.walkTokens(h,e)};z.parseInline=U.parseInline;z.Parser=R;z.parser=R.parse;z.Renderer=ce;z.TextRenderer=qe;z.Lexer=Q;z.lexer=Q.lex;z.Tokenizer=ue;z.Hooks=se;z.parse=z;z.options;z.setOptions;z.use;z.walkTokens;z.parseInline;R.parse;Q.lex;var tt=(h=>(h.NORMAL="normal",h.RANDOM="random",h.EXAM="exam",h.WRONG="wrong",h.REVIEW="review",h.RANGE="range",h))(tt||{}),Yt=(h=>(h.LOCAL="local",h.ONLINE_IMPORT="online-import",h.REMOTE_IMPORT="remote-import",h.ONLINE="online",h.REMOTE="remote",h))(Yt||{}),es=(h=>(h.CACHE="cache",h.ONLINE="online",h.REMOTE="remote",h))(es||{});const de="app_settings",ke={darkMode:window.matchMedia("(prefers-color-scheme: dark)").matches,themeColor:"default",customColor:"#4caf50",fontSize:14,fontFamily:"sans-serif",animationEnabled:!1,soundEffectsEnabled:!0,soundVolume:.5},st={autoSubmit:!1,autoNext:!1,allowSkip:!1,showNotesAfterAnswer:!1,lockAnswerAfterSubmit:!1,showCorrectAnswerImmediately:!1,showProgress:!1,swipeGestureEnabled:!1,randomMode:!1,reviewMode:!1,viewWrongAfterAll:!1,canEditQuestion:!1},G={enabled:!1,autoGenerate:!1,streamOutput:!1,autoSync:!1,apiUrl:"",apiKey:"",model:"",systemPrompt:"",temperature:.7,maxTokens:2e3,topP:1},nt={owner:"",repo:"",branch:"main",path:"",token:"",forceSync:!1,syncQuizName:"",createRemoteRepo:!1},X={uiSettings:ke,quizSettings:st,debugEnabled:!1,githubConfig:nt,lastSyncTimestamp:0,apiPresets:[Y(G)],activeApiPresetName:"Default"},fe={chapterIndex:"all",mode:"normal",rangeStart:1,rangeEnd:50,randomize:!1,wrongOnly:!1};function Y(h,e="Default"){const t={...G,...h};return{name:e,...t}}class ts{constructor(){x(this,"settings");x(this,"version","1.0");x(this,"listeners",new Map);x(this,"quizState",me({quizData:null,config:{...fe},lastLoaded:{name:"",source:""},stats:{totalAnswered:0,correctCount:0,wrongCount:0,dailyActivity:[0,0,0,0,0,0,0]}}));x(this,"state",lt(this.quizState));const e=this.loadSettings();this.settings=me(e),this.applyTheme(),this.initQuizFromStorage()}loadSettings(){try{const e=localStorage.getItem(de);if(e){const t=JSON.parse(e);return this.mergeWithDefaults(t)}return{...X}}catch(e){console.error("加载配置失败:",e);const t={...X};return(!t.apiPresets||t.apiPresets.length===0)&&(t.apiPresets=[Y(G)],t.activeApiPresetName="Default"),(!t.activeApiPresetName||!t.apiPresets.some(s=>s.name===t.activeApiPresetName))&&(t.activeApiPresetName=t.apiPresets[0].name),t}}mergeWithDefaults(e){var i;const t=e.apiPresets&&e.apiPresets.length>0?e.apiPresets.map(r=>({...G,...r})):[...X.apiPresets],s=e.activeApiPresetName&&t.some(r=>r.name===e.activeApiPresetName)?e.activeApiPresetName:((i=t[0])==null?void 0:i.name)||"Default";return{uiSettings:{...ke,...e.uiSettings},quizSettings:{...st,...e.quizSettings},debugEnabled:e.debugEnabled??X.debugEnabled,githubConfig:{...nt,...e.githubConfig},lastSyncTimestamp:e.lastSyncTimestamp??0,apiPresets:t,activeApiPresetName:s}}saveSettings(){try{localStorage.setItem(de,JSON.stringify(this.settings)),this.notifyListeners("settings")}catch(e){console.error("保存配置失败:",e),b("保存配置失败: "+e.message,"error")}}applyTheme(){const{darkMode:e,fontSize:t,fontFamily:s}=this.settings.uiSettings;document.documentElement.setAttribute("theme",e?"dark":"light"),document.documentElement.style.setProperty("--font-size",`${t}px`),document.documentElement.style.setProperty("--font-family",s)}addListener(e,t){var s;this.listeners.has(e)||this.listeners.set(e,[]),(s=this.listeners.get(e))==null||s.push(t)}removeListener(e,t){if(this.listeners.has(e)){const s=this.listeners.get(e),n=(s==null?void 0:s.indexOf(t))??-1;n!==-1&&s&&s.splice(n,1)}}notifyListeners(e){const t=this.listeners.get(e);t&&t.forEach(s=>s()),e!=="settings"&&this.notifyListeners("settings")}getSettings(){const e={...this.settings};return(!e.apiPresets||e.apiPresets.length===0)&&(e.apiPresets=[Y(G)],e.activeApiPresetName="Default"),(!e.activeApiPresetName||!e.apiPresets.some(t=>t.name===e.activeApiPresetName))&&(e.activeApiPresetName=e.apiPresets[0].name),e}getUiSettings(){return{...this.settings.uiSettings}}updateUiSettings(e,t=!0){Object.assign(this.settings.uiSettings,e),this.applyTheme(),t&&(this.saveSettings(),this.notifyListeners("ui"),b("界面设置已保存","success"))}toggleDarkMode(){const e=!this.settings.uiSettings.darkMode;this.updateUiSettings({darkMode:e})}setFontSize(e){this.updateUiSettings({fontSize:e})}getQuizSettings(){return{...this.settings.quizSettings}}updateQuizSettings(e,t=!0){Object.assign(this.settings.quizSettings,e),e.randomMode!==void 0&&(this.quizState.config.randomize=e.randomMode),(e.randomMode!==void 0||e.reviewMode!==void 0)&&(e.reviewMode?this.quizState.config.mode="review":e.randomMode?this.quizState.config.mode="random":this.quizState.config.mode="normal",this.saveQuizConfigToStorage()),t&&(this.saveSettings(),this.notifyListeners("quiz"),b("测验设置已保存","success"))}getApiConfig(){const e=this.settings.apiPresets.find(n=>n.name===this.settings.activeApiPresetName);if(!e){console.warn(`活动预设 "${this.settings.activeApiPresetName}" 未找到，返回第一个预设或默认。`);const n=this.settings.apiPresets[0]||Y(G),{name:i,...r}=n;return r}const{name:t,...s}=e;return s}updateApiConfig(e,t=!0){const s=this.settings.apiPresets.findIndex(n=>n.name===this.settings.activeApiPresetName);if(s===-1){console.error(`无法更新：活动预设 "${this.settings.activeApiPresetName}" 未找到。`),b("更新API配置失败：未找到活动预设","error");return}this.settings.apiPresets[s]={...this.settings.apiPresets[s],...e},this.saveSettings(),this.notifyListeners("api"),t&&b(`API预设 "${this.settings.activeApiPresetName}" 已保存`,"success")}getApiPresets(){return JSON.parse(JSON.stringify(this.settings.apiPresets))}getActiveApiPresetName(){return this.settings.activeApiPresetName}addApiPreset(e,t){if(!e||e.trim()==="")return b("预设名称不能为空","error"),!1;if(e=e.trim(),this.settings.apiPresets.some(i=>i.name===e))return b(`预设名称 "${e}" 已存在`,"error"),!1;const s=t||this.settings.activeApiPresetName,n=this.settings.apiPresets.find(i=>i.name===s);if(n){const i={...n,name:e};this.settings.apiPresets.push(i)}else{console.error(`无法复制配置：源预设 "${s}" 未找到。将使用默认配置创建。`);const i=Y({...G},e);this.settings.apiPresets.push(i)}return this.saveSettings(),this.notifyListeners("api"),b(`已添加预设 "${e}"`,"success"),!0}deleteApiPreset(e){if(this.settings.apiPresets.length<=1)return b("无法删除最后一个预设","warning"),!1;const t=this.settings.apiPresets.findIndex(s=>s.name===e);return t===-1?(b(`未找到要删除的预设 "${e}"`,"error"),!1):(this.settings.apiPresets.splice(t,1),this.settings.activeApiPresetName===e&&(this.settings.activeApiPresetName=this.settings.apiPresets[0].name,this.notifyListeners("api")),this.saveSettings(),this.notifyListeners("api"),b(`已删除预设 "${e}"`,"success"),!0)}setActiveApiPreset(e){return this.settings.apiPresets.some(s=>s.name===e)?(this.settings.activeApiPresetName!==e&&(this.settings.activeApiPresetName=e,this.saveSettings(),this.notifyListeners("api")),!0):(b(`未找到预设 "${e}"`,"error"),!1)}renameApiPreset(e,t){if(!t||t.trim()==="")return b("新预设名称不能为空","error"),!1;if(t=t.trim(),e===t)return!0;if(this.settings.apiPresets.some(n=>n.name===t))return b(`预设名称 "${t}" 已存在`,"error"),!1;const s=this.settings.apiPresets.findIndex(n=>n.name===e);return s===-1?(b(`未找到要重命名的预设 "${e}"`,"error"),!1):(this.settings.apiPresets[s].name=t,this.settings.activeApiPresetName===e&&(this.settings.activeApiPresetName=t),this.saveSettings(),this.notifyListeners("api"),b(`预设 "${e}" 已重命名为 "${t}"`,"success"),!0)}getGithubConfig(){return{...this.settings.githubConfig}}updateGithubConfig(e,t=!0){const s={owner:e.owner??this.settings.githubConfig.owner,repo:e.repo??this.settings.githubConfig.repo,branch:e.branch??this.settings.githubConfig.branch,path:e.path??this.settings.githubConfig.path,token:e.token??this.settings.githubConfig.token,forceSync:e.forceSync??this.settings.githubConfig.forceSync,syncQuizName:e.syncQuizName??this.settings.githubConfig.syncQuizName,createRemoteRepo:e.createRemoteRepo??this.settings.githubConfig.createRemoteRepo};this.settings.githubConfig=s,this.saveSettings(),this.settings.lastSyncTimestamp=Date.now(),this.notifyListeners("github"),t&&b("GitHub设置已保存","success")}getLastSyncTimestamp(){return this.settings.lastSyncTimestamp||0}updateSyncTimestamp(){this.settings.lastSyncTimestamp=Date.now(),this.saveSettings()}isDebugEnabled(){return!!this.settings.debugEnabled}setDebugEnabled(e,t=!0){this.settings.debugEnabled=e,t&&(this.saveSettings(),this.notifyListeners("settings"),b(e?"调试模式已启用":"调试模式已禁用","info"))}saveGeneralSettings(e){Object.assign(this.settings.uiSettings,e.uiSettings),Object.assign(this.settings.quizSettings,e.quizSettings),this.settings.debugEnabled=e.debugEnabled;const{randomMode:t,reviewMode:s}=e.quizSettings;s?this.quizState.config.mode="review":t?this.quizState.config.mode="random":this.quizState.config.mode="normal",this.quizState.config.randomize=t,this.saveSettings(),this.saveQuizConfigToStorage(),this.applyTheme(),this.notifyListeners("settings"),this.notifyListeners("ui"),this.notifyListeners("quiz"),b("通用设置已保存","success")}exportConfig(){try{const e={timestamp:new Date().toISOString(),version:this.version,exportDate:new Date().toISOString(),generalSettings:{uiSettings:this.settings.uiSettings,debugEnabled:this.settings.debugEnabled},quizSettings:this.settings.quizSettings,apiPresets:this.settings.apiPresets,activeApiPresetName:this.settings.activeApiPresetName,repoSettings:this.settings.githubConfig,stats:{}},t=localStorage.getItem("userStats");t&&(e.stats=JSON.parse(t),e.statisticsData=JSON.parse(t));const s=JSON.stringify(e,null,2),n="data:application/json;charset=utf-8,"+encodeURIComponent(s),i=`elyxira-config-${new Date().toISOString().split("T")[0]}.json`,r=document.createElement("a");return r.setAttribute("href",n),r.setAttribute("download",i),r.click(),b("配置已导出","success"),i}catch(e){throw console.error("导出配置失败:",e),b(`导出配置失败: ${e.message}`,"error"),e}}importConfig(e){try{if(!this.validateConfigData(e))return b("无效的配置文件格式或版本不兼容","error"),!1;const t=e,s={...this.settings};return t.generalSettings?(t.generalSettings.uiSettings&&(s.uiSettings={...ke,...this.settings.uiSettings,...t.generalSettings.uiSettings}),s.debugEnabled="debugEnabled"in t.generalSettings?!!t.generalSettings.debugEnabled:this.settings.debugEnabled):s.uiSettings={...this.settings.uiSettings},t.quizSettings&&(s.quizSettings={...this.settings.quizSettings,...t.quizSettings}),t.apiPresets&&Array.isArray(t.apiPresets)&&t.apiPresets.length>0&&(s.apiPresets=t.apiPresets.map(n=>{const i=typeof n.name=="string"&&n.name.trim()?n.name.trim():`Imported-${Date.now()}`;return{...G,...n,name:i}}),t.activeApiPresetName&&s.apiPresets.some(n=>n.name===t.activeApiPresetName)?s.activeApiPresetName=t.activeApiPresetName:s.activeApiPresetName=s.apiPresets[0].name),t.repoSettings&&(s.githubConfig={...this.settings.githubConfig,...t.repoSettings}),this.settings=s,this.saveSettings(),this.applyTheme(),(t.stats||t.statisticsData)&&localStorage.setItem("userStats",JSON.stringify(t.stats||t.statisticsData)),this.notifyListeners("settings"),this.notifyListeners("ui"),this.notifyListeners("quiz"),this.notifyListeners("api"),this.notifyListeners("github"),b("配置已成功导入","success"),!0}catch(t){return console.error("导入配置失败:",t),b("导入配置失败："+t.message,"error"),!1}}validateConfigData(e){if(!e||typeof e!="object")return!1;const t=e;return"timestamp"in t&&"version"in t&&typeof t.timestamp=="string"&&typeof t.version=="string"}resetAllSettings(){this.settings={...X},localStorage.removeItem(de),localStorage.removeItem("userStats"),localStorage.removeItem("quizStats"),localStorage.removeItem("quizData"),localStorage.removeItem("lastLoadedQuiz"),localStorage.removeItem("cachedQuizList"),this.saveSettings(),this.applyTheme(),this.quizState.quizData=null,this.quizState.config={...fe},this.quizState.lastLoaded={name:"",source:""},this.quizState.stats={totalAnswered:0,correctCount:0,wrongCount:0,dailyActivity:[0,0,0,0,0,0,0]},this.notifyListeners("settings"),this.notifyListeners("ui"),this.notifyListeners("quiz"),this.notifyListeners("api"),this.notifyListeners("github"),b("所有设置已重置为默认值","success")}clearQuizCache(){try{let e=0;for(let t=localStorage.length-1;t>=0;t--){const s=localStorage.key(t);s&&(s.startsWith("quizCache_")||s==="cachedQuizList")&&(localStorage.removeItem(s),e++)}return e>0?b(`已清除 ${e} 项题库缓存`,"success"):b("没有找到题库缓存","info"),e>0}catch(e){return console.error("清除题库缓存失败:",e),b(`清除缓存失败: ${e.message}`,"error"),!1}}getCacheStats(){let e=0;const t=[];for(let s=0;s<localStorage.length;s++){const n=localStorage.key(s);if(n){const i=localStorage.getItem(n)||"",r=(n.length+i.length)*2;e+=r,n.startsWith("quizCache_")&&t.push({key:n.replace("quizCache_",""),size:r})}}return{totalSize:e,items:t}}saveQuizToStorage(e,t){const s=`quizCache_${e}`;localStorage.setItem(s,JSON.stringify(t))}loadQuizFromStorage(e){const t=`quizCache_${e}`,s=localStorage.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(n){return console.error(`解析缓存题库失败: ${e}`,n),null}}removeQuizFromStorage(e){const t=`quizCache_${e}`;localStorage.removeItem(t)}saveQuizList(e){localStorage.setItem("cachedQuizList",JSON.stringify(e))}loadQuizList(){const e=localStorage.getItem("cachedQuizList");if(!e)return[];try{return JSON.parse(e)}catch(t){return console.error("解析题库列表失败",t),[]}}saveLastLoadedQuiz(e,t){this.quizState.lastLoaded.name=e,this.quizState.lastLoaded.source=t,localStorage.setItem("lastLoadedQuiz",JSON.stringify({name:e,source:t}))}getLastLoadedQuiz(){if(this.quizState.lastLoaded.name)return{...this.quizState.lastLoaded};const e=localStorage.getItem("lastLoadedQuiz");if(!e)return null;try{return JSON.parse(e)}catch{return null}}clearAllQuizStorage(){this.loadQuizList().forEach(t=>{const s=`quizCache_${t.name}`;localStorage.removeItem(s)}),localStorage.removeItem("cachedQuizList"),localStorage.removeItem("lastLoadedQuiz"),localStorage.removeItem("quizData"),this.quizState.quizData=null,this.quizState.lastLoaded={name:"",source:""},this.quizState.config={...fe},b("已清除所有题库缓存","success")}getQuizData(){return this.quizState.quizData}setQuizData(e){this.quizState.quizData=e}getQuizConfig(){return{...this.quizState.config}}setQuizConfig(e){this.quizState.config={...this.quizState.config,...e},this.saveQuizConfigToStorage()}saveQuizConfigToStorage(){localStorage.setItem("selectedChapter",this.quizState.config.chapterIndex),localStorage.setItem("quizMode",this.quizState.config.mode),localStorage.setItem("rangeStart",this.quizState.config.rangeStart.toString()),localStorage.setItem("rangeEnd",this.quizState.config.rangeEnd.toString())}initQuizFromStorage(){try{const e=localStorage.getItem("quizData");if(e)this.quizState.quizData=JSON.parse(e);else return!1;const t=localStorage.getItem("lastLoadedQuiz");t&&(this.quizState.lastLoaded=JSON.parse(t));const s=localStorage.getItem("selectedChapter");s&&(this.quizState.config.chapterIndex=s);const n=localStorage.getItem("quizMode");n&&Object.values(tt).includes(n)&&(this.quizState.config.mode=n);const i=localStorage.getItem("rangeStart");i&&(this.quizState.config.rangeStart=parseInt(i));const r=localStorage.getItem("rangeEnd");return r&&(this.quizState.config.rangeEnd=parseInt(r)),this.loadQuizStatsFromStorage(),!0}catch(e){return console.error("从本地存储恢复状态失败:",e),!1}}saveQuizState(){this.quizState.quizData&&(localStorage.setItem("quizData",JSON.stringify(this.quizState.quizData)),this.saveQuizConfigToStorage(),localStorage.setItem("lastLoadedQuiz",JSON.stringify(this.quizState.lastLoaded)),this.quizState.lastLoaded.name&&this.saveQuizToStorage(this.quizState.lastLoaded.name,this.quizState.quizData))}loadQuizStatsFromStorage(){try{const e=localStorage.getItem("quizStats");if(e){const t=JSON.parse(e);this.quizState.stats={...this.quizState.stats,...t}}}catch(e){console.error("加载统计数据失败:",e)}}saveQuizStatsToStorage(){localStorage.setItem("quizStats",JSON.stringify(this.quizState.stats))}updateQuizStats(e){e.totalAnswered!==void 0&&(this.quizState.stats.totalAnswered=e.totalAnswered),e.correctCount!==void 0&&(this.quizState.stats.correctCount=e.correctCount),e.wrongCount!==void 0&&(this.quizState.stats.wrongCount=e.wrongCount);const t=new Date().getDay();this.quizState.stats.dailyActivity[t]++,this.saveQuizStatsToStorage()}getQuizChapters(){return!this.quizState.quizData||!this.quizState.quizData.chapters?[]:this.quizState.quizData.chapters.map(e=>e.title)}getQuizTotalQuestions(){return!this.quizState.quizData||!this.quizState.quizData.chapters?0:this.quizState.quizData.chapters.reduce((e,t)=>{var s;return e+(((s=t.questions)==null?void 0:s.length)||0)},0)}getQuizAnsweredCount(){return this.quizState.stats.totalAnswered}getQuizCorrectCount(){return this.quizState.stats.correctCount}getQuizAccuracyRate(){const e=this.quizState.stats.totalAnswered;return e===0?"0%":Math.round(this.quizState.stats.correctCount/e*100)+"%"}clearCurrentQuiz(){this.quizState.quizData=null,this.quizState.lastLoaded={name:"",source:""},localStorage.removeItem("quizData"),localStorage.removeItem("lastLoadedQuiz")}async syncQuizFromGithub(e){try{const t=this.getGithubConfig();if(!this.validateGithubConfig(t))return b("GitHub配置不完整","error"),null;const s=t.path||"quizzes",n=`https://api.github.com/repos/${t.owner}/${t.repo}/contents/${s}?ref=${t.branch}`,i=await fetch(n,{headers:{Authorization:`token ${t.token}`,Accept:"application/vnd.github.v3+json"}});if(!i.ok)return b(`获取远程题库列表失败 (${i.status})`,"error"),null;const r=await i.json(),a=Array.isArray(r)?r.filter(c=>c.type==="file"&&(c.name.endsWith(".json")||c.name.endsWith(".txt"))):[];if(a.length===0)return b("远程仓库中未找到任何题库文件","error"),null;let l=a.find(c=>c.name===`${e}.json`||c.name===`${e}.txt`);if(l||(l=a.find(c=>c.name.toLowerCase().includes(e.toLowerCase()))),!l){if(b(`远程仓库中未找到匹配的题库：${e}`,"error"),a.length>0){const c=a.map(f=>f.name.replace(/\.(json|txt)$/,"")).join(", ");console.info(`远程仓库中可用的题库: ${c}`)}return null}const o=await fetch(l.download_url);if(!o.ok)return b("下载题库内容失败","error"),null;const p=l.name.replace(/\.(json|txt)$/,""),m=await o.text();let d;try{const c=JSON.parse(m);d=oe.parse(c,p)}catch{return b("解析题库数据失败：无效的JSON格式","error"),null}if(!this.enhancedValidQuizData(d))return b("无效的题库数据格式","error"),null;const S=this.loadQuizFromStorage(p);S&&(console.log(`合并本地题库笔记: ${p}`),S.chapters.forEach(c=>{c.questions.forEach(f=>{f.id&&(f.notes||f.userAnswer!==void 0)&&d.chapters.forEach(J=>{const N=J.questions.find(y=>y.id===f.id);N&&(f.notes&&(!N.notes||N.notes.trim()==="")&&(console.log(`保留本地笔记: 题目ID=${f.id}, 笔记长度=${f.notes.length}`),N.notes=f.notes),f.userAnswer!==void 0&&(N.userAnswer=f.userAnswer))})})})),this.saveQuizToStorage(p,d);const k=this.loadQuizList(),v=k.findIndex(c=>c.name===p&&c.source==="remote-import"),w={id:`remote-import-${Date.now()}`,name:p,path:"localStorage",source:"remote-import",info:`从GitHub同步：${t.owner}/${t.repo}`,title:d.title||p,lastModified:Date.now(),data:d};return v>=0?k[v]=w:k.push(w),this.saveQuizList(k),this.updateSyncTimestamp(),b(`成功从GitHub同步题库：${p}`,"success"),d}catch(t){return b(`同步题库失败：${t.message}`,"error"),null}}async pushQuizToGithub(e,t){try{const s=this.getGithubConfig();if(!this.validateGithubConfig(s))return b("GitHub配置不完整","error"),!1;const n=this.loadQuizFromStorage(e);if(!n)return b(`本地未找到题库：${e}`,"error"),!1;if(this.quizState.quizData&&this.quizState.quizData.title===n.title&&(this.quizState.quizData.chapters.forEach(S=>{S.questions.forEach(k=>{k.id&&(k.notes||k.userAnswer!==void 0)&&n.chapters.forEach(v=>{const w=v.questions.find(c=>c.id===k.id);w&&(k.notes&&(console.log(`更新推送题库笔记: 题目ID=${k.id}, 笔记长度=${k.notes.length}`),w.notes=k.notes),k.userAnswer!==void 0&&(w.userAnswer=k.userAnswer))})})}),this.saveQuizToStorage(e,n)),!this.enhancedValidQuizData(n)){console.warn("题库数据格式可能有问题，尝试标准化...");try{const d=oe.parse(n,e);this.saveQuizToStorage(e,d)}catch(d){return b(`题库数据格式错误: ${d.message}`,"error"),!1}}const i=`${s.path||"quizzes"}/${e}.json`,r=`https://api.github.com/repos/${s.owner}/${s.repo}/contents/${i}`;let a=null;try{const d=await fetch(`${r}?ref=${s.branch}`,{headers:{Authorization:`token ${s.token}`,Accept:"application/vnd.github.v3+json"}});d.ok&&(a=(await d.json()).sha)}catch{}const l=JSON.stringify(n,null,2),o=btoa(unescape(encodeURIComponent(l))),p={message:a?`更新题库：${e}`:`添加题库：${e}`,content:o,branch:s.branch};a&&(p.sha=a);const m=await fetch(r,{method:"PUT",headers:{Authorization:`token ${s.token}`,"Content-Type":"application/json",Accept:"application/vnd.github.v3+json"},body:JSON.stringify(p)});if(!m.ok){const d=await m.json();throw new Error(`GitHub API错误 (${m.status}): ${d.message||"未知错误"}`)}return this.updateSyncTimestamp(),b(`成功推送题库到GitHub：${e}`,"success"),!0}catch(s){return b(`推送题库失败：${s.message}`,"error"),!1}}validateGithubConfig(e){return!!(e.owner&&e.repo&&e.token&&e.branch)}validateQuizData(e){if(!e||typeof e!="object")return!1;const t=e;if(!Array.isArray(t.chapters))return!1;for(const s of t.chapters){if(typeof s!="object"||typeof s.title!="string"||!Array.isArray(s.questions))return!1;for(const n of s.questions)if(typeof n!="object"||typeof n.title!="string"||!Array.isArray(n.options)||n.answer===void 0)return!1}return!0}async handleQuizSyncComplete(e){if(!e.success||e.action!=="pull")return null;const t=e.quiz,s=this.loadQuizFromStorage(t);if(!s)return b(`找不到拉取的题库数据: ${t}`,"error"),null;const n=this.loadQuizList(),i={id:`remote-import-${Date.now()}`,name:t,path:"localStorage",source:"remote-import",info:`从远程导入: ${t}`,title:s.title||t,lastModified:Date.now(),data:s},r=n.findIndex(o=>o.name===t&&(o.source==="local"||o.source==="remote-import"||o.source==="online-import")),a=r<0;let l=!1;return r>=0&&e.overrideLocal?(n[r]=i,l=!0):r<0&&(n.push(i),l=!0),this.saveQuizList(n),(a||l)&&e.overrideLocal&&(this.setQuizData(s),this.saveLastLoadedQuiz(t,"remote-import"),this.setQuizConfig({chapterIndex:"all",mode:"normal",rangeStart:1,rangeEnd:this.calculateTotalQuestions(s),randomize:!1,wrongOnly:!1}),this.saveQuizState()),{quizName:t,source:"remote-import",wasOverridden:l,isNewQuiz:a,data:s}}calculateTotalQuestions(e){let t=0;return e&&e.chapters&&e.chapters.forEach(s=>{s.questions&&Array.isArray(s.questions)&&(t+=s.questions.length)}),t>0?t:100}saveNoteToQuestion(e,t){if(!this.quizState.quizData||!e)return!1;const s=this.findQuestionById(e);return s?(s.notes=t,this.saveQuizToStorage(this.quizState.quizData.title,this.quizState.quizData),!0):!1}getNoteByQuestionId(e){if(!e)return"";const t=this.findQuestionById(e);return(t==null?void 0:t.notes)||""}async renderNote(e,t,s){const n=e||"";if(!n&&!t)return{contentHtml:'<p class="page-quiz__notes-placeholder">这道题目还没有笔记...</p>'};let i=n?await s.parse(n):"";return i||(i=t?'<p class="page-quiz__notes-placeholder">思考中...</p>':'<p class="page-quiz__notes-placeholder">这道题目还没有笔记...</p>'),{contentHtml:i}}findQuestionById(e){if(!(!this.quizState.quizData||!e))for(const t of this.quizState.quizData.chapters){const s=t.questions.find(n=>n.id===e);if(s)return s}}formatNote(e){return e.trim()}getNotesGenerationRequestParams(e){const t=this.getApiConfig(),s=t.model||"",n=t.temperature||.7,i=t.maxTokens||2e3,r=t.topP||1,a=t.systemPrompt||"";let l=`<question>
${e.title}

`;if(e.options&&e.options.length>0&&e.options.forEach((m,d)=>{const S=String.fromCharCode(65+d);l+=`${S}. ${m}
`}),e.answer!==void 0){let m="";Array.isArray(e.answer)?m=e.answer.map(d=>typeof d=="number"?String.fromCharCode(65+d):d).join(", "):typeof e.answer=="number"?m=String.fromCharCode(65+e.answer):m=e.answer,l+=`
正确答案: ${m}`}return e.explanation&&(l+=`
解析: ${e.explanation}`),l+=`
</question>
请严格根据提示词生成本题的笔记内容。`,{model:s,messages:[{role:"system",content:a},{role:"user",content:l}],max_tokens:i,temperature:n,top_p:r,stream:t.streamOutput??!1,user:"elyxira-quiz-user"}}parseTextQuiz(e){const t=e.split(`
`).filter(a=>a.trim()),s=t[0]||"未命名题库",n=[];let i={title:"默认章节",questions:[]},r=null;for(let a=1;a<t.length;a++){const l=t[a].trim();if(l.startsWith("## "))i.questions.length>0&&n.push(i),i={title:l.substring(3),questions:[]},r=null;else if(l.match(/^\d+\./))r&&i.questions.push(r),r={id:`q-${Date.now()}-${Math.random().toString(36).slice(2)}`,title:l.substring(l.indexOf(".")+1).trim(),options:[],answer:0,explanation:""};else if(l.startsWith("- ")&&r)r.options.push(l.substring(2).trim());else if(l.startsWith("答案:")&&r){const o=l.substring(3).trim();r.answer=parseInt(o)-1||0}else l.startsWith("解析:")&&r&&(r.explanation=l.substring(3).trim())}return r&&i.questions.push(r),i.questions.length>0&&n.push(i),{title:s,chapters:n,description:"从文本导入",lastModified:Date.now()}}enhancedValidQuizData(e){try{const t=oe.parse(e);return!t||!Array.isArray(t.chapters)||t.chapters.length===0?(console.error("验证失败: 解析后数据缺少有效章节"),!1):(t.chapters.some(n=>Array.isArray(n.questions)&&n.questions.length>0)||console.warn("解析后数据中没有题目"),!0)}catch(t){return console.error("题库数据验证失败:",t),!1}}async importConfigFromFile(e){return new Promise((t,s)=>{const n=new FileReader;n.onload=i=>{try{if(i.target&&typeof i.target.result=="string"){const r=JSON.parse(i.target.result);this.importConfig(r)?t(!0):s(new Error("Invalid config file format or content."))}else s(new Error("Failed to read file content."))}catch(r){console.error("Error parsing config file:",r),s(new Error("Failed to parse config file. Ensure it is valid JSON."))}},n.onerror=i=>{console.error("Error reading file:",i),s(new Error("Failed to read the selected file."))},n.readAsText(e)})}updateQuestion(e,t){if(!this.quizState.quizData||!e)return!1;for(const s of this.quizState.quizData.chapters){const n=s.questions.findIndex(i=>i.id===e);if(n!==-1)return s.questions[n]={...s.questions[n],...t,id:s.questions[n].id||e.toString()},this.saveQuizState(),!0}return console.warn(`未找到要更新的问题，ID: ${e}`),!1}}const C=new ts,ss={class:"modal__header"},ns={class:"modal__title"},is={class:"modal__body"},rs={key:0,class:"modal__footer"},ae=pe({__name:"modal-base",props:{show:Boolean,title:{type:String,default:"提示"},contentClass:{type:String,default:""}},emits:["close"],setup(h){return(e,t)=>h.show?(T(),E("div",{key:0,class:"modal modal--active",onClick:t[1]||(t[1]=ut(s=>e.$emit("close"),["self"]))},[u("div",{class:be(["modal__content",h.contentClass])},[u("div",ss,[u("h2",ns,D(h.title),1),u("button",{class:"modal__close",onClick:t[0]||(t[0]=s=>e.$emit("close")),title:"关闭"},"×")]),u("div",is,[Ie(e.$slots,"default")]),e.$slots.footer?(T(),E("div",rs,[Ie(e.$slots,"footer")])):F("",!0)],2)])):F("",!0)}}),os={class:"modal__section"},as={key:0,class:"modal__info-message"},ls={key:1,class:"modal__info-grid"},us={class:"modal__info-item"},cs={class:"modal__info-value"},ps={class:"modal__info-item"},hs={class:"modal__info-value"},gs={class:"modal__section"},ds={class:"modal__form-group"},fs={key:0,class:"modal__form-group modal__form-group--switch"},ms={class:"modal__toggle-switch"},bs={key:1,class:"modal__form-description"},Ss={class:"modal__form-group modal__form-group--switch"},ys={class:"modal__toggle-switch"},ks={class:"modal__form-actions"},ws=["disabled"],vs=["disabled"],xs={class:"modal__form-group"},_s={class:"modal__form-group"},zs={class:"modal__form-group"},$s={class:"modal__form-group"},As={class:"modal__form-group"},Cs={class:"modal__form-actions"},qs=["disabled"],Ps=["disabled"],zn=pe({__name:"modal-quiz-sync",props:{show:{type:Boolean,default:!1},currentQuiz:{type:Object,default:()=>({name:"",source:"",isLocal:!0,exists:!1})}},emits:["close","sync-complete","save"],setup(h,{emit:e}){const t=e,s=h,n={local:"本地题库",online:"在线题库",remote:"远程题库","online-import":"从在线导入","remote-import":"从远程导入"},i=M({owner:"",repo:"",branch:"main",path:"",token:"",forceSync:!0}),r=M(!1),a=M(""),l=M(""),o=M(!1),p=M(!0);function m(y){return y?`syncName_${y}`:null}const d=()=>{var g;const y=C.getGithubConfig();if(i.value={...y},p.value=!!y.forceSync,o.value=!!y.createRemoteRepo,(g=s.currentQuiz)!=null&&g.exists&&s.currentQuiz.name){const A=m(s.currentQuiz.name);A?l.value=localStorage.getItem(A)||s.currentQuiz.name||y.syncQuizName||"":l.value=s.currentQuiz.name||y.syncQuizName||""}else l.value=y.syncQuizName||""};Be(()=>{v(),C.addListener("github",d)}),Ge(()=>{C.removeListener("github",d)}),Se(()=>s.currentQuiz,y=>{if(y!=null&&y.exists&&y.name){const g=m(y.name),A=g?localStorage.getItem(g):null;l.value=A||y.name||C.getGithubConfig().syncQuizName||""}else l.value=C.getGithubConfig().syncQuizName||""},{immediate:!0,deep:!0}),Se(()=>s.show,y=>{y&&v()},{immediate:!0});const S=je(()=>!!i.value.owner&&!!i.value.repo);function k(y){if(!y)return"未知来源";const g=y.toLowerCase();return n[g]||y||"未知来源"}function v(){var g;const y=C.getGithubConfig();if(i.value={...y},p.value=!!y.forceSync,o.value=!!y.createRemoteRepo,(g=s.currentQuiz)!=null&&g.exists&&s.currentQuiz.name){const A=m(s.currentQuiz.name),L=A?localStorage.getItem(A):null;l.value=L||s.currentQuiz.name||y.syncQuizName||""}else l.value=y.syncQuizName||""}async function w(){if(!S.value){b("请填写必要的配置信息","error");return}r.value=!0,a.value="test";try{const{owner:y,repo:g,branch:A,path:L,token:H}=i.value,Z={};H&&(Z.Authorization=`token ${H}`);const q=`https://api.github.com/repos/${y}/${g}/contents/${L}?ref=${A}`,ie=await fetch(q,{headers:Z});if(!ie.ok){const it=await ie.json();throw new Error(`GitHub API错误 (${ie.status}): ${it.message||"未知错误"}`)}const Pe=await ie.json();Array.isArray(Pe)?b(`成功连接到仓库，发现 ${Pe.length} 个文件`,"success"):b("连接成功，但路径不是一个目录","warning")}catch(y){b(`连接失败: ${y.message}`,"error")}finally{r.value=!1,a.value=""}}function c(){f(),t("close")}function f(){var g;if(!S.value)return;if((g=s.currentQuiz)!=null&&g.exists&&s.currentQuiz.name){const A=m(s.currentQuiz.name);A&&l.value?localStorage.setItem(A,l.value):A&&localStorage.removeItem(A)}const y={...i.value,forceSync:p.value,syncQuizName:l.value,createRemoteRepo:o.value};C.updateGithubConfig(y),t("save",y)}async function J(){if(!S.value){b("请填写必要的配置信息","error");return}if(!l.value){b("请填写同步题库名称","error");return}r.value=!0,a.value="push";try{f(),await C.pushQuizToGithub(l.value,p.value)?(b(`成功推送题库: ${l.value}`,"success"),t("sync-complete",{action:"push",quiz:l.value,success:!0})):b("推送题库失败","error")}catch(y){b(`推送题库失败: ${y.message}`,"error")}finally{r.value=!1,a.value=""}}async function N(){if(!S.value){b("请填写必要的配置信息","error");return}if(!l.value){b("请填写同步题库名称","error");return}r.value=!0,a.value="pull";try{f();const y=await C.syncQuizFromGithub(l.value);y?(C.saveQuizToStorage(l.value,y),b(`成功拉取题库: ${l.value}`,"success"),t("sync-complete",{action:"pull",quiz:l.value,overrideLocal:!0,success:!0,retainedNotes:!0}),setTimeout(()=>{t("close")},1500)):b("拉取题库失败","error")}catch(y){b(`拉取题库失败: ${y.message}`,"error")}finally{r.value=!1,a.value=""}}return(y,g)=>(T(),ct(ae,{title:"仓库配置",show:h.show,onClose:g[9]||(g[9]=A=>y.$emit("close"))},{footer:j(()=>[u("button",{class:"modal__button modal__button--secondary",onClick:g[8]||(g[8]=A=>y.$emit("close"))},"取消"),u("button",{class:"modal__button modal__button--primary",onClick:c,disabled:!S.value},"保存配置",8,Ps)]),default:j(()=>{var A,L,H,Z;return[u("div",os,[g[12]||(g[12]=u("h3",{class:"modal__section-title"},"当前题库信息",-1)),(A=h.currentQuiz)!=null&&A.exists?(T(),E("div",ls,[u("div",us,[g[10]||(g[10]=u("span",{class:"modal__info-label"},"题库名称:",-1)),u("span",cs,D(h.currentQuiz.name||"未命名题库"),1)]),u("div",ps,[g[11]||(g[11]=u("span",{class:"modal__info-label"},"来源类型:",-1)),u("span",hs,D(k(h.currentQuiz.source)),1)])])):(T(),E("div",as," 未处于刷题页面或未加载题库。 "))]),g[27]||(g[27]=u("div",{class:"modal__separator"},null,-1)),u("div",gs,[g[19]||(g[19]=u("h3",{class:"modal__section-title"},"题库同步",-1)),u("div",ds,[g[13]||(g[13]=u("label",{for:"syncQuizName",class:"modal__form-label"},"同步题库名称",-1)),g[14]||(g[14]=u("div",{class:"modal__form-description"},"与GitHub仓库进行同步操作时使用的文件名",-1)),$(u("input",{type:"text",id:"syncQuizName","onUpdate:modelValue":g[0]||(g[0]=q=>l.value=q),placeholder:"例如: my-quiz",class:"modal__form-control"},null,512),[[B,l.value]])]),(L=h.currentQuiz)!=null&&L.isLocal?(T(),E("div",fs,[g[16]||(g[16]=u("label",{class:"modal__form-label"},"创建远程版本",-1)),u("label",ms,[$(u("input",{type:"checkbox","onUpdate:modelValue":g[1]||(g[1]=q=>o.value=q)},null,512),[[P,o.value]]),g[15]||(g[15]=u("span",{class:"modal__toggle-slider"},null,-1))])])):F("",!0),(H=h.currentQuiz)!=null&&H.isLocal?(T(),E("div",bs,"推送时若远程不存在，则创建新文件")):F("",!0),u("div",Ss,[g[18]||(g[18]=u("label",{class:"modal__form-label"},"覆盖同名题库",-1)),u("label",ys,[$(u("input",{type:"checkbox","onUpdate:modelValue":g[2]||(g[2]=q=>p.value=q)},null,512),[[P,p.value]]),g[17]||(g[17]=u("span",{class:"modal__toggle-slider"},null,-1))])]),g[20]||(g[20]=u("div",{class:"modal__form-description"},"同步时覆盖已存在的题库（推送时覆盖远程，拉取时覆盖本地）",-1)),u("div",ks,[u("button",{class:"modal__button modal__button--primary",onClick:N,disabled:r.value||!l.value},[ee(Le,{name:"download",size:"16"}),Te(" "+D(r.value&&a.value==="pull"?"拉取中...":"从GitHub拉取"),1)],8,ws),(Z=h.currentQuiz)!=null&&Z.exists?(T(),E("button",{key:0,class:"modal__button modal__button--success",onClick:J,disabled:r.value||!S.value||!l.value},[ee(Le,{name:"upload",size:"16"}),Te(" "+D(r.value&&a.value==="push"?"推送中...":"推送到GitHub"),1)],8,vs)):F("",!0)])]),g[28]||(g[28]=u("div",{class:"modal__separator"},null,-1)),g[29]||(g[29]=u("h3",{class:"modal__section-title"},"GitHub 仓库设置",-1)),u("div",xs,[g[21]||(g[21]=u("label",{for:"githubOwner",class:"modal__form-label"},"GitHub 用户名或组织",-1)),$(u("input",{type:"text",id:"githubOwner","onUpdate:modelValue":g[3]||(g[3]=q=>i.value.owner=q),placeholder:"例如: username",class:"modal__form-control"},null,512),[[B,i.value.owner]])]),u("div",_s,[g[22]||(g[22]=u("label",{for:"githubRepo",class:"modal__form-label"},"仓库名称",-1)),$(u("input",{type:"text",id:"githubRepo","onUpdate:modelValue":g[4]||(g[4]=q=>i.value.repo=q),placeholder:"例如: quiz-data",class:"modal__form-control"},null,512),[[B,i.value.repo]])]),u("div",zs,[g[23]||(g[23]=u("label",{for:"githubBranch",class:"modal__form-label"},"分支名称",-1)),$(u("input",{type:"text",id:"githubBranch","onUpdate:modelValue":g[5]||(g[5]=q=>i.value.branch=q),placeholder:"例如: main",class:"modal__form-control"},null,512),[[B,i.value.branch]])]),u("div",$s,[g[24]||(g[24]=u("label",{for:"githubPath",class:"modal__form-label"},"仓库路径 (可选)",-1)),$(u("input",{type:"text",id:"githubPath","onUpdate:modelValue":g[6]||(g[6]=q=>i.value.path=q),placeholder:"例如: quizzes/",class:"modal__form-control"},null,512),[[B,i.value.path]])]),u("div",As,[g[25]||(g[25]=u("label",{for:"githubToken",class:"modal__form-label"},"个人访问令牌 (PAT)",-1)),g[26]||(g[26]=u("div",{class:"modal__form-description"},"用于读写私有仓库或进行推送操作",-1)),$(u("input",{type:"password",id:"githubToken","onUpdate:modelValue":g[7]||(g[7]=q=>i.value.token=q),placeholder:"ghp_xxxxxx",class:"modal__form-control"},null,512),[[B,i.value.token]])]),u("div",Cs,[u("button",{class:"modal__button modal__button--primary",onClick:w,disabled:r.value},D(r.value&&a.value==="test"?"测试中...":"测试连接"),9,qs)])]}),_:1},8,["show"]))}}),Is={class:"modal__settings-tabs"},Ts={key:0,class:"modal__tab-container"},Es={class:"modal__settings-group"},Ls={class:"modal__setting-item"},Qs={class:"modal__toggle-switch"},Rs={class:"modal__setting-item"},Ds={class:"modal__toggle-switch"},Ns={class:"modal__settings-group"},Os={class:"modal__setting-item"},Ms={class:"modal__toggle-switch"},js={class:"modal__setting-item"},Bs={class:"modal__toggle-switch"},Gs={class:"modal__setting-item"},Fs={class:"modal__toggle-switch"},Us={class:"modal__setting-item"},Vs={class:"modal__toggle-switch"},Js={class:"modal__settings-group"},Hs={class:"modal__setting-item"},Zs={class:"modal__toggle-switch"},Ws={class:"modal__setting-item"},Ks={class:"modal__toggle-switch"},Xs={class:"modal__settings-group"},Ys={class:"modal__setting-item"},en={class:"modal__toggle-switch"},tn={class:"modal__setting-item"},sn={class:"modal__toggle-switch"},nn={key:1,class:"modal__tab-container"},rn={class:"modal__settings-group"},on={class:"modal__setting-item"},an={class:"modal__form-input-group"},ln={class:"modal__setting-item"},un=["value"],cn={class:"modal__setting-item"},pn={class:"modal__toggle-switch"},hn={class:"modal__settings-group"},gn={class:"modal__setting-item"},dn={class:"modal__toggle-switch"},fn={class:"modal__setting-item"},mn={class:"modal__form-input-group"},bn={class:"modal__settings-group"},Sn={class:"modal__setting-item"},yn={class:"modal__toggle-switch"},kn={class:"modal__body"},wn={class:"modal__body"},$n=pe({__name:"modal-settings",props:{show:{type:Boolean},currentSettings:{}},emits:["close","save"],setup(h,{emit:e}){const t=[{name:"系统默认 (sans-serif)",value:"sans-serif"},{name:"系统默认 (serif)",value:"serif"},{name:"系统默认 (monospace)",value:"monospace"},{name:"苹方 (PingFang SC)",value:"'PingFang SC', sans-serif"},{name:"微软雅黑 (Microsoft YaHei)",value:"'Microsoft YaHei', sans-serif"},{name:"思源黑体 (Noto Sans SC)",value:"'Noto Sans SC', sans-serif"},{name:"霞鹜文楷 (LXGW WenKai)",value:"'LXGW WenKai', cursive"},{name:"JetBrains Mono",value:"'JetBrains Mono', monospace"},{name:"Fira Code",value:"'Fira Code', monospace"},{name:"IBM Plex Sans",value:"'IBM Plex Sans', sans-serif"},{name:"Roboto Mono",value:"'Roboto Mono', monospace"},{name:"更纱黑体 (Sarasa Gothic)",value:"'Sarasa Gothic SC', sans-serif"}],s=h,n=e,i=M("quiz"),r=M(!1),a=M(!1),l=M(""),o=me({uiSettings:{...C.getUiSettings()},quizSettings:{...C.getQuizSettings()},debugEnabled:C.isDebugEnabled()}),p=()=>{Object.assign(o.uiSettings,C.getUiSettings()),Object.assign(o.quizSettings,C.getQuizSettings()),o.debugEnabled=C.isDebugEnabled()};Be(()=>{C.addListener("settings",p)}),Ge(()=>{C.removeListener("settings",p)}),Se(()=>s.show,w=>{if(w){const c=C.getSettings();Object.assign(o.uiSettings,c.uiSettings),Object.assign(o.quizSettings,c.quizSettings),o.debugEnabled=c.debugEnabled}},{immediate:!1});function m(){try{C.saveGeneralSettings({uiSettings:o.uiSettings,quizSettings:o.quizSettings,debugEnabled:o.debugEnabled}),n("save"),n("close")}catch(w){console.error("保存设置失败:",w),b("保存设置失败，请重试","error")}}function d(){r.value=!0}function S(w){const c=w.target;!c.files||c.files.length}function k(){const w=document.getElementById("importFileInput");if(!w.files||w.files.length===0){b("请选择要导入的配置文件","warning");return}const c=w.files[0];C.importConfigFromFile(c).then(f=>{f&&(r.value=!1,setTimeout(()=>{window.location.reload()},1500))}).catch(f=>{b("导入配置失败："+f.message,"error")})}function v(){try{C.exportConfig(),a.value=!0,l.value=new Date().toISOString()}catch(w){console.error("导出配置失败:",w)}}return(w,c)=>(T(),E(Ee,null,[ee(ae,{show:w.show,title:"设置","content-class":"modal__content--settings",onClose:c[19]||(c[19]=f=>w.$emit("close"))},{footer:j(()=>[u("button",{onClick:c[18]||(c[18]=f=>w.$emit("close")),class:"modal__button modal__button--secondary"},"取消"),u("button",{onClick:m,class:"modal__button modal__button--primary"},"保存设置")]),default:j(()=>[u("div",Is,[u("button",{class:be(["modal__settings-tab",{"modal__settings-tab--active":i.value==="quiz"}]),onClick:c[0]||(c[0]=f=>i.value="quiz")},"刷题设置",2),u("button",{class:be(["modal__settings-tab",{"modal__settings-tab--active":i.value==="general"}]),onClick:c[1]||(c[1]=f=>i.value="general")},"通用设置",2)]),i.value==="quiz"?(T(),E("div",Ts,[u("div",Es,[c[28]||(c[28]=u("h3",{class:"modal__settings-group-title"},"模式",-1)),u("div",Ls,[c[25]||(c[25]=u("span",{class:"modal__setting-item-name"},"随机刷题",-1)),u("label",Qs,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[2]||(c[2]=f=>o.quizSettings.randomMode=f)},null,512),[[P,o.quizSettings.randomMode]]),c[24]||(c[24]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",Rs,[c[27]||(c[27]=u("span",{class:"modal__setting-item-name"},"背题模式",-1)),u("label",Ds,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[3]||(c[3]=f=>o.quizSettings.reviewMode=f)},null,512),[[P,o.quizSettings.reviewMode]]),c[26]||(c[26]=u("span",{class:"modal__toggle-slider"},null,-1))])])]),u("div",Ns,[c[37]||(c[37]=u("h3",{class:"modal__settings-group-title"},"交互",-1)),u("div",Os,[c[30]||(c[30]=u("span",{class:"modal__setting-item-name"},"选择后自动提交",-1)),u("label",Ms,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[4]||(c[4]=f=>o.quizSettings.autoSubmit=f)},null,512),[[P,o.quizSettings.autoSubmit]]),c[29]||(c[29]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",js,[c[32]||(c[32]=u("span",{class:"modal__setting-item-name"},"提交后自动下一题",-1)),u("label",Bs,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[5]||(c[5]=f=>o.quizSettings.autoNext=f)},null,512),[[P,o.quizSettings.autoNext]]),c[31]||(c[31]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",Gs,[c[34]||(c[34]=u("span",{class:"modal__setting-item-name"},"允许跳过未答题目",-1)),u("label",Fs,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[6]||(c[6]=f=>o.quizSettings.allowSkip=f)},null,512),[[P,o.quizSettings.allowSkip]]),c[33]||(c[33]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",Us,[c[36]||(c[36]=u("span",{class:"modal__setting-item-name"},"滑动手势切换",-1)),u("label",Vs,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[7]||(c[7]=f=>o.quizSettings.swipeGestureEnabled=f)},null,512),[[P,o.quizSettings.swipeGestureEnabled]]),c[35]||(c[35]=u("span",{class:"modal__toggle-slider"},null,-1))])])]),u("div",Js,[c[42]||(c[42]=u("h3",{class:"modal__settings-group-title"},"显示",-1)),u("div",Hs,[c[39]||(c[39]=u("span",{class:"modal__setting-item-name"},"回答后显示笔记",-1)),u("label",Zs,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[8]||(c[8]=f=>o.quizSettings.showNotesAfterAnswer=f)},null,512),[[P,o.quizSettings.showNotesAfterAnswer]]),c[38]||(c[38]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",Ws,[c[41]||(c[41]=u("span",{class:"modal__setting-item-name"},"显示进度条/正确率",-1)),u("label",Ks,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[9]||(c[9]=f=>o.quizSettings.showProgress=f)},null,512),[[P,o.quizSettings.showProgress]]),c[40]||(c[40]=u("span",{class:"modal__toggle-slider"},null,-1))])])]),u("div",Xs,[c[47]||(c[47]=u("h3",{class:"modal__settings-group-title"},"答案行为",-1)),u("div",Ys,[c[44]||(c[44]=u("span",{class:"modal__setting-item-name"},"提交后不允许更改",-1)),u("label",en,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[10]||(c[10]=f=>o.quizSettings.lockAnswerAfterSubmit=f)},null,512),[[P,o.quizSettings.lockAnswerAfterSubmit]]),c[43]||(c[43]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",tn,[c[46]||(c[46]=u("span",{class:"modal__setting-item-name"},"提交后立即显示正确答案",-1)),u("label",sn,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[11]||(c[11]=f=>o.quizSettings.showCorrectAnswerImmediately=f)},null,512),[[P,o.quizSettings.showCorrectAnswerImmediately]]),c[45]||(c[45]=u("span",{class:"modal__toggle-slider"},null,-1))])])])])):F("",!0),i.value==="general"?(T(),E("div",nn,[u("div",rn,[c[52]||(c[52]=u("h3",{class:"modal__settings-group-title"},"显示",-1)),u("div",on,[c[48]||(c[48]=u("span",{class:"modal__setting-item-name"},"字体大小",-1)),u("div",an,[$(u("input",{type:"range","onUpdate:modelValue":c[12]||(c[12]=f=>o.uiSettings.fontSize=f),min:"12",max:"20",step:"1"},null,512),[[B,o.uiSettings.fontSize,void 0,{number:!0}]]),u("span",null,D(o.uiSettings.fontSize)+"px",1)])]),u("div",ln,[c[49]||(c[49]=u("span",{class:"modal__setting-item-name"},"字体选择",-1)),$(u("select",{"onUpdate:modelValue":c[13]||(c[13]=f=>o.uiSettings.fontFamily=f),class:"modal__select-styled"},[(T(),E(Ee,null,pt(t,f=>u("option",{key:f.value,value:f.value},D(f.name),9,un)),64))],512),[[ht,o.uiSettings.fontFamily]])]),u("div",cn,[c[51]||(c[51]=u("span",{class:"modal__setting-item-name"},"启用动画效果",-1)),u("label",pn,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[14]||(c[14]=f=>o.uiSettings.animationEnabled=f)},null,512),[[P,o.uiSettings.animationEnabled]]),c[50]||(c[50]=u("span",{class:"modal__toggle-slider"},null,-1))])])]),u("div",hn,[c[56]||(c[56]=u("h3",{class:"modal__settings-group-title"},"音效",-1)),u("div",gn,[c[54]||(c[54]=u("span",{class:"modal__setting-item-name"},"启用音效",-1)),u("label",dn,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[15]||(c[15]=f=>o.uiSettings.soundEffectsEnabled=f)},null,512),[[P,o.uiSettings.soundEffectsEnabled]]),c[53]||(c[53]=u("span",{class:"modal__toggle-slider"},null,-1))])]),u("div",fn,[c[55]||(c[55]=u("span",{class:"modal__setting-item-name"},"音量调节",-1)),u("div",mn,[$(u("input",{type:"range","onUpdate:modelValue":c[16]||(c[16]=f=>o.uiSettings.soundVolume=f),min:"0",max:"1",step:"0.1"},null,512),[[B,o.uiSettings.soundVolume,void 0,{number:!0}]]),u("span",null,D(Math.round(o.uiSettings.soundVolume*100))+"%",1)])])]),u("div",{class:"modal__settings-group"},[c[59]||(c[59]=u("h3",{class:"modal__settings-group-title"},"数据管理",-1)),u("div",{class:"modal__setting-item"},[c[57]||(c[57]=u("span",{class:"modal__setting-item-name"},"导出配置",-1)),u("button",{class:"modal__button modal__button--secondary",onClick:v}," 导出为JSON ")]),u("div",{class:"modal__setting-item"},[c[58]||(c[58]=u("span",{class:"modal__setting-item-name"},"导入配置",-1)),u("button",{class:"modal__button modal__button--secondary",onClick:d}," 选择文件导入 ")])]),u("div",bn,[c[62]||(c[62]=u("h3",{class:"modal__settings-group-title"},"调试",-1)),u("div",Sn,[c[61]||(c[61]=u("span",{class:"modal__setting-item-name"},"调试模式",-1)),u("label",yn,[$(u("input",{type:"checkbox","onUpdate:modelValue":c[17]||(c[17]=f=>o.debugEnabled=f)},null,512),[[P,o.debugEnabled]]),c[60]||(c[60]=u("span",{class:"modal__toggle-slider"},null,-1))])])])])):F("",!0)]),_:1},8,["show"]),ee(ae,{show:r.value,title:"导入配置",onClose:c[21]||(c[21]=f=>r.value=!1)},{footer:j(()=>[u("button",{onClick:c[20]||(c[20]=f=>r.value=!1),class:"modal__button modal__button--secondary"},"取消"),u("button",{onClick:k,class:"modal__button modal__button--primary"},"导入")]),default:j(()=>[u("div",kn,[c[63]||(c[63]=u("p",null,"选择要导入的配置文件：",-1)),u("input",{type:"file",id:"importFileInput",accept:".json",onChange:S},null,32)])]),_:1},8,["show"]),ee(ae,{show:a.value,title:"导出成功",onClose:c[23]||(c[23]=f=>a.value=!1)},{footer:j(()=>[u("button",{onClick:c[22]||(c[22]=f=>a.value=!1),class:"modal__button modal__button--primary"},"关闭")]),default:j(()=>[u("div",wn,[c[64]||(c[64]=u("p",null,"配置文件已成功导出为JSON文件。",-1)),u("p",null,"导出时间："+D(l.value),1)])]),_:1},8,["show"])],64))}});export{tt as Q,Le as _,ae as a,Yt as b,C as c,es as d,zn as e,$n as f,_n as p};
